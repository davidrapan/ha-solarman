#
# SUN-5/6/8/10/12K-SG04LP3 | 5-12kW | Three Phase | 2 MPPT | Hybrid Inverter | LV Battery Supported
# - tested with 12KW and LSW3_15_FFFF_1.0.91R Stick Logger
#
# Registers
# The 0-59 register address is a readable register type, 0x03 function code.
# The 60-499 register address is a read-write register type 0x10 function code.
# The 500-2000 register address is a readable register type 0x03 function code.
#

info:
  manufacturer: Deye
  model: SG04LP3

default:
  update_interval: 60
  digits: 6

parameters:
  - group: Parameters
    items:
      # Device - Type
      - name: "Device"
        update_interval: 300
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0000]
        icon: "mdi:information"
        lookup:
          - key: 0x0200
            value: "String Inverter"
          - key: 0x0300
            value: "Single-Phase Hybrid Inverter"
          - key: 0x0400
            value: "Microinverter"
          - key: 0x0005
            value: "LV 3-Phase Hybrid Inverter"
          - key: 0x0006
            value: "HV 3-Phase Hybrid Inverter"
          - key: 0x0600
            value: "HV 3-Phase Inverter 6-15kw"
          - key: 0x0601
            value: "HV 3-Phase Inverter 20-50kw"
        attributes:
          [
            "Device DateTime",
            "Device Modbus Address",
            "Device Protocol Version",
            "Device Serial Number",
            "Device Rated Power",
            "Device MPPTs",
            "Device Phases",
          ]

      # Device - Modbus Address
      - name: "Device Modbus Address"
        attribute:
        update_interval: 300
        class: ""
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0001]
        icon: "mdi:information"

      # Device - Communication Protocol Version
      - name: "Device Protocol Version"
        attribute:
        update_interval: 300
        scale: 1
        rule: 7
        remove: "0."
        registers: [0x0002]
        icon: "mdi:information"

      # Device - Serial Number
      - name: "Device Serial Number"
        attribute:
        update_interval: 300
        class: ""
        state_class: ""
        uom: ""
        scale: 1
        rule: 5
        registers: [0x0003, 0x0004, 0x0005, 0x0006, 0x0007]
        icon: "mdi:information"

      # Device - Rated Power
      - name: "Device Rated Power"
        attribute:
        update_interval: 300
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 0.1
        rule: 4
        registers: [0x0014, 0x0015]
        validation:
          min: 0
          max: 24000

      # Device - MPPTs
      - name: "Device MPPTs"
        attribute:
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: ""
        rule: 1
        mask: 0x0F00
        divide: 256
        registers: [0x0016]
        range:
          min: 257
          max: 2051

      # Device - Phases
      - name: "Device Phases"
        attribute:
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: ""
        rule: 1
        mask: 0x000F
        registers: [0x0016]
        range:
          min: 257
          max: 2051

      - name: "Device DateTime"
        attribute:
        update_interval: 30
        device_class: "date"
        rule: 8
        registers: [0x003E, 0x003F, 0x0040]

  - group: Control
    items:
      # Device - On/Off Switch (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
      - name: ""
        update_interval: 300
        platform: "switch"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0050]

  - group: Settings
    items:
      - name: "Battery Control Mode"
        update_interval: 300
        platform: "select"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0062]
        icon: "mdi:battery"
        options: ["Lead-Battery, four-stage charging method", "Lithium"]
        lookup:
          - key: 0x0000
            value: "Lead-Battery, four-stage charging method"
          - key: 0x0001
            value: "Lithium"

      - name: "Battery Equalization"
        update_interval: 300
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0063]
        configurable:
          min: 38
          max: 61
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Absorption"
        update_interval: 300
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0064]
        configurable:
          min: 38
          max: 61
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Float"
        update_interval: 300
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0065]
        configurable:
          min: 38
          max: 61
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Capacity"
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: "Ah"
        scale: 1
        rule: 1
        registers: [0x0066]
        configurable:
          min: 0
          max: 2000
        icon: "mdi:battery"
        range:
          min: 0
          max: 2000

      - name: "Battery Empty"
        update_interval: 300
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0067]
        configurable:
          min: 38
          max: 61
          step: 0.1
        icon: "mdi:battery"

      - name: "Zero Export power"
        update_interval: 300
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x0068]
        configurable:
          min: 0
          max: 500
        icon: "mdi:transmission-tower-import"

      - name: "Battery Equalization Cycle"
        update_interval: 300
        class: "duration"
        state_class: "measurement"
        uom: "d"
        scale: 1
        rule: 1
        registers: [0x0069]
        configurable:
          min: 0
          max: 90
        icon: "mdi:battery"
        range:
          min: 0
          max: 90

      - name: "Battery Equalization Time"
        update_interval: 300
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.5
        rule: 1
        registers: [0x006A]
        configurable:
          min: 0
          max: 10
        icon: "mdi:battery"
        range:
          min: 0
          max: 20

      - name: "Battery Temperature Compensation"
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: "mV/*C"
        scale: 1
        rule: 2
        registers: [0x006B]
        configurable:
          min: 0
          max: 50
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 0
          max: 50

      - name: "Battery Max Charging Current"
        update_interval: 300
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x006C]
        configurable:
          min: 0
          max: 240
        icon: "mdi:battery"
        range:
          min: 0
          max: 240

      - name: "Battery Max Discharging Current"
        update_interval: 300
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x006D]
        configurable:
          min: 0
          max: 240
        icon: "mdi:battery"
        range:
          min: 0
          max: 240

      - name: "Battery Operation Mode"
        update_interval: 300
        platform: "select"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x006F]
        icon: mdi:battery
        options: [Voltage, Capacity, No Battery]
        lookup:
          - key: 0x0000
            value: Voltage
          - key: 0x0001
            value: Capacity
          - key: 0x0002
            value: No Battery

      - name: Battery Resistance
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "mÎ©"
        scale: 1
        rule: 1
        registers: [0x0071]
        icon: mdi:battery
        configurable:
        range:
          min: 0
          max: 6000

      - name: Battery Charging efficiency
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x0072]
        icon: mdi:battery
        configurable:
        range:
          min: 0
          max: 1000
        validation:
          min: 0
          max: 100

      - name: Battery Shutdown SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x0073]
        icon: mdi:battery
        configurable:
        range:
          min: 0
          max: 100

      - name: Battery Restart SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x0074]
        icon: mdi:battery
        configurable:
        range:
          min: 0
          max: 100

      - name: Battery Low SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x0075]
        icon: mdi:battery
        configurable:
        range:
          min: 0
          max: 100

      - name: Battery Shutdown Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0076]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100

      - name: Battery Restart Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0077]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100

      - name: Battery Low Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0078]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100

      - name: "Battery Generator Charging Current"
        update_interval: 300
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x007D]
        configurable:
          min: 0
          max: 240
        icon: "mdi:battery"
        range:
          min: 0
          max: 240

      - name: "Battery Grid Charging Current"
        update_interval: 300
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x0080]
        configurable:
          min: 0
          max: 240
        icon: "mdi:battery"
        range:
          min: 0
          max: 240

      - name: "Battery Generator Charging"
        update_interval: 300
        platform: "switch"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0081]
        icon: "mdi:battery"

      - name: "Battery Grid Charging"
        update_interval: 300
        platform: "switch"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0082]
        icon: "mdi:battery"

      - name: "Generator"
        update_interval: 300
        platform: "switch"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0084]
        icon: "mdi:generator-stationary"

      - name: "SmartLoad Mode"
        update_interval: 300
        platform: "select"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0085]
        icon: "mdi:lightning-bolt-circle"
        options: ["Generator", "Output", "Microinverter"]
        lookup:
          - key: 0x0000
            value: "Generator"
          - key: 0x0001
            value: "Output"
          - key: 0x0002
            value: "Microinverter"

      - name: "SmartLoad Off"
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x0087]
        icon: "mdi:lightning-bolt-circle"
        configurable:
        range:
          min: 0
          max: 100

      - name: "SmartLoad On"
        update_interval: 300
        class: ""
        state_class: "measurement"
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x0089]
        icon: "mdi:lightning-bolt-circle"
        configurable:
        range:
          min: 0
          max: 100

      - name: "SmartLoad"
        update_interval: 30
        platform: "binary_sensor"
        device_class: power
        state_class: ""
        uom: ""
        rule: 1
        registers: [0x0228]
        bit: 3
        icon: "mdi:lightning-bolt-circle"

  - group: Grid Parameters
    items:
      - name: Grid Voltage
        update_interval: 300
        platform: "select"
        registers: [0x008A]
        rule: 1
        options:
          [
            LN:220VAC LL:380VAC,
            LN:230VAC LL:398VAC,
            LN:240VAC LL:415VAC,
            LN:120VAC LL:208VAC,
            LN:133VAC LL:220VAC,
            LN:100VAC LL:173VAC,
          ]
        lookup:
          - key: 0x0
            value: LN:220VAC LL:380VAC
          - key: 0x1
            value: LN:230VAC LL:398VAC
          - key: 0x2
            value: LN:240VAC LL:415VAC
          - key: 0x3
            value: LN:120VAC LL:208VAC
          - key: 0x4
            value: LN:133VAC LL:220VAC
          - key: 0x5
            value: LN:100VAC LL:173VAC

  - group: Work Mode
    items:
      - name: Energy Pattern
        update_interval: 300
        platform: "select"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x008D]
        options: ["Battery First", "Load First"]
        lookup:
          - key: 0x0000
            value: "Battery First"
          - key: 0x0001
            value: "Load First"

      - name: Work Mode
        update_interval: 300
        platform: "select"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x008E]
        options: ["Selling First", "Zero Export To Load", "Zero Export To CT"]
        lookup:
          - key: 0x0000
            value: "Selling First"
          - key: 0x0001
            value: "Zero Export To Load"
          - key: 0x0002
            value: "Zero Export To CT"

      - name: Export Surplus Power
        alt: Max Sell Power
        update_interval: 300
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x008F]
        configurable:
        range:
          min: 0
          max: 15600

      - name: Export Surplus
        alt: Solar Sell
        update_interval: 300
        platform: "switch"
        scale: 1
        rule: 1
        registers: [0x0091]

      - name: PV Max Power
        alt: Max Solar Power
        update_interval: 300
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x0154]
        configurable:
        range:
          min: 0
          max: 15600

      - name: Time of Use
        update_interval: 300
        platform: "switch"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0092]
        value:
          on: 0x00FF
          off: 0x0000

      - name: Program 1 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0094]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 2 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0095]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 3 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0096]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 4 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0097]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 5 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0098]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 6 Time
        update_interval: 300
        platform: "time"
        state_class: measurement
        uom: ""
        scale: 1
        rule: 9
        registers: [0x0099]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 1 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009A]
        configurable:
        range:
          min: 0000
          max: 12000
        icon: mdi:sun-clock

      - name: Program 2 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009B]
        configurable:
        range:
          min: 0000
          max: 12000
        icon: mdi:sun-clock

      - name: Program 3 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009C]
        configurable:
        range:
          min: 0000
          max: 12000

        icon: mdi:sun-clock
      - name: Program 4 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009D]
        configurable:
        range:
          min: 0000
          max: 12000
        icon: mdi:sun-clock

      - name: Program 5 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009E]
        configurable:
        range:
          min: 0000
          max: 12000
        icon: mdi:sun-clock

      - name: Program 6 Power
        update_interval: 300
        class: "power"
        state_class: measurement
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x009F]
        configurable:
        range:
          min: 0000
          max: 12000
        icon: mdi:sun-clock

      - name: Program 1 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A0]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 2 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A1]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 3 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A2]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 4 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A3]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 5 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A4]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 6 Voltage
        update_interval: 300
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A5]
        configurable:
          min: 38
          max: 61
          step: 0.1
        range:
          min: 3800
          max: 6100
        icon: mdi:sun-clock

      - name: Program 1 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00A6]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 2 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00A7]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 3 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00A8]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 4 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00A9]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 5 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00AA]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 6 SOC
        update_interval: 300
        class: ""
        state_class: measurement
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00AB]
        configurable:
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 1 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00AC]
        icon: mdi:sun-clock

      - name: Program 2 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00AD]
        icon: mdi:sun-clock

      - name: Program 3 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00AE]
        icon: mdi:sun-clock

      - name: Program 4 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00AF]
        icon: mdi:sun-clock

      - name: Program 5 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00B0]
        icon: mdi:sun-clock

      - name: Program 6 Grid Charging
        platform: switch
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00B1]
        icon: mdi:sun-clock

  - group: BMS
    items:
      - name: "BMS Charging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00D2]
        icon: "mdi:battery"

      - name: "BMS Discharging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00D3]
        icon: "mdi:battery"

      - name: "BMS Charging Current Limit"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x00D4]
        icon: "mdi:battery"

      - name: "BMS Discharging Current Limit"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x00D5]
        icon: "mdi:battery"

      - name: "BMS SOC"
        attribute:
        class: ""
        state_class: "measurement"
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x00D6]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101

      - name: "BMS Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00D7]

      - name: "BMS Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 2
        registers: [0x00D8]

      - name: "BMS Max Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x00DA]
        icon: "mdi:battery"

      - name: "BMS Max Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 1
        rule: 1
        registers: [0x00DB]
        icon: "mdi:battery"

      - name: "Battery Alarm"
        platform: binary_sensor
        class: "problem"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00DC]
        icon: "mdi:battery-alert"
        attributes: ["value", "BMS Fault Location"]

      - name: "BMS Fault Location"
        attribute:
        class: ""
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00DD]
        icon: "mdi:battery-alert"
        range:
          min: 0
          max: 65535

      - name: "BMS Other Symbol"
        attribute:
        class: ""
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-unknown"
        range:
          min: 0
          max: 65535

      - name: "BMS Type"
        attribute:
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x00DF]
        icon: "mdi:battery"
        options:
          [
            "PYLON",
            "Tianbangda",
            "KOK",
            "Keith",
            "Toppai",
            "Peneng 485",
            "Jeris 485",
            "Sunwoda 485",
            "Xinrui 485",
            "Tianbangda 485",
            "Shenggao Electric CAN",
          ]
        lookup:
          - key: 0x0000
            value: "PYLON"
          - key: 0x0001
            value: "Tianbangda"
          - key: 0x0002
            value: "KOK"
          - key: 0x0003
            value: "Keith"
          - key: 0x0004
            value: "Toppai"
          - key: 0x0005
            value: "Peneng 485"
          - key: 0x0006
            value: "Jeris 485"
          - key: 0x0007
            value: "Sunwoda 485"
          - key: 0x0008
            value: "Xinrui 485"
          - key: 0x0009
            value: "Tianbangda 485"
          - key: 0x000A
            value: "Shenggao Electric CAN"

  - group: Device
    items:
      # Device - Operating (Running) state
      - name: "Device State"
        update_interval: 30
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x01F4]
        icon: "mdi:information"
        range:
          min: 0
          max: 5
        lookup:
          - key: 0x0000
            value: "Standby"
          - key: 0x0001
            value: "Self-test"
          - key: 0x0002
            value: "Normal"
          - key: 0x0003
            value: "Alarm"
          - key: 0x0004
            value: "Fault"

  - group: Meter
    items:
      - name: Today Battery Charge
        alt: Daily Battery Charge
        friendly_name: Today's Battery Charge
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0202]
        icon: "mdi:battery-plus"

      - name: Today Battery Discharge
        alt: Daily Battery Discharge
        friendly_name: Today's Battery Discharge
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0203]
        icon: "mdi:battery-minus"

      - name: "Total Battery Charge"
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0204, 0x0205]
        icon: "mdi:battery-plus"
        validation:
          min: 0.1

      - name: "Total Battery Discharge"
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0206, 0x0207]
        icon: "mdi:battery-minus"
        validation:
          min: 0.1

      - name: Today Battery Life Cycles
        alt: Daily Battery Life Cycles
        friendly_name: Today's Battery Life Cycles
        description: Calculates today's battery life cycles based on today's charged amount
        update_interval: 30
        class: ""
        state_class: "total_increasing"
        uom: ""
        scale: 1
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"

      - name: "Total Battery Life Cycles"
        update_interval: 30
        description: Calculates total battery life cycles based on total charged amount
        class: ""
        state_class: "total_increasing"
        uom: ""
        scale: 1
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"
        validation:
          min: 0.1

      - name: Today Energy Import
        alt: Daily Energy Bought
        friendly_name: Today's Energy Import
        description: Today's energy imported from the grid
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0208]
        icon: "mdi:transmission-tower-export"

      - name: Today Energy Export
        alt: Daily Energy Sold
        friendly_name: Today's Energy Export
        description: Today's energy exported/returned to the grid
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0209]
        icon: "mdi:transmission-tower-import"

      - name: Total Energy Import
        alt: Total Energy Bought
        description: Total energy imported from the grid
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020A, 0x020B]
        icon: "mdi:transmission-tower-export"
        validation:
          min: 0.1

      - name: Total Energy Export
        alt: Total Energy Sold
        description: Total energy exported/returned to the grid
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020C, 0x020D]
        icon: "mdi:transmission-tower-import"
        validation:
          min: 0.1

      - name: Today Load Consumption
        alt: Daily Load Consumption
        friendly_name: Today's Load Consumption
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x020E]

      - name: "Total Load Consumption"
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020F, 0x0210]
        validation:
          min: 0.1

      - name: Today Losses
        alt: Daily Losses
        friendly_name: Today's Losses
        description: Includes today's consumption of the inverter device itself as well AC/DC conversion losses
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 1
        digits: 1
        registers: [0x0208, 0x0211, 0x0203, 0x0209, 0x020E, 0x0202]
        uint: enforce
        sensors:
          - scale: 0.1
            registers: [0x0208]
          - scale: 0.1
            registers: [0x0211]
          - scale: 0.1
            registers: [0x0203]
          - operator: subtract
            scale: 0.1
            registers: [0x0209]
          - operator: subtract
            scale: 0.1
            registers: [0x020E]
          - operator: subtract
            scale: 0.1
            registers: [0x0202]
        validation:
          default: 0
          min: 0.5

      - name: Total Losses
        description: Includes total consumption of the inverter device itself as well AC/DC conversion losses
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 3
        digits: 1
        registers:
          [
            0x020A,
            0x020B,
            0x0216,
            0x0217,
            0x0206,
            0x0207,
            0x020C,
            0x020D,
            0x020F,
            0x0210,
            0x0204,
            0x0205,
          ]
        uint: enforce
        sensors:
          - scale: 0.1
            registers: [0x020A, 0x020B]
          - scale: 0.1
            registers: [0x0216, 0x0217]
          - scale: 0.1
            registers: [0x0206, 0x0207]
          - operator: subtract
            scale: 0.1
            registers: [0x020C, 0x020D]
          - operator: subtract
            scale: 0.1
            registers: [0x020F, 0x0210]
          - operator: subtract
            scale: 0.1
            registers: [0x0204, 0x0205]
        validation:
          min: 0.5

      - name: Today Production
        alt: Daily Production
        friendly_name: Today's Production
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0211]
        icon: "mdi:solar-power"

      - name: "Total Production"
        update_interval: 30
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0216, 0x0217]
        icon: "mdi:solar-power"
        validation:
          min: 0.1

      - name: "DC Temperature"
        update_interval: 30
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021C]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

      - name: "Temperature"
        update_interval: 30
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021D]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

  - group: State
    items:
      # Device - Power On/Off (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
      - name: ""
        update_interval: 30
        platform: "binary_sensor"
        device_class: running
        state_class: ""
        uom: ""
        rule: 1
        registers: [0x0227]

      # Device - AC Relay
      - name: "Device Relay"
        update_interval: 30
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 1
        registers: [0x0228]
        icon: "mdi:information"
        lookup:
          - key: 0x0000
            value: "Off"
          - key: 0x0001
            value: "Inverter"
          - key: 0x0004
            value: "Grid"
          - key: 0x0005
            value: "Inverter-Grid"
          - key: 0x0008
            value: "Generator"
          - key: 0x0009
            value: "Inverter-Gen"
          - key: 0x000C
            value: "Grid-Generator"
          - key: 0x000D
            value: "Inv-Grid-Gen"
          - key: "default"
            value: "Power Supply"

      # Device - Alarm message (word 1 & 2) [0, 65535]
      - name: "Device Alarm"
        update_interval: 30
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 3
        registers: [0x0229, 0x022A]
        icon: "mdi:message-alert-outline"
        lookup:
          - key: 0x0000
            value: "OK"
          - key: 0x0002
            value: "Fan failure"
          - key: 0x0004
            value: "Grid phase failure"
          - key: 0x0008
            value: "Meter communication failure"
          - key: 0x40000000
            value: "Battery loss"
          - key: 0x80000000
            value: "Parallel communication quality"
          - key: "default"
            value: "Error"

      # Device - Fault message (word 1, 2, 3 & 4) [0, 65535]
      - name: "Device Fault"
        update_interval: 30
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 3
        registers: [0x22B, 0x022C, 0x022D, 0x022E]
        icon: "mdi:alert-outline"
        lookup:
          - key: 0x0000
            value: "OK"
          - key: 0x0040
            value: "DC/DC Soft Start failure"
          - key: 0x0200
            value: "Auxiliary power supply failure"
          - key: 0x1000
            value: "Working mode changed"
          - key: 0x00020000
            value: "AC Over-current failure"
          - key: 0x00040000
            value: "Tz_Integ_Fault failure"
          - key: 0x00080000
            value: "DC Over-current failure"
          - key: 0x00400000
            value: "AC current leakage failure"
          - key: 0x8000000000000000
            value: "Temperature is too high"
          - key: "default"
            value: "Error"

  - group: Battery
    items:
      # Battery - The temperature of battery 1
      - name: "Battery Temperature"
        realtime:
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x024A]
        range:
          min: 0
          max: 3000
        validation:
          min: 1
          max: 99

      # Battery - The voltage of battery 1 (L:0.01V, H:0.1V)
      - name: "Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x024B]

      # Battery - The State of Charge (SOC) of battery 1
      - name: "Battery"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 1
        rule: 1
        registers: [0x024C]
        range:
          min: 0
          max: 100
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery Corrected Capacity",
            "BMS SOC",
            "BMS Current",
            "BMS Voltage",
            "BMS Type",
            "BMS Other Symbol",
            "BMS Charging Voltage",
            "BMS Discharging Voltage",
            "BMS Charging Current Limit",
            "BMS Discharging Current Limit",
            "BMS Max Charging Current",
            "BMS Max Discharging Current",
          ]

      # Battery - The power of battery is S16bit
      - name: "Battery Power"
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 2
        registers: [0x024E]

      # Battery - The state of health
      - name: "Battery SOH"
        description: Calculates state of health based on total charged amount
        class: ""
        state_class: "measurement"
        uom: "%"
        scale: 1
        rule: 0
        digits: 2
        icon: "mdi:battery-heart"

      # Battery - The state of battery
      - name: "Battery State"
        description: Determines battery state from battery power by +-50 W
        class: "enum"
        state_class: ""
        uom: ""
        scale: 1
        rule: 0
        options: ["charging", "idle", "discharging"]
        icon: "mdi:battery"

      # Battery - The current of battery 1 is S16bit (low 16 bits)
      - name: "Battery Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x024F]

      # Battery - Actual capacity of the battery
      - name: "Battery Corrected Capacity"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "Ah"
        scale: 1
        rule: 1
        registers: [0x0250]
        icon: "mdi:battery"
        range:
          min: 0
          max: 3000

  - group: Grid
    items:
      # Device - Grid On/Off
      - name: "Grid"
        update_interval: 30
        platform: "binary_sensor"
        device_class: power
        state_class: ""
        uom: ""
        rule: 1
        registers: [0x0228]
        bit: 2
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase A
      - name: "Grid L1 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0256]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase B
      - name: "Grid L2 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0257]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase C
      - name: "Grid L3 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0258]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x025C, 0x02BC]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x025D, 0x02BD]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x025E, 0x02BE]
        icon: "mdi:transmission-tower"

      # Grid internal - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x025F, 0x02BF]
        icon: "mdi:transmission-tower"

      - name: "Grid Frequency"
        realtime:
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x0261]

      # Grid internal - The current of phase A is S16bit (low 16 bits)
      - name: "Internal CT1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0262]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase B is S16bit (low 16 bits)
      - name: "Internal CT2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0263]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase C is S16bit (low 16 bits)
      - name: "Internal CT3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0264]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase A is S16bit (low 16 bits)
      - name: "External CT1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0265]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase B is S16bit (low 16 bits)
      - name: "External CT2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0266]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase C is S16bit (low 16 bits)
      - name: "External CT3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0267]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x0268, 0x02C1]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x0269, 0x02C2]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x026A, 0x02C3]
        icon: "mdi:transmission-tower"

      # Grid external - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x026B, 0x02C4]
        icon: "mdi:transmission-tower"

      # The following three (four) registers change according to the built-in and external settings
      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L1 Power"
        realtime:
        class: "measurement"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x026E, 0x02AF]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L2 Power"
        realtime:
        class: "measurement"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x026F, 0x02B0]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L3 Power"
        realtime:
        class: "measurement"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x0270, 0x02B1]
        icon: "mdi:transmission-tower"

      # Grid - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid Power"
        description: Combined power of all three phases
        realtime:
        class: "measurement"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x0271, 0x02B2]
        icon: "mdi:transmission-tower"

  - group: Inverter
    items:
      # Inverter output - The voltage of phase A
      - name: "Inverter L1 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0273]

      # Inverter output - The voltage of phase B
      - name: "Inverter L2 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0274]

      # Inverter output - The voltage of phase C
      - name: "Inverter L3 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0275]

      # Inverter output - The current of phase A is S16bit (low 16 bits)
      - name: "Inverter L1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0276]

      # Inverter output - The current of phase B is S16bit (low 16 bits)
      - name: "Inverter L2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0277]

      # Inverter output - The current of phase C is S16bit (low 16 bits)
      - name: "Inverter L3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0278]

      # Inverter output - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Inverter L1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x0279, 0x02B3]

      # Inverter output - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Inverter L2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x027A, 0x02B4]

      # Inverter output - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Inverter L3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x027B, 0x02B5]

      # Inverter output - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Inverter Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x027C, 0x02B6]

      # Inverter - Includes consumption of the inverter device itself as well AC/DC conversion losses
      - name: "Power losses"
        description: Includes consumption of the inverter device itself as well AC/DC conversion losses
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        registers: [0x024E, 0x02A0, 0x02A1, 0x02A2, 0x02A3, 0x027C, 0x02B6]
        uint: enforce
        sensors:
          - signed:
            registers: [0x024E]
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
          - operator: subtract
            signed:
            registers: [0x027C, 0x02B6]

      - name: "Inverter Frequency"
        realtime:
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x027E]

  - group: UPS
    items:
      # Load UPS output - The power of phase A is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 3
        registers: [0x0280, 0x02B8]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase B is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 3
        registers: [0x0281, 0x02B9]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase C is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 3
        registers: [0x0282, 0x02BA]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 3
        registers: [0x0283, 0x02BB]
        icon: "mdi:home-lightning-bolt"

  - group: Load
    items:
      # Load output - The voltage of phase A
      - name: "Load L1 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0284]

      # Load output - The voltage of phase B
      - name: "Load L2 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0285]

      # Load output - The voltage of phase C
      - name: "Load L3 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0286]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x028A, 0x0290]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x028B, 0x0291]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x028C, 0x0292]

      # Load - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Power"
        description: Combined power of all three phases
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 4
        registers: [0x028D, 0x0293]

      - name: "Load Frequency"
        realtime:
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x028F]

  - group: SmartLoad/Generator
    items:
      # SmartLoad/Generator - The voltage of phase A
      - name: "SmartLoad L1 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0295]

      # SmartLoad/Generator - The voltage of phase B
      - name: "SmartLoad L2 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0296]

      # SmartLoad/Generator - The voltage of phase C
      - name: "SmartLoad L3 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0297]

      # Generator - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "SmartLoad L1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 2
        registers: [0x0298, 0x029C]

      # SmartLoad/Generator - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "SmartLoad L2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 2
        registers: [0x0299, 0x029D]

      # SmartLoad/Generator - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "SmartLoad L3 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 2
        registers: [0x029A, 0x029E]

      # SmartLoad/Generator - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "SmartLoad Power"
        description: Combined power of all three phases
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 2
        registers: [0x029B, 0x029F]

  - group: PV
    items:
      # PV - The combined power of Input 1 & 2 & 3 & 4 (L:1W, H:10W)
      - name: "PV Power"
        description: Combined power of all inputs
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        registers: [0x02A0, 0x02A1, 0x02A2, 0x02A3]
        sensors:
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 1 (L:1W, H:10W)
      - name: "PV1 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x02A0]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 2 (L:1W, H:10W)
      - name: "PV2 Power"
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x02A1]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 3 (L:1W, H:10W)
      - name: "PV3 Power"
        disabled:
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x02A2]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 4 (L:1W, H:10W)
      - name: "PV4 Power"
        disabled:
        realtime:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 1
        rule: 1
        registers: [0x02A3]
        icon: "mdi:solar-power-variant"

      # PV - The voltage of Input 1
      - name: "PV1 Voltage"
        realtime:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A4]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The current of Input 1
      - name: "PV1 Current"
        realtime:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A5]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The voltage of Input 2
      - name: "PV2 Voltage"
        realtime:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A6]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The current of Input 2
      - name: "PV2 Current"
        realtime:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A7]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The voltage of Input 3
      - name: "PV3 Voltage"
        disabled:
        realtime:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A8]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The current of Input 3
      - name: "PV3 Current"
        disabled:
        realtime:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A9]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The voltage of Input 4
      - name: "PV4 Voltage"
        disabled:
        realtime:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02AA]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      # PV - The current of Input 4
      - name: "PV4 Current"
        disabled:
        realtime:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02AB]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535
