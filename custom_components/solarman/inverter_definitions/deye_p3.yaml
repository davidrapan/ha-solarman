#
# SUN-5/6/8/10/12K-SG04LP3 and SUN-5/6/8/10/12/15/20/25K-SG01HP3-EU-AM2 | 5-32kW and 5-128kW | Three Phase | 4 MPPT | Hybrid Inverter | LV and HV Battery Supported
#
# Reference: https://github.com/user-attachments/files/16798469/MODBUS.RTU.V105.1-20231006.pdf and https://github.com/user-attachments/files/16597916/MODBUSRTU.V104.3.1.1111_SG01-HP3-AM2.pdf
#
# Tested with 25K-SG01HP3 12K-SG04LP3 and LSW3_15_FFFF_1.0.91R Stick Logger
#

info:
  manufacturer: Deye
  model: [SG0*LP3, SG0*HP3]

default:
  update_interval: 60
  digits: 6

parameters:
  - group: Info
    update_interval: 3600
    items:
      - name: "Device"
        class: "enum"
        rule: 1
        registers: [0x0000]
        icon: "mdi:information"
        lookup:
          - key: 0x0000
            value: "Unknown"
          - key: [0x0002, 0x0200]
            value: "String Inverter"
          - key: [0x0003, 0x0300]
            value: "Single-Phase Hybrid Inverter"
          - key: [0x0004, 0x0400]
            value: "Microinverter"
          - key: [0x0005, 0x0500]
            value: "LV 3-Phase Hybrid Inverter"
          - key: 0x0006
            value: "HV 3-Phase Hybrid Inverter"
          - key: [0x0007, 0x0600]
            value: "HV 3-Phase Inverter 6-15kw"
          - key: [0x0008, 0x0601]
            value: "HV 3-Phase Inverter 20-50kw"
          - key: 0x0103
            value: "Off-Grid Inverter"
          - key: 0x0104
            value: "Energy Storage System"
        attributes:
          [
            "Device Modbus Address",
            "Device Protocol Version",
            "Device Serial Number",
            "Device Control Board Firmware Version",
            "Device Communication Board Firmware Version",
            "Device MCU Board Version",
            "Device MCU Version",
            "Device AFCI Version",
            "Device Rated Power",
            "Device MPPTs",
            "Device Phases",
          ]

      - name: "Device Modbus Address"
        attribute:
        rule: 1
        registers: [0x0001]

      - name: "Device Protocol Version"
        attribute:
        rule: 7
        remove: "0."
        registers: [0x0002]

      - name: "Device Serial Number"
        attribute:
        rule: 5
        registers: [0x0003, 0x0004, 0x0005, 0x0006, 0x0007]

      - name: "Device MCU Board Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000A]

      - name: "Device AFCI Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000C]

      - name: "Device MCU Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000D]

      - name: "Device Control Board Firmware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000E, 0x000F, 0x000B]

      - name: "Device Communication Board Firmware Version"
        attribute:
        rule: 7
        hex:
        delimiter: ""
        registers: [0x0011, 0x0012, 0x0010]

      - name: "Device Rated Power"
        attribute:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 0.1
        rule: 4
        registers: [0x0014, 0x0015]
        validation:
          min: 1
          max: [24000, 80000]
          default: [24000, 80000]

      - name: "Device MPPTs"
        attribute:
        rule: 1
        mask: 0x0F00
        divide: 256
        registers: [0x0016]
        range:
          min: 257
        validation:
          max: 12
          default: 2

      - name: "Device Phases"
        attribute:
        rule: 1
        mask: 0x000F
        registers: [0x0016]
        range:
          min: 257
        validation:
          max: 3
          default: 3

      - name: Device Self-check
        attribute:
        class: "enum"
        rule: 1
        registers: [0x0024]
        range:
          min: 0
          max: 1
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Enabled"

  - group: Control
    update_interval: 300
    items:
      - name: "Self-check time"
        platform: number
        uom: "s"
        rule: 1
        registers: [0x003D]
        range:
          min: 0
          max: 1000
          default: 0

      - name: "Date & Time"
        platform: datetime
        update_interval: 60
        rule: 8
        registers: [0x003E, 0x003F, 0x0040]

      - name: "" # On/Off Switch (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
        platform: switch
        rule: 1
        registers: [0x0050]

  - group: Settings
    update_interval: 300
    items:
      - name: "Battery Control Mode"
        platform: "select"
        rule: 1
        registers: [0x0062]
        icon: "mdi:battery"
        lookup:
          - key: 0x0000
            value: "Lead-Battery, four-stage charging method"
          - key: 0x0001
            value: "Lithium"

      - name: "Battery Equalization"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0063]
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: [6100, 8000]

      - name: "Battery Absorption"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0064]
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: [6100, 8000]

      - name: "Battery Float"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0065]
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: [6100, 8000]

      - name: "Battery Capacity"
        platform: number
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x0066]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 2000

      - name: "Battery Empty"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0067]
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        icon: "mdi:battery"

      - name: "Zero Export power"
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x0068]
        range:
          min: 0
          max: [65535, 655350]
        configurable:
          min: 0
          max: 500
          step: 10
          mode: box
        icon: "mdi:transmission-tower"

      - name: "Battery Equalization Cycle"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "d"
        rule: 1
        registers: [0x0069]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 90

      - name: "Battery Equalization Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.5
        rule: 1
        registers: [0x006A]
        configurable:
          min: 0
          max: 10
          mode: box
        icon: "mdi:battery"
        range:
          min: 0
          max: 20

      - name: "Battery Temperature Compensation"
        platform: number
        state_class: "measurement"
        uom: "mV/*C"
        rule: 2
        registers: [0x006B]
        configurable:
          min: 0
          max: 50
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 0
          max: 50

      - name: "Battery Max Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x006C]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 350

      - name: "Battery Max Discharging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x006D]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 350

      - name: "Battery Operation Mode"
        platform: "select"
        rule: 1
        registers: [0x006F]
        icon: mdi:battery
        lookup:
          - key: 0x0000
            value: Voltage
          - key: 0x0001
            value: Capacity
          - key: 0x0002
            value: No Battery

      - name: "Battery Wake Up"
        platform: "switch"
        rule: 1
        registers: [0x0081]
        value:
          on: 0x101
          off: 0x00

      - name: Battery Resistance
        platform: number
        state_class: measurement
        uom: "mΩ"
        rule: 1
        registers: [0x0071]
        icon: mdi:battery
        range:
          min: 0
          max: 6000

      - name: Battery Charging efficiency
        platform: number
        state_class: measurement
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x0072]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 1000
        validation:
          min: 0
          max: 100

      - name: Battery Shutdown SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0073]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Restart SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0074]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Low SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0075]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Shutdown Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0076]
        icon: mdi:battery
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        range:
          min: 3800
          max: [6100, 8000]

      - name: Battery Restart Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0077]
        icon: mdi:battery
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        range:
          min: 3800
          max: [6100, 8000]

      - name: Battery Low Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0078]
        icon: mdi:battery
        configurable:
          min: 38
          max: [61, 800]
          step: 0.1
          mode: box
        range:
          min: 3800
          max: [6100, 8000]

      - name: "Generator Operating Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.1
        rule: 1
        registers: [0x0079]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 24
          mode: box
        range:
          min: 0
          max: 240

      - name: "Generator Cooling Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.1
        rule: 1
        registers: [0x007A]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 24
          mode: box
        range:
          min: 0
          max: 240

      - name: Battery Generator Charging Start Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x007B]
        icon: mdi:battery
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]

      - name: Battery Generator Charging Start
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x007C]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "Battery Generator Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x007D]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 240

      - name: "Battery Grid Charging Start Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x007E]
        icon: "mdi:battery"
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]

      - name: "Battery Grid Charging Start"
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x007F]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "Battery Grid Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x0080]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 350

      - name: "Battery Generator Charging"
        platform: "switch"
        rule: 1
        registers: [0x0081]
        icon: "mdi:battery"

      - name: "Battery Grid Charging"
        platform: "switch"
        rule: 1
        registers: [0x0082]
        icon: "mdi:battery"

      - name: "Generator"
        name_lookup: "io_mode_select"
        platform: "switch"
        rule: 1
        registers: [0x0084]

      - name: "IO Mode"
        alt: Generator input mode
        description: The Generator/SmartLoad/Microinverter input-output mode
        platform: "select"
        rule: 1
        registers: [0x0085]
        icon: "mdi:lightning-bolt-circle"
        lookup:
          - key: 0x0000
            value: "Generator"
          - key: 0x0001
            value: "SmartLoad"
          - key: 0x0002
            value: "Microinverter"

      - name: "SmartLoad Off Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0086]
        icon: "mdi:battery"
        configurable:
          min: 38
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 3800
          max: [6300, 8000]

      - name: "SmartLoad Off"
        platform: number
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x0087]
        icon: "mdi:lightning-bolt-circle"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "SmartLoad On Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x0088]
        icon: "mdi:battery"
        configurable:
          min: 38
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 3800
          max: [6300, 8000]

      - name: "SmartLoad On"
        platform: number
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x0089]
        icon: "mdi:lightning-bolt-circle"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

  - group: Grid Parameters
    update_interval: 300
    items:
      - name: Grid Voltage
        platform: "select"
        registers: [0x008A]
        rule: 1
        lookup:
          - key: 0x0
            value: LN:220VAC LL:380VAC
          - key: 0x1
            value: LN:230VAC LL:398VAC
          - key: 0x2
            value: LN:240VAC LL:415VAC
          - key: 0x3
            value: LN:120VAC LL:208VAC
          - key: 0x4
            value: LN:133VAC LL:220VAC
          - key: 0x5
            value: LN:100VAC LL:173VAC

      - name: "Generator Min PV Power"
        name_lookup: "io_mode_select"
        enabled_lookup:
          io_mode_select: [Generator, SmartLoad]
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        registers: [0x008B]
        icon: "mdi:solar-power-variant"
        range:
          min: 0000
          max: 8000

      - name: Charging Signal
        platform: "select"
        rule: 1
        registers: [0x008C]
        lookup:
          - key: 0x0000
            value: "Normal"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

  - group: Work Mode
    update_interval: 300
    items:
      - name: Energy Pattern
        platform: "select"
        rule: 1
        registers: [0x008D]
        lookup:
          - key: 0x0000
            value: "Battery First"
          - key: 0x0001
            value: "Load First"

      - name: Work Mode
        platform: "select"
        rule: 1
        registers: [0x008E]
        lookup:
          - key: 0x0000
            value: "Export First"
          - key: 0x0001
            value: "Zero Export To Load"
          - key: 0x0002
            value: "Zero Export To CT"

      - name: Export Surplus Power
        alt: Max Sell Power
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x008F]
        configurable:
          min: 0
          max: [24000, 80000]
        range:
          min: 0
          max: [24000, 8000]

      - name: Export Surplus
        alt: Solar Sell
        platform: "switch"
        rule: 1
        registers: [0x0091]

      - name: Export Asymmetry
        alt: Asymmetric phase feeding
        platform: switch
        rule: 1
        registers: [0x00ED]

      - name: PV Power
        description: Max PV power limiter
        alt: Max Solar Power
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x0154]
        icon: "mdi:solar-power-variant"
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: MPPT multi-point scanning
        description: Find the MPP even when there are partial shading conditions on the solar panels
        platform: "switch"
        rule: 1
        registers: [0x0155]
        value:
          bit: 2

      - name: Time of Use
        platform: select
        rule: 1
        registers: [0x0092]
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0003
            value: "Monday"
          - key: 0x0005
            value: "Tuesday"
          - key: 0x0009
            value: "Wednesday"
          - key: 0x0011
            value: "Thursday"
          - key: 0x0021
            value: "Friday"
          - key: 0x0041
            value: "Saturday"
          - key: 0x0081
            value: "Sunday"
          - key: 0x003F
            value: "Weekdays"
          - key: 0x00C1
            value: "Weekend"
          - key: 0x00FD
            value: "Week -Monday"
          - key: 0x00FB
            value: "Week -Tuesday"
          - key: 0x00F7
            value: "Week -Wednesday"
          - key: 0x00EF
            value: "Week -Thursday"
          - key: 0x00DF
            value: "Week -Friday"
          - key: 0x00BF
            value: "Week -Saturday"
          - key: 0x007F
            value: "Week -Sunday"
          - key: 0x00FF
            value: "Week"
          - bit: 0
            mode: "|"
            value: "Enabled"

      - name: Program 1 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0094]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 2 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0095]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 3 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0096]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 4 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0097]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 5 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0098]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 6 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0099]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 1 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009A]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 2 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009B]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 3 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009C]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 4 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009D]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 5 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009E]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 6 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009F]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [32000, 128000]
        range:
          min: 0
          max: [32000, 12800]

      - name: Program 1 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A0]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 2 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A1]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 3 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A2]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 4 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A3]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 5 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A4]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 6 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00A5]
        configurable:
          min: 00
          max: [63, 800]
          step: 0.1
          mode: box
        range:
          min: 0000
          max: [6300, 8000]
        icon: mdi:sun-clock

      - name: Program 1 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A6]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 2 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A7]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 3 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A8]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 4 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A9]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 5 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00AA]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 6 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00AB]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 1 Charging
        platform: select
        rule: 1
        registers: [0x00AC]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 2 Charging
        platform: select
        rule: 1
        registers: [0x00AD]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 3 Charging
        platform: select
        rule: 1
        registers: [0x00AE]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 4 Charging
        platform: select
        rule: 1
        registers: [0x00AF]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 5 Charging
        platform: select
        rule: 1
        registers: [0x00B0]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 6 Charging
        platform: select
        rule: 1
        registers: [0x00B1]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Microinverter Export cut-off
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 0

      - name: Generator Peak shaving
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 2

      - name: Grid Peak shaving
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 4

      - name: Generator On-Grid
        description: On Grid always on
        name_lookup: io_mode_select
        enabled_lookup:
          io_mode_select: [Generator, SmartLoad]
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 6

      - name: Off Grid
        platform: switch
        rule: 1
        range:
          min: 0
          max: 1
        registers: [0x00B3]

      - name: Grid reconnection time
        platform: number
        rule: 1
        range:
          min: 1
          max: 300
        registers: [0x00B4]

      - name: Grid frequency
        platform: "select"
        rule: 1
        registers: [0x00B7]
        lookup:
          - key: 0x0
            value: 50 Hz
          - key: 0x1
            value: 60 Hz

      - name: "Grid voltage protection - high"
        platform: number
        class: "voltage"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x00B9]
        configurable:
          mode: box
        range:
          min: 1000
          max: 2900

      - name: "Grid voltage protection - low"
        platform: number
        class: "voltage"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x00BA]
        configurable:
          mode: box
        range:
          min: 1000
          max: 2900

      - name: "Grid frequency protection - high"
        platform: number
        class: "frequency"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x00BB]
        configurable:
          mode: box
        range:
          min: 4500
          max: 6500

      - name: "Grid frequency protection - low"
        platform: number
        class: "frequency"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x00BC]
        configurable:
          mode: box
        range:
          min: 4500
          max: 6500

      - name: Generator Grid side
        description: The generator is connected to the grid input
        platform: "switch"
        rule: 1
        registers: [0x00BD]

      - name: "Generator Peak shaving"
        platform: number
        class: "power"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x00BE]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 22000
        range:
          min: 0
          max: [22000, 2200]

      - name: "Grid Peak shaving"
        platform: number
        class: "power"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x00BF]
        icon: "mdi:transmission-tower"
        configurable:
          min: 0
          max: 80000
        range:
          min: 0
          max: [80000, 8000]

      - name: "Grid Max Export power"
        platform: number
        class: "power"
        uom: "W"
        scale: 10
        rule: 1
        registers: [0x00E7]
        range:
          min: 0
          max: 8000

      - name: "Grid Max Import power"
        platform: number
        class: "power"
        uom: "W"
        scale: 10
        rule: 1
        registers: [0x00E9]
        range:
          min: 0
          max: 8000

      - name: AC Coupling
        description: Couple inverters and batteries using AC lines
        platform: "select"
        rule: 1
        registers: [0x00EA]
        lookup:
          - key: 0
            value: Disabled
          - bit: 0
            value: Grid
          - bit: 1
            value: Load

  - group: BMS 1
    items:
      - name: "BMS 1 Charging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D2]

      - name: "BMS 1 Discharging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D3]

      - name: "BMS 1 Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00D4]
        icon: "mdi:current-dc"

      - name: "BMS 1 Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00D5]
        icon: "mdi:current-dc"

      - name: "BMS 1 SOC"
        attribute:
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x00D6]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101

      - name: "BMS 1 Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D7]

      - name: "BMS 1 Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: [1, 0.1]
        rule: 2
        registers: [0x00D8]
        icon: "mdi:current-dc"

      - name: "BMS 1 Temperature"
        attribute:
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 0.1
        offset: 1000
        registers: [0x00D9]
        icon: "mdi:thermometer"

      - name: "BMS 1 Max Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00DA]
        icon: "mdi:current-dc"

      - name: "BMS 1 Max Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00DB]
        icon: "mdi:current-dc"

      - name: "BMS 1 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DC]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "BMS 1 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DD]
        icon: "mdi:battery-alert-variant"
        range:
          min: 0
          max: 65535
        attributes: ["value"]

      - name: "BMS 1 Battery 1 Force Charge Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-alert"
        bit: 1

      - name: "BMS 1 Battery 2 Force Charge Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-alert"
        bit: 2

      - name: "BMS 1 Sleep Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-outline"
        bit: 3

      - name: "BMS 1 Other Flag"
        attribute:
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-unknown"
        range:
          min: 0
          max: 65535

      - name: "BMS 1 Type"
        platform: select
        rule: 1
        registers: [0x00DF]
        icon: "mdi:battery"
        lookup:
          - key: 0x0000
            value: "PYLON/CAN"
          - key: 0x0001
            value: "Tianbangda RS485"
          - key: 0x0002
            value: "KOK"
          - key: 0x0003
            value: "Keith"
          - key: 0x0004
            value: "Toppai"
          - key: 0x0005
            value: "Peneng 485"
          - key: 0x0006
            value: "Jeris 485"
          - key: 0x0007
            value: "Sunwoda 485"
          - key: 0x0008
            value: "Xinrui 485"
          - key: 0x0009
            value: "Tianbangda 485"
          - key: 0x000A
            value: "Shenggao Electric CAN"

      - name: "BMS 1 State of Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x00E0]
        icon: "mdi:battery-heart"

      - name: "BMS 1 Software Version"
        attribute:
        state_class: "measurement"
        rule: 7
        registers: [0x00E1]
        icon: "mdi:alpha-v"

      - name: "BMS 1 Rated Ah"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x00E2]
        icon: "mdi:battery"

      - name: "BMS 1 Hardware Version"
        attribute:
        state_class: "measurement"
        rule: 7
        registers: [0x00E3]
        icon: "mdi:alpha-v"

  - group: BMS 2
    items:
      - name: "BMS 2 Charging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00F1]

      - name: "BMS 2 Discharging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00F2]

      - name: "BMS 2 Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00F3]
        icon: "mdi:current-dc"

      - name: "BMS 2 Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00F4]
        icon: "mdi:current-dc"

      - name: "BMS 2 SOC"
        attribute:
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x00F5]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101

      - name: "BMS 2 Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00F6]

      - name: "BMS 2 Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: [1, 0.1]
        rule: 2
        registers: [0x00F7]
        icon: "mdi:current-dc"

      - name: "BMS 2 Temperature"
        attribute:
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 0.1
        offset: 1000
        registers: [0x00F8]
        icon: "mdi:thermometer"

      - name: "BMS 2 Max Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00F9]
        icon: "mdi:current-dc"

      - name: "BMS 2 Max Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00FA]
        icon: "mdi:current-dc"

      - name: "BMS 2 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00FB]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "BMS 2 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00FC]
        icon: "mdi:battery-alert-variant"
        range:
          min: 0
          max: 65535
        attributes: ["value"]

      - name: "BMS 2 Battery 1 Force Charge Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00FD]
        icon: "mdi:battery-alert"
        bit: 1

      - name: "BMS 2 Battery 2 Force Charge Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00FD]
        icon: "mdi:battery-alert"
        bit: 2

      - name: "BMS 2 Sleep Flag"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00FD]
        icon: "mdi:battery-outline"
        bit: 3

      - name: "BMS 2 Other Flag"
        attribute:
        rule: 1
        registers: [0x00FD]
        icon: "mdi:battery-unknown"
        range:
          min: 0
          max: 65535

      - name: "BMS 2 Type"
        platform: select
        rule: 1
        registers: [0x00FE]
        icon: "mdi:battery"
        lookup:
          - key: 0x0000
            value: "PYLON/CAN"
          - key: 0x0001
            value: "Tianbangda RS485"
          - key: 0x0002
            value: "KOK"
          - key: 0x0003
            value: "Keith"
          - key: 0x0004
            value: "Toppai"
          - key: 0x0005
            value: "Peneng 485"
          - key: 0x0006
            value: "Jeris 485"
          - key: 0x0007
            value: "Sunwoda 485"
          - key: 0x0008
            value: "Xinrui 485"
          - key: 0x0009
            value: "Tianbangda 485"
          - key: 0x000A
            value: "Shenggao Electric CAN"

      - name: "BMS 2 State of Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x00FF]
        icon: "mdi:battery-heart"

      - name: "BMS 2 Software Version"
        attribute:
        state_class: "measurement"
        rule: 7
        registers: [0x0100]
        icon: "mdi:alpha-v"

      - name: "BMS 2 Rated Ah"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x0101]
        icon: "mdi:battery"

      - name: "BMS 2 Hardware Version"
        attribute:
        state_class: "measurement"
        rule: 7
        registers: [0x0102]
        icon: "mdi:alpha-v"

  - group: Meter
    update_interval: 30
    items:
      - name: Today Battery Charge
        alt: Daily Battery Charge
        friendly_name: Today's Battery Charge
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0202]
        icon: "mdi:battery-plus"

      - name: Today Battery Discharge
        alt: Daily Battery Discharge
        friendly_name: Today's Battery Discharge
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0203]
        icon: "mdi:battery-minus"

      - name: "Total Battery Charge"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x0204, 0x0205]
        icon: "mdi:battery-plus"
        validation:
          min: 0.1

      - name: "Total Battery Discharge"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x0206, 0x0207]
        icon: "mdi:battery-minus"
        validation:
          min: 0.1

      - name: Today Battery Life Cycles
        alt: Daily Battery Life Cycles
        friendly_name: Today's Battery Life Cycles
        description: Calculates today's battery life cycles based on today's charged amount
        state_class: "total_increasing"
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"

      - name: "Total Battery Life Cycles"
        description: Calculates total battery life cycles based on total charged amount
        state_class: "total_increasing"
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"
        validation:
          min: 0.1

      - name: Today Energy Import
        alt: Daily Energy Bought
        friendly_name: Today's Energy Import
        description: Today's energy imported from the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0208]
        icon: "mdi:transmission-tower-export"

      - name: Today Energy Export
        alt: Daily Energy Sold
        friendly_name: Today's Energy Export
        description: Today's energy exported/returned to the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0209]
        icon: "mdi:transmission-tower-import"

      - name: Total Energy Import
        alt: Total Energy Bought
        description: Total energy imported from the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x020A, 0x020B]
        icon: "mdi:transmission-tower-export"
        validation:
          min: 0.1

      - name: Total Energy Export
        alt: Total Energy Sold
        description: Total energy exported/returned to the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x020C, 0x020D]
        icon: "mdi:transmission-tower-import"
        validation:
          min: 0.1

      - name: Today Load Consumption
        alt: Daily Load Consumption
        friendly_name: Today's Load Consumption
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x020E]

      - name: "Total Load Consumption"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x020F, 0x0210]
        validation:
          min: 0.1

      - name: Generator Energy - today
        name_lookup: "io_mode_select"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0218]

      - name: Generator Energy
        name_lookup: "io_mode_select"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x0219, 0x021A]
        validation:
          min: 0.1

      - name: Today Production
        alt: Daily Production
        friendly_name: Today's Production
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 1
        registers: [0x0211]
        icon: "mdi:solar-power"
        validation:
          dev: 100
          invalidate_all: 2

      - name: "Total Production"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: [0.1, 0.1, 1]
        rule: 3
        registers: [0x0216, 0x0217]
        icon: "mdi:solar-power"
        validation:
          min: 0.1
          dev: 100
          invalidate_all: 2

      - name: Today Losses
        alt: Daily Losses
        friendly_name: Today's Losses
        description: Includes today's consumption of the inverter device itself as well AC/DC conversion losses
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 1
        digits: 1
        scale: [0.1, 0.1, 1]
        uint: enforce
        sensors:
          - registers: [0x0208]
          - registers: [0x0211]
          - registers: [[], [0x0218]]
            enabled_lookup:
              io_mode_select: [Generator, Microinverter]
          - registers: [0x0203]
          - operator: subtract
            registers: [0x0209]
          - operator: subtract
            registers: [0x020E]
          - operator: subtract
            registers: [0x0202]

      - name: Total Losses
        description: Includes total consumption of the inverter device itself as well AC/DC conversion losses
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 3
        digits: 1
        scale: [0.1, 0.1, 1]
        uint: enforce
        sensors:
          - registers: [0x020A, 0x020B]
          - registers: [0x0216, 0x0217]
          - registers: [[], [0x0219, 0x021A]]
            enabled_lookup:
              io_mode_select: [Generator, Microinverter]
          - registers: [0x0206, 0x0207]
          - operator: subtract
            registers: [0x020C, 0x020D]
          - operator: subtract
            registers: [0x020F, 0x0210]
          - operator: subtract
            registers: [0x0204, 0x0205]
        validation:
          min: 1

      - name: "DC Temperature"
        hidden:
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021C]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

      - name: "Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021D]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

  - group: State
    update_interval: 30
    items:
      - name: "Device State"
        class: "enum"
        rule: 1
        registers: [0x01F4]
        icon: "mdi:state-machine"
        range:
          min: 0
          max: 5
        lookup:
          - key: 0x0000
            value: "Standby"
          - key: 0x0001
            value: "Self-test"
          - key: 0x0002
            value: "Normal"
          - key: 0x0003
            value: "Alarm"
          - key: 0x0004
            value: "Fault"

      - name: "" # Power On/Off (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
        platform: "binary_sensor"
        device_class: running
        rule: 1
        registers: [0x0227]

      - name: "Device Relay"
        class: "enum"
        rule: 1
        registers: [0x0228]
        icon: "mdi:directions-fork"
        lookup:
          - key: 0x0000
            value: "Off"
          - key: [0x0001, 0x0003]
            value: "Inverter"
          - key: [0x0004, 0x0006]
            value: "Grid"
          - key: [0x0005, 0x0007]
            value: "Inverter-Grid"
          - key: 0x0008
            value: "Generator"
          - key: [0x0009, 0x000B]
            value: "Inverter-Gen"
          - key: [0x000C, 0x000E]
            value: "Grid-Generator"
          - key: [0x000D, 0x000F]
            value: "Inv-Grid-Gen"
          - key: default
            value: "Power Supply"

      - name: "Grid"
        platform: "binary_sensor"
        device_class: power
        rule: 1
        registers: [0x0228]
        bit: 2
        icon: "mdi:transmission-tower"

      - name: "Generator"
        name_lookup: "io_mode_select"
        platform: "binary_sensor"
        device_class: power
        rule: 1
        registers: [0x0228]
        bit: 3
        icon: "mdi:lightning-bolt-circle"

      # Alarm message (word 1 & 2) [0, 65535]
      - name: "Device Alarm"
        class: "enum"
        rule: 3
        registers: [0x0229, 0x022A]
        icon: "mdi:alert-outline"
        lookup:
          - key: 0
            value: "OK"
          - bit: 1
            value: "Fan failure"
          - bit: 2
            value: "Grid phase failure"
          - bit: 3
            value: "Meter communication failure"
          - bit: 30
            value: "Battery loss"
          - bit: 31
            value: "Parallel communication quality"
          - key: default
            value: Problem

      # Fault message (word 1, 2, 3 & 4) [0, 65535]
      - name: "Device Fault"
        class: "enum"
        rule: 3
        registers: [0x22B, 0x022C, 0x022D, 0x022E]
        icon: "mdi:message-alert-outline"
        lookup:
          - key: 0
            value: "OK"
          - bit: 6
            value: "DC/DC Soft Start failure"
          - bit: 9
            value: "Auxiliary power supply failure"
          - bit: 12
            value: "Working mode changed"
          - bit: 17
            value: "AC Over-current failure"
          - bit: 18
            value: "Tz_Integ_Fault failure"
          - bit: 19
            value: "DC Over-current failure"
          - bit: 22
            value: "AC current leakage failure"
          - bit: 63
            value: "Temperature is too high"
          - key: default
            value: Problem

  - group: Battery
    update_interval: 5
    items:
      # Battery - The temperature of battery 1
      - name: "Battery Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        sensors:
          - signed:
            registers: [0x024A]
          - signed:
            registers: [0x0254]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
        icon: "mdi:thermometer"

      # Battery - The voltage of battery 1 (L:0.01V, H:0.1V)
      - name: "Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        sensors:
          - signed:
            registers: [0x024B]
          - signed:
            registers: [0x0251]

      # Battery - The State of Charge (SOC) of battery 1
      - name: "Battery A"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x024C]
        range:
          min: 0
          max: 100
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery Corrected Capacity",
            "BMS 1 SOC",
            "BMS 1 Current",
            "BMS 1 Voltage",
            "BMS 1 Other Symbol",
            "BMS 1 Charging Voltage",
            "BMS 1 Discharging Voltage",
            "BMS 1 Charging Current",
            "BMS 1 Discharging Current",
            "BMS 1 Max Charging Current",
            "BMS 1 Max Discharging Current",
            "BMS 1 Rated Ah",
            "BMS 1 State of Health",
          ]

      # Battery - The State of Charge (SOC) of battery 2
      - name: "Battery B"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x024D]
        range:
          min: 0
          max: 100
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery Corrected Capacity",
            "BMS 2 SOC",
            "BMS 2 Current",
            "BMS 2 Voltage",
            "BMS 2 Other Symbol",
            "BMS 2 Charging Voltage",
            "BMS 2 Discharging Voltage",
            "BMS 2 Charging Current",
            "BMS 2 Discharging Current",
            "BMS 2 Max Charging Current",
            "BMS 2 Max Discharging Current",
            "BMS 2 Rated Ah",
            "BMS 2 State of Health",
          ]

      # Battery - The power of battery is S16bit
      - name: "Battery Power"
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 2
        sensors:
          - signed:
            registers: [0x024E]
          - signed:
            registers: [0x0253]
        attributes: [inverse]

      # Battery - The state of health
      - name: "Battery SOH"
        description: Calculates state of health based on total charged amount
        state_class: "measurement"
        uom: "%"
        rule: 0
        digits: 2
        icon: "mdi:battery-heart"

      # Battery - Capacity
      - name: "Battery Capacity"
        description: Estimates capacity of the battery during (dis)charging
        class: energy_storage
        state_class: measurement
        uom: "kWh"
        rule: 0
        digits: 1
        icon: "mdi:battery-check"

      # Battery - The state of battery
      - name: "Battery State"
        description: Determines battery state from battery power by +-50 W
        class: "enum"
        rule: 0
        options: ["charging", "idle", "discharging"]
        icon: "mdi:battery"

      # Battery - The current of battery 1 is S16bit (low 16 bits)
      - name: "Battery Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        sensors:
          - signed:
            registers: [0x024F]
          - signed:
            registers: [0x0252]
        icon: "mdi:current-dc"

      # Battery - Actual capacity of the battery
      - name: "Battery Corrected Capacity"
        attribute:
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x0250]
        icon: "mdi:battery"
        range:
          min: 0
          max: 3000

  - group: Grid
    update_interval: 5
    items:
      # Grid side - The voltage of phase A
      - name: "Grid L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0256]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase B
      - name: "Grid L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0257]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase C
      - name: "Grid L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0258]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025C, 0x02BC]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025D, 0x02BD]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025E, 0x02BE]
        icon: "mdi:transmission-tower"

      # Grid internal - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025F, 0x02BF]
        validation:
          lookup: "device_rated_power_sensor"
          scale: 1.1
          invalidate_all:
        icon: "mdi:transmission-tower"

      - name: "Grid Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x0261]

      # Grid internal - The current of phase A is S16bit (low 16 bits)
      - name: "Internal CT1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0262]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase B is S16bit (low 16 bits)
      - name: "Internal CT2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0263]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase C is S16bit (low 16 bits)
      - name: "Internal CT3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0264]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase A is S16bit (low 16 bits)
      - name: "External CT1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0265]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase B is S16bit (low 16 bits)
      - name: "External CT2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0266]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase C is S16bit (low 16 bits)
      - name: "External CT3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0267]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0268, 0x02C1]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0269, 0x02C2]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026A, 0x02C3]
        icon: "mdi:transmission-tower"

      # Grid external - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026B, 0x02C4]
        icon: "mdi:transmission-tower"

      - name: "Grid Power Factor"
        class: "power_factor"
        state_class: "measurement"
        uom:
        scale: 0.001
        suggested_display_precision: 2
        rule: 1
        registers: [0x026D]
        range:
          min: 0
          max: 1000
        icon: "mdi:transmission-tower"

      # The following three (four) registers change according to the built-in and external settings
      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026E, 0x02AF]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026F, 0x02B0]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0270, 0x02B1]
        icon: "mdi:transmission-tower"

      # Grid - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid Power"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0271, 0x02B2]
        icon: "mdi:transmission-tower"
        attributes: [inverse]

  - group: Output
    update_interval: 5
    items:
      # Output - The voltage of phase A
      - name: "Output L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0273]

      # Output - The voltage of phase B
      - name: "Output L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0274]

      # Output - The voltage of phase C
      - name: "Output L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0275]

      # Output - The current of phase A is S16bit (low 16 bits)
      - name: "Output L1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0276]

      # Output - The current of phase B is S16bit (low 16 bits)
      - name: "Output L2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0277]

      # Output - The current of phase C is S16bit (low 16 bits)
      - name: "Output L3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0278]

      # Output - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0279, 0x02B3]

      # Output - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027A, 0x02B4]

      # Output - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027B, 0x02B5]

      # Output - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Power"
        alt: Output Power
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027C, 0x02B6]
        validation:
          lookup: "device_rated_power_sensor"
          scale: 1.1
          invalidate_all:

      - name: "Power losses"
        description: Includes consumption of the inverter device itself as well AC/DC conversion losses
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        scale: [1, 10]
        uint: enforce
        sensors:
          - signed:
            registers: [0x024E]
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
          - registers: [0x02D7]
            mppt: 5
          - registers: [0x02D8]
            mppt: 6
          - registers: [0x02D9]
            mppt: 7
          - registers: [0x02DA]
            mppt: 8
          - operator: subtract
            signed:
            scale: 1
            registers: [0x027C, 0x02B6]

      - name: "Output Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x027E]

  - group: UPS
    update_interval: 5
    items:
      # Load UPS output - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load UPS L1 Power"
        l: 1
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0280, 0x02B8]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load UPS L2 Power"
        l: 2
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0281, 0x02B9]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load UPS L3 Power"
        l: 3
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0282, 0x02BA]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load UPS Power"
        l: 1
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0283, 0x02BB]
        icon: "mdi:home-lightning-bolt"

  - group: Load
    update_interval: 5
    items:
      # Load output - The voltage of phase A
      - name: "Load L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0284]

      # Load output - The voltage of phase B
      - name: "Load L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0285]

      # Load output - The voltage of phase C
      - name: "Load L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0286]

      - name: "Load L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        sensors:
          - signed:
            registers: [0x0279, 0x02B3]
          - signed:
            registers: [0x0268, 0x02C1]

      - name: "Load L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        sensors:
          - signed:
            registers: [0x027A, 0x02B4]
          - signed:
            registers: [0x0269, 0x02C2]

      - name: "Load L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        sensors:
          - signed:
            registers: [0x027B, 0x02B5]
          - signed:
            registers: [0x026A, 0x02C3]

      - name: "Load Power"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        sensors:
          - signed:
            registers: [0x027C, 0x02B6]
          - signed:
            registers: [0x026B, 0x02C4]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Consumption L1 Power"
        hidden:
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028A, 0x0290]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Consumption L2 Power"
        hidden:
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028B, 0x0291]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Consumption L3 Power"
        hidden:
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028C, 0x0292]

      # Load - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Consumption Power"
        hidden:
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028D, 0x0293]

      - name: "Load Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x028F]

  - group: Generator/SmartLoad/Microinverter
    update_interval: 5
    items:
      # Generator/SmartLoad/Microinverter - The voltage of phase A
      - name: "Generator L1 Voltage"
        name_lookup: "io_mode_select"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0295]

      # Generator/SmartLoad/Microinverter - The voltage of phase B
      - name: "Generator L2 Voltage"
        name_lookup: "io_mode_select"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0296]

      # Generator/SmartLoad/Microinverter - The voltage of phase C
      - name: "Generator L3 Voltage"
        name_lookup: "io_mode_select"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0297]

      # Generator - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L1 Power"
        name_lookup: "io_mode_select"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x0298, 0x029C]

      # Generator/SmartLoad/Microinverter - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L2 Power"
        name_lookup: "io_mode_select"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x0299, 0x029D]

      # Generator/SmartLoad/Microinverter - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L3 Power"
        name_lookup: "io_mode_select"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x029A, 0x029E]

      # Generator/SmartLoad/Microinverter - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator Power"
        name_lookup: "io_mode_select"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x029B, 0x029F]

  - group: PV
    update_interval: 5
    items:
      # PV - The combined power of Input 1..8 (L:1W, H:10W)
      - name: "PV Power"
        alt: DC Power
        mppt: 1
        description: Combined power of all inputs
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        scale: [1, 10]
        sensors:
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
          - registers: [0x02D7]
            mppt: 5
          - registers: [0x02D8]
            mppt: 6
          - registers: [0x02D9]
            mppt: 7
          - registers: [0x02DA]
            mppt: 8
        validation:
          min: 0
          max: [40000, 160000]
          invalidate_all:
        icon: "mdi:solar-power-variant"

      - name: "PV1 Power"
        alt: DC1 Power
        mppt: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A0]
        icon: "mdi:solar-power-variant"

      - name: "PV2 Power"
        alt: DC2 Power
        mppt: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A1]
        icon: "mdi:solar-power-variant"

      - name: "PV3 Power"
        alt: DC3 Power
        mppt: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A2]
        icon: "mdi:solar-power-variant"

      - name: "PV4 Power"
        alt: DC4 Power
        mppt: 4
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A3]
        icon: "mdi:solar-power-variant"

      - name: "PV1 Voltage"
        alt: DC1 Voltage
        mppt: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A4]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV1 Current"
        alt: DC1 Current
        mppt: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A5]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV2 Voltage"
        alt: DC2 Voltage
        mppt: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A6]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV2 Current"
        alt: DC2 Current
        mppt: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A7]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV3 Voltage"
        alt: DC3 Voltage
        mppt: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A8]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV3 Current"
        alt: DC3 Current
        mppt: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A9]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV4 Voltage"
        alt: DC4 Voltage
        mppt: 4
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02AA]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV4 Current"
        alt: DC4 Current
        mppt: 4
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02AB]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV5 Voltage"
        alt: DC5 Voltage
        mppt: 5
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02CF]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 10000

      - name: "PV6 Voltage"
        alt: DC6 Voltage
        mppt: 6
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02D0]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 10000

      - name: "PV7 Voltage"
        alt: DC7 Voltage
        mppt: 7
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02D1]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 10000

      - name: "PV8 Voltage"
        alt: DC8 Voltage
        mppt: 8
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02D2]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 10000

      - name: "PV5 Current"
        alt: DC5 Current
        mppt: 5
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02D3]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 1000

      - name: "PV6 Current"
        alt: DC6 Current
        mppt: 6
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02D4]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 1000

      - name: "PV7 Current"
        alt: DC7 Current
        mppt: 7
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02D5]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 1000

      - name: "PV8 Current"
        alt: DC8 Current
        mppt: 8
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02D6]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 1000

      - name: "PV5 Power"
        alt: DC5 Power
        mppt: 5
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02D7]
        icon: "mdi:solar-power-variant"

      - name: "PV6 Power"
        alt: DC6 Power
        mppt: 6
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02D8]
        icon: "mdi:solar-power-variant"

      - name: "PV7 Power"
        alt: DC7 Power
        mppt: 7
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02D9]
        icon: "mdi:solar-power-variant"

      - name: "PV8 Power"
        alt: DC8 Power
        mppt: 8
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02DA]
        icon: "mdi:solar-power-variant"

  - group: Battery 1
    via_device: "inverter"
    update_interval: 5
    pack: 1
    items:
      - name: "Battery 1 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        reverse_bytes:
        registers:
          [[0x2730, 0x2731, 0x2732, 0x2733, 0x2734, 0x2735, 0x2736, 0x2737], [0x2730, 0x2731, 0x2732, 0x2733, 0x2734, 0x2735, 0x2736, 0x2737]]

      - name: "Battery 1 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2738]]

      - name: "Battery 1 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2739]]

      - name: "Battery 1 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x273A]]

      # Always returning 0?
      - name: "Battery 1 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x273B]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 1 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x273C]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 1 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x273D]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 1 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2748], [0x273E]]

      - name: "Battery 1 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2738], [0x273F]]

      - name: "Battery 1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2739], []]
        icon: "mdi:current-dc"

      - name: "Battery 1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2740]]
        icon: "mdi:current-dc"

      - name: "Battery 1 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x273A], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x274A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x273B], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x274B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x274C]]

      - name: "Battery 1 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x274D]]

      - name: "Battery 1 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x273C], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x274E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x274F]]

      - name: "Battery 1 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2750]]

      - name: "Battery 1 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x273D], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x273E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2741]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x273F], [0x2742]]
        icon: "mdi:battery"

      - name: "Battery 1 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2740], [0x2743]]
        icon: "mdi:battery-heart"

      - name: "Battery 1 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2741], []]
        icon: "mdi:battery"

      - name: "Battery 1 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2742], []]
        icon: "mdi:battery"

      - name: "Battery 1 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2743], []]

      - name: "Battery 1 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2746], [0x2744]]

      - name: "Battery 1 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2745]]

      - name: "Battery 1 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2746]]

      - name: "Battery 1 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2747], [0x2747]]

      - name: "Battery 1 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2748]]

      - name: "Battery 1 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2749]]

      - name: "Battery 1 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2744], [0x2751]]
        icon: "mdi:current-dc"

      - name: "Battery 1 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2745], [0x2752]]
        icon: "mdi:current-dc"

      - name: "Battery 1 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2753]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2754]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2755]]

      - name: "Battery 1 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2755]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 1 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2756]]

      - name: "Battery 1 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2757]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2758]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2759]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x275A]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x275B]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x275C]]
        icon: "mdi:battery-alert"

      - name: "Battery 1 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x275D]]

      - name: "Battery 1 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x275E]]

      - name: "Battery 1 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x275F]]

      - name: "Battery 1 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2760]]

      - name: "Battery 1 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2761]]

      - name: "Battery 1 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2762]]

      - name: "Battery 1 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2763]]

      - name: "Battery 1 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2764]]

      - name: "Battery 1 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2765]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2766]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2767]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2768]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2769]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x276A]]

      - name: "Battery 1 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x276B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x276C]]

      - name: "Battery 1 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x276D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x276E]]

      - name: "Battery 1 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x276F]]
        icon: "mdi:omega"

      - name: "Battery 1 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2770]]
        icon: "mdi:omega"

      - name: "Battery 1 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2771]]
        icon: "mdi:omega"

      - name: "Battery 1 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2772]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 1 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2749], []]

      - name: "Battery 1 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x277D]]

      - name: "Battery 1 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x274E], []]

      - name: "Battery 1 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x274F], []]

      - name: "Battery 1 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2773, 0x2774]]

      - name: "Battery 1 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2775, 0x2776]]

      - name: "Battery 1 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2779, 0x277A]]

      - name: "Battery 1 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x277B, 0x277C]]

      - name: "Battery 1 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2777]]

      - name: "Battery 1 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2778]]

      - name: "Battery 1 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2746], [0x2744]]
          - operator: subtract
            registers: [[0x2747], [0x2747]]

      - name: "Battery 1 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x274A, 0x274B], [0x277E, 0x277F]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 1 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x274C, 0x274D], [0x2780, 0x2781]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 1"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x273F], [0x2742]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 1 Serial Number",
            "Battery 1 MOS Status",
            "Battery 1 Software Version",
            "Battery 1 Hardware Version",
            "Battery 1 BMS Software Version",
            "Battery 1 BMU Software Version",
            "Battery 1 BMS Hardware Version",
            "Battery 1 BMU Hardware Version",
          ]

  - group: Battery 2
    via_device: "inverter"
    update_interval: 5
    pack: 2
    items:
      - name: "Battery 2 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2756, 0x2757, 0x2758, 0x2759, 0x275A, 0x275B, 0x275C, 0x275D], [0x27A5, 0x27A6, 0x27A7, 0x27A8, 0x27A9, 0x27AA, 0x27AB, 0x27AC]]

      - name: "Battery 2 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x27AD]]

      - name: "Battery 2 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x27AE]]

      - name: "Battery 2 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27AF]]

      # Always returning 0?
      - name: "Battery 2 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x27B0]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 2 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x27B1]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 2 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x27B2]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 2 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x276E], [0x27B3]]

      - name: "Battery 2 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x275E], [0x27B4]]

      - name: "Battery 2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x275F], []]
        icon: "mdi:current-dc"

      - name: "Battery 2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x27B5]]
        icon: "mdi:current-dc"

      - name: "Battery 2 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2760], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x27BF]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2761], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x27C0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C1]]

      - name: "Battery 2 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C2]]

      - name: "Battery 2 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2762], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x27C3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C4]]

      - name: "Battery 2 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C5]]

      - name: "Battery 2 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2763], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2764], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27B6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2765], [0x27B7]]
        icon: "mdi:battery"

      - name: "Battery 2 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2766], [0x27B8]]
        icon: "mdi:battery-heart"

      - name: "Battery 2 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2767], []]
        icon: "mdi:battery"

      - name: "Battery 2 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2768], []]
        icon: "mdi:battery"

      - name: "Battery 2 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2769], []]

      - name: "Battery 2 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x276C], [0x27B9]]

      - name: "Battery 2 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27BA]]

      - name: "Battery 2 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27BB]]

      - name: "Battery 2 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x276D], [0x27BC]]

      - name: "Battery 2 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27BD]]

      - name: "Battery 2 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27BE]]

      - name: "Battery 2 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x276A], [0x27C6]]
        icon: "mdi:current-dc"

      - name: "Battery 2 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x276B], [0x27C7]]
        icon: "mdi:current-dc"

      - name: "Battery 2 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C8]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27C9]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x27CA]]

      - name: "Battery 2 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x27CA]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 2 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27CB]]

      - name: "Battery 2 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27CC]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27CD]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27CE]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27CF]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27D0]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27D1]]
        icon: "mdi:battery-alert"

      - name: "Battery 2 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27D2]]

      - name: "Battery 2 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27D3]]

      - name: "Battery 2 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27D4]]

      - name: "Battery 2 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27D5]]

      - name: "Battery 2 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x27D6]]

      - name: "Battery 2 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x27D7]]

      - name: "Battery 2 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x27D8]]

      - name: "Battery 2 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x27D9]]

      - name: "Battery 2 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27DA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27DB]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27DC]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27DD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27DE]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27DF]]

      - name: "Battery 2 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27E0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27E1]]

      - name: "Battery 2 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x27E2]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x27E3]]

      - name: "Battery 2 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x27E4]]
        icon: "mdi:omega"

      - name: "Battery 2 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x27E5]]
        icon: "mdi:omega"

      - name: "Battery 2 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x27E6]]
        icon: "mdi:omega"

      - name: "Battery 2 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x27E7]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 2 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x276F], []]

      - name: "Battery 2 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x27F2]]

      - name: "Battery 2 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2774], []]

      - name: "Battery 2 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2775], []]

      - name: "Battery 2 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x27E8, 0x27E9]]

      - name: "Battery 2 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x27EA, 0x27EB]]

      - name: "Battery 2 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x27EE, 0x27EF]]

      - name: "Battery 2 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x27F0, 0x27F1]]

      - name: "Battery 2 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x27EC]]

      - name: "Battery 2 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x27ED]]

      - name: "Battery 2 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x276C], [0x27B9]]
          - operator: subtract
            registers: [[0x276D], [0x27BC]]

      - name: "Battery 2 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2770, 0x2771], [0x27F3, 0x27F4]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 2 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2772, 0x2773], [0x27F5, 0x27F6]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 2"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2765], [0x27B7]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 2 Serial Number",
            "Battery 2 MOS Status",
            "Battery 2 Software Version",
            "Battery 2 Hardware Version",
            "Battery 2 BMS Software Version",
            "Battery 2 BMU Software Version",
            "Battery 2 BMS Hardware Version",
            "Battery 2 BMU Hardware Version",
          ]

  - group: Battery 3
    via_device: "inverter"
    update_interval: 5
    pack: 3
    items:
      - name: "Battery 3 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x277C, 0x277D, 0x277E, 0x277F, 0x2780, 0x2781, 0x2782, 0x2783], [0x281A, 0x281B, 0x281C, 0x281D, 0x281E, 0x281F, 0x2820, 0x2821]]

      - name: "Battery 3 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2822]]

      - name: "Battery 3 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2823]]

      - name: "Battery 3 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2824]]

      # Always returning 0?
      - name: "Battery 3 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2825]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 3 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2826]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 3 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2827]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 3 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2794], [0x2828]]

      - name: "Battery 3 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2784], [0x2829]]

      - name: "Battery 3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2785], []]
        icon: "mdi:current-dc"

      - name: "Battery 3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x282A]]
        icon: "mdi:current-dc"

      - name: "Battery 3 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2786], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2834]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2787], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2835]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2836]]

      - name: "Battery 3 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2837]]

      - name: "Battery 3 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2788], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2838]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2839]]

      - name: "Battery 3 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x283A]]

      - name: "Battery 3 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2789], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x278A], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x282B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x278B], [0x282C]]
        icon: "mdi:battery"

      - name: "Battery 3 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x278C], [0x282D]]
        icon: "mdi:battery-heart"

      - name: "Battery 3 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x278D], []]
        icon: "mdi:battery"

      - name: "Battery 3 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x278E], []]
        icon: "mdi:battery"

      - name: "Battery 3 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x278F], []]

      - name: "Battery 3 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2792], [0x282E]]

      - name: "Battery 3 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x282F]]

      - name: "Battery 3 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2830]]

      - name: "Battery 3 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2793], [0x2831]]

      - name: "Battery 3 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2832]]

      - name: "Battery 3 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2833]]

      - name: "Battery 3 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2790], [0x283B]]
        icon: "mdi:current-dc"

      - name: "Battery 3 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2791], [0x283C]]
        icon: "mdi:current-dc"

      - name: "Battery 3 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x283D]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x283E]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x283F]]

      - name: "Battery 3 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x283F]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 3 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2840]]

      - name: "Battery 3 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2841]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2842]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2843]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2844]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2845]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2846]]
        icon: "mdi:battery-alert"

      - name: "Battery 3 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2847]]

      - name: "Battery 3 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2848]]

      - name: "Battery 3 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2849]]

      - name: "Battery 3 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x284A]]

      - name: "Battery 3 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x284B]]

      - name: "Battery 3 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x284C]]

      - name: "Battery 3 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x284D]]

      - name: "Battery 3 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x284E]]

      - name: "Battery 3 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x284F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2850]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2851]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2852]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2853]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2854]]

      - name: "Battery 3 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2855]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2856]]

      - name: "Battery 3 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2857]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2858]]

      - name: "Battery 3 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2859]]
        icon: "mdi:omega"

      - name: "Battery 3 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x285A]]
        icon: "mdi:omega"

      - name: "Battery 3 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x285B]]
        icon: "mdi:omega"

      - name: "Battery 3 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x285C]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 3 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2795], []]

      - name: "Battery 3 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2867]]

      - name: "Battery 3 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x279A], []]

      - name: "Battery 3 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x279B], []]

      - name: "Battery 3 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x285D, 0x285E]]

      - name: "Battery 3 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x285F, 0x2860]]

      - name: "Battery 3 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2863, 0x2864]]

      - name: "Battery 3 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2865, 0x2866]]

      - name: "Battery 3 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2861]]

      - name: "Battery 3 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2862]]

      - name: "Battery 3 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2792], [0x282E]]
          - operator: subtract
            registers: [[0x2793], [0x2831]]

      - name: "Battery 3 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2796, 0x2797], [0x2868, 0x2869]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 3 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2798, 0x2799], [0x286A, 0x286B]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 3"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x278B], [0x282C]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 3 Serial Number",
            "Battery 3 MOS Status",
            "Battery 3 Software Version",
            "Battery 3 Hardware Version",
            "Battery 3 BMS Software Version",
            "Battery 3 BMU Software Version",
            "Battery 3 BMS Hardware Version",
            "Battery 3 BMU Hardware Version",
          ]

  - group: Battery 4
    via_device: "inverter"
    update_interval: 5
    pack: 4
    items:
      - name: "Battery 4 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x27A2, 0x27A3, 0x27A4, 0x27A5, 0x27A6, 0x27A7, 0x27A8, 0x27A9], [0x288F, 0x2890, 0x2891, 0x2892, 0x2893, 0x2894, 0x2895, 0x2896]]

      - name: "Battery 4 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2897]]

      - name: "Battery 4 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2898]]

      - name: "Battery 4 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2899]]

      # Always returning 0?
      - name: "Battery 4 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x289A]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 4 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x289B]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 4 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x289C]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 4 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x27BA], [0x289D]]

      - name: "Battery 4 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27AA], [0x289E]]

      - name: "Battery 4 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x27AB], []]
        icon: "mdi:current-dc"

      - name: "Battery 4 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x289F]]
        icon: "mdi:current-dc"

      - name: "Battery 4 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27AC], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x28A9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27AD], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x28AA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28AB]]

      - name: "Battery 4 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28AC]]

      - name: "Battery 4 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x27AE], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x28AD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28AE]]

      - name: "Battery 4 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28AF]]

      - name: "Battery 4 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27AF], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27B0], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28A0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27B1], [0x28A1]]
        icon: "mdi:battery"

      - name: "Battery 4 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27B2], [0x28A2]]
        icon: "mdi:battery-heart"

      - name: "Battery 4 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x27B3], []]
        icon: "mdi:battery"

      - name: "Battery 4 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x27B4], []]
        icon: "mdi:battery"

      - name: "Battery 4 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x27B5], []]

      - name: "Battery 4 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x27B8], [0x28A3]]

      - name: "Battery 4 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28A4]]

      - name: "Battery 4 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28A5]]

      - name: "Battery 4 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x27B9], [0x28A6]]

      - name: "Battery 4 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28A7]]

      - name: "Battery 4 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28A8]]

      - name: "Battery 4 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27B6], [0x28B0]]
        icon: "mdi:current-dc"

      - name: "Battery 4 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27B7], [0x28B1]]
        icon: "mdi:current-dc"

      - name: "Battery 4 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B2]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B3]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x28B4]]

      - name: "Battery 4 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x28B4]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 4 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B5]]

      - name: "Battery 4 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B6]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B7]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B8]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28B9]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28BA]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28BB]]
        icon: "mdi:battery-alert"

      - name: "Battery 4 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28BC]]

      - name: "Battery 4 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28BD]]

      - name: "Battery 4 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28BE]]

      - name: "Battery 4 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28BF]]

      - name: "Battery 4 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x28C0]]

      - name: "Battery 4 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x28C1]]

      - name: "Battery 4 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x28C2]]

      - name: "Battery 4 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x28C3]]

      - name: "Battery 4 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28C4]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28C5]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28C6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28C7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28C8]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28C9]]

      - name: "Battery 4 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28CA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28CB]]

      - name: "Battery 4 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x28CC]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x28CD]]

      - name: "Battery 4 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x28CE]]
        icon: "mdi:omega"

      - name: "Battery 4 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x28CF]]
        icon: "mdi:omega"

      - name: "Battery 4 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x28D0]]
        icon: "mdi:omega"

      - name: "Battery 4 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x28D1]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 4 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x27BB], []]

      - name: "Battery 4 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x28DC]]

      - name: "Battery 4 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x27C0], []]

      - name: "Battery 4 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x27C1], []]

      - name: "Battery 4 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x28D2, 0x28D3]]

      - name: "Battery 4 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x28D4, 0x28D5]]

      - name: "Battery 4 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x28D8, 0x28D9]]

      - name: "Battery 4 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x28DA, 0x28DB]]

      - name: "Battery 4 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x28D6]]

      - name: "Battery 4 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x28D7]]

      - name: "Battery 4 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x27B8], [0x28A3]]
          - operator: subtract
            registers: [[0x27B9], [0x28A6]]

      - name: "Battery 4 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x27BC, 0x27BD], [0x28DD, 0x28DE]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 4 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x27BE, 0x27BF], [0x28DF, 0x28E0]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 4"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27B1], [0x28A1]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 4 Serial Number",
            "Battery 4 MOS Status",
            "Battery 4 Software Version",
            "Battery 4 Hardware Version",
            "Battery 4 BMS Software Version",
            "Battery 4 BMU Software Version",
            "Battery 4 BMS Hardware Version",
            "Battery 4 BMU Hardware Version",
          ]

  - group: Battery 5
    via_device: "inverter"
    update_interval: 5
    pack: 5
    items:
      - name: "Battery 5 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x27C8, 0x27C9, 0x27CA, 0x27CB, 0x27CC, 0x27CD, 0x27CE, 0x27CF], [0x2904, 0x2905, 0x2906, 0x2907, 0x2908, 0x2909, 0x290A, 0x290B]]

      - name: "Battery 5 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x290C]]

      - name: "Battery 5 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x290D]]

      - name: "Battery 5 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x290E]]

      # Always returning 0?
      - name: "Battery 5 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x290F]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 5 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2910]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 5 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2911]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 5 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x27E0], [0x2912]]

      - name: "Battery 5 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27D0], [0x2913]]

      - name: "Battery 5 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x27D1], []]
        icon: "mdi:current-dc"

      - name: "Battery 5 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2914]]
        icon: "mdi:current-dc"

      - name: "Battery 5 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27D2], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x291E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27D3], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x291F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2920]]

      - name: "Battery 5 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2921]]

      - name: "Battery 5 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x27D4], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2922]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2923]]

      - name: "Battery 5 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2924]]

      - name: "Battery 5 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27D5], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27D6], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2915]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27D7], [0x2916]]
        icon: "mdi:battery"

      - name: "Battery 5 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27D8], [0x2917]]
        icon: "mdi:battery-heart"

      - name: "Battery 5 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x27D9], []]
        icon: "mdi:battery"

      - name: "Battery 5 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x27DA], []]
        icon: "mdi:battery"

      - name: "Battery 5 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x27DB], []]

      - name: "Battery 5 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x27DE], [0x2918]]

      - name: "Battery 5 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2919]]

      - name: "Battery 5 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x291A]]

      - name: "Battery 5 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x27DF], [0x291B]]

      - name: "Battery 5 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x291C]]

      - name: "Battery 5 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x291D]]

      - name: "Battery 5 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27DC], [0x2925]]
        icon: "mdi:current-dc"

      - name: "Battery 5 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27DD], [0x2926]]
        icon: "mdi:current-dc"

      - name: "Battery 5 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2927]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2928]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2929]]

      - name: "Battery 5 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2929]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 5 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292A]]

      - name: "Battery 5 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292B]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292C]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292D]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292E]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x292F]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2930]]
        icon: "mdi:battery-alert"

      - name: "Battery 5 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2931]]

      - name: "Battery 5 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2932]]

      - name: "Battery 5 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2933]]

      - name: "Battery 5 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2934]]

      - name: "Battery 5 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2935]]

      - name: "Battery 5 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2936]]

      - name: "Battery 5 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2937]]

      - name: "Battery 5 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2938]]

      - name: "Battery 5 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2939]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x293A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x293B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x293C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x293D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x293E]]

      - name: "Battery 5 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x293F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2940]]

      - name: "Battery 5 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2941]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2942]]

      - name: "Battery 5 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2943]]
        icon: "mdi:omega"

      - name: "Battery 5 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2944]]
        icon: "mdi:omega"

      - name: "Battery 5 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2945]]
        icon: "mdi:omega"

      - name: "Battery 5 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2946]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 5 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x27E1], []]

      - name: "Battery 5 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2951]]

      - name: "Battery 5 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x27E6], []]

      - name: "Battery 5 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x27E7], []]

      - name: "Battery 5 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2947, 0x2948]]

      - name: "Battery 5 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2949, 0x294A]]

      - name: "Battery 5 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x294D, 0x294E]]

      - name: "Battery 5 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x294F, 0x2950]]

      - name: "Battery 5 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x294B]]

      - name: "Battery 5 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x294C]]

      - name: "Battery 5 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x27DE], [0x2918]]
          - operator: subtract
            registers: [[0x27DF], [0x291B]]

      - name: "Battery 5 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x27E2, 0x27E3], [0x2952, 0x2953]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 5 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x27E4, 0x27E5], [0x2954, 0x2955]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 5"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27D7], [0x2916]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 5 Serial Number",
            "Battery 5 MOS Status",
            "Battery 5 Software Version",
            "Battery 5 Hardware Version",
            "Battery 5 BMS Software Version",
            "Battery 5 BMU Software Version",
            "Battery 5 BMS Hardware Version",
            "Battery 5 BMU Hardware Version",
          ]

  - group: Battery 6
    via_device: "inverter"
    update_interval: 5
    pack: 6
    items:
      - name: "Battery 6 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x27EE, 0x27EF, 0x27F0, 0x27F1, 0x27F2, 0x27F3, 0x27F4, 0x27F5], [0x2979, 0x297A, 0x297B, 0x297C, 0x297D, 0x297E, 0x297F, 0x2980]]

      - name: "Battery 6 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2981]]

      - name: "Battery 6 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2982]]

      - name: "Battery 6 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2983]]

      # Always returning 0?
      - name: "Battery 6 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2984]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 6 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2985]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 6 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2986]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 6 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2806], [0x2987]]

      - name: "Battery 6 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x27F6], [0x2988]]

      - name: "Battery 6 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x27F7], []]
        icon: "mdi:current-dc"

      - name: "Battery 6 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2989]]
        icon: "mdi:current-dc"

      - name: "Battery 6 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27F8], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2993]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x27F9], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2994]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2995]]

      - name: "Battery 6 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2996]]

      - name: "Battery 6 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x27FA], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2997]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2998]]

      - name: "Battery 6 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2999]]

      - name: "Battery 6 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27FB], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x27FC], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x298A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27FD], [0x298B]]
        icon: "mdi:battery"

      - name: "Battery 6 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27FE], [0x298C]]
        icon: "mdi:battery-heart"

      - name: "Battery 6 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x27FF], []]
        icon: "mdi:battery"

      - name: "Battery 6 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2800], []]
        icon: "mdi:battery"

      - name: "Battery 6 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2801], []]

      - name: "Battery 6 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2804], [0x298D]]

      - name: "Battery 6 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x298E]]

      - name: "Battery 6 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x298F]]

      - name: "Battery 6 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2805], [0x2990]]

      - name: "Battery 6 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2991]]

      - name: "Battery 6 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2992]]

      - name: "Battery 6 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2802], [0x299A]]
        icon: "mdi:current-dc"

      - name: "Battery 6 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2803], [0x299B]]
        icon: "mdi:current-dc"

      - name: "Battery 6 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x299C]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x299D]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x299E]]

      - name: "Battery 6 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x299E]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 6 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x299F]]

      - name: "Battery 6 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A0]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A1]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A2]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A3]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A4]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29A5]]
        icon: "mdi:battery-alert"

      - name: "Battery 6 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29A6]]

      - name: "Battery 6 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29A7]]

      - name: "Battery 6 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29A8]]

      - name: "Battery 6 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29A9]]

      - name: "Battery 6 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x29AA]]

      - name: "Battery 6 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x29AB]]

      - name: "Battery 6 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x29AC]]

      - name: "Battery 6 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x29AD]]

      - name: "Battery 6 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29AE]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29AF]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29B0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29B1]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29B2]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29B3]]

      - name: "Battery 6 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29B4]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29B5]]

      - name: "Battery 6 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29B6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29B7]]

      - name: "Battery 6 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x29B8]]
        icon: "mdi:omega"

      - name: "Battery 6 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x29B9]]
        icon: "mdi:omega"

      - name: "Battery 6 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x29BA]]
        icon: "mdi:omega"

      - name: "Battery 6 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x29BB]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 6 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2807], []]

      - name: "Battery 6 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x29C6]]

      - name: "Battery 6 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x280C], []]

      - name: "Battery 6 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x280D], []]

      - name: "Battery 6 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x29BC, 0x29BD]]

      - name: "Battery 6 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x29BE, 0x29BF]]

      - name: "Battery 6 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x29C2, 0x29C3]]

      - name: "Battery 6 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x29C4, 0x29C5]]

      - name: "Battery 6 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x29C0]]

      - name: "Battery 6 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x29C1]]

      - name: "Battery 6 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2804], [0x298D]]
          - operator: subtract
            registers: [[0x2805], [0x2990]]

      - name: "Battery 6 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2808, 0x2809], [0x29C7, 0x29C8]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 6 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x280A, 0x280B], [0x29C9, 0x29CA]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 6"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x27FD], [0x298B]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 6 Serial Number",
            "Battery 6 MOS Status",
            "Battery 6 Software Version",
            "Battery 6 Hardware Version",
            "Battery 6 BMS Software Version",
            "Battery 6 BMU Software Version",
            "Battery 6 BMS Hardware Version",
            "Battery 6 BMU Hardware Version",
          ]

  - group: Battery 7
    via_device: "inverter"
    update_interval: 5
    pack: 7
    items:
      - name: "Battery 7 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2814, 0x2815, 0x2816, 0x2817, 0x2818, 0x2819, 0x281A, 0x281B], [0x29EE, 0x29EF, 0x29F0, 0x29F1, 0x29F2, 0x29F3, 0x29F4, 0x29F5]]

      - name: "Battery 7 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x29F6]]

      - name: "Battery 7 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x29F7]]

      - name: "Battery 7 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x29F8]]

      # Always returning 0?
      - name: "Battery 7 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x29F9]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 7 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x29FA]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 7 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x29FB]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 7 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x282C], [0x29FC]]

      - name: "Battery 7 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x281C], [0x29FD]]

      - name: "Battery 7 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x281D], []]
        icon: "mdi:current-dc"

      - name: "Battery 7 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x29FE]]
        icon: "mdi:current-dc"

      - name: "Battery 7 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x281E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2A08]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x281F], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2A09]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A0A]]

      - name: "Battery 7 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A0B]]

      - name: "Battery 7 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2820], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2A0C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A0D]]

      - name: "Battery 7 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A0E]]

      - name: "Battery 7 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2821], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2822], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x29FF]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2823], [0x2A00]]
        icon: "mdi:battery"

      - name: "Battery 7 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2824], [0x2A01]]
        icon: "mdi:battery-heart"

      - name: "Battery 7 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2825], []]
        icon: "mdi:battery"

      - name: "Battery 7 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2826], []]
        icon: "mdi:battery"

      - name: "Battery 7 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2827], []]

      - name: "Battery 7 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x282A], [0x2A02]]

      - name: "Battery 7 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A03]]

      - name: "Battery 7 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A04]]

      - name: "Battery 7 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x282B], [0x2A05]]

      - name: "Battery 7 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A06]]

      - name: "Battery 7 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A07]]

      - name: "Battery 7 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2828], [0x2A0F]]
        icon: "mdi:current-dc"

      - name: "Battery 7 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2829], [0x2A10]]
        icon: "mdi:current-dc"

      - name: "Battery 7 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A11]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A12]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A13]]

      - name: "Battery 7 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A13]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 7 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A14]]

      - name: "Battery 7 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A15]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A16]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A17]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A18]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A19]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A1A]]
        icon: "mdi:battery-alert"

      - name: "Battery 7 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A1B]]

      - name: "Battery 7 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A1C]]

      - name: "Battery 7 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A1D]]

      - name: "Battery 7 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A1E]]

      - name: "Battery 7 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A1F]]

      - name: "Battery 7 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A20]]

      - name: "Battery 7 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A21]]

      - name: "Battery 7 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A22]]

      - name: "Battery 7 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A23]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A24]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A25]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A26]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A27]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A28]]

      - name: "Battery 7 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A29]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A2A]]

      - name: "Battery 7 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A2B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A2C]]

      - name: "Battery 7 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2A2D]]
        icon: "mdi:omega"

      - name: "Battery 7 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2A2E]]
        icon: "mdi:omega"

      - name: "Battery 7 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2A2F]]
        icon: "mdi:omega"

      - name: "Battery 7 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2A30]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 7 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x282D], []]

      - name: "Battery 7 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A3B]]

      - name: "Battery 7 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2832], []]

      - name: "Battery 7 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2833], []]

      - name: "Battery 7 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2A31, 0x2A32]]

      - name: "Battery 7 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2A33, 0x2A34]]

      - name: "Battery 7 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2A37, 0x2A38]]

      - name: "Battery 7 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2A39, 0x2A3A]]

      - name: "Battery 7 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2A35]]

      - name: "Battery 7 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2A36]]

      - name: "Battery 7 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x282A], [0x2A02]]
          - operator: subtract
            registers: [[0x282B], [0x2A05]]

      - name: "Battery 7 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x282E, 0x282F], [0x2A3C, 0x2A3D]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 7 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2830, 0x2831], [0x2A3E, 0x2A3F]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 7"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2823], [0x2A00]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 7 Serial Number",
            "Battery 7 MOS Status",
            "Battery 7 Software Version",
            "Battery 7 Hardware Version",
            "Battery 7 BMS Software Version",
            "Battery 7 BMU Software Version",
            "Battery 7 BMS Hardware Version",
            "Battery 7 BMU Hardware Version",
          ]

  - group: Battery 8
    via_device: "inverter"
    update_interval: 5
    pack: 8
    items:
      - name: "Battery 8 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x283A, 0x283B, 0x283C, 0x283D, 0x283E, 0x283F, 0x2840, 0x2841], [0x2A63, 0x2A64, 0x2A65, 0x2A66, 0x2A67, 0x2A68, 0x2A69, 0x2A6A]]

      - name: "Battery 8 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2A6B]]

      - name: "Battery 8 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2A6C]]

      - name: "Battery 8 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A6D]]

      # Always returning 0?
      - name: "Battery 8 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A6E]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 8 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2A6F]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 8 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2A70]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 8 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2852], [0x2A71]]

      - name: "Battery 8 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2842], [0x2A72]]

      - name: "Battery 8 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2843], []]
        icon: "mdi:current-dc"

      - name: "Battery 8 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2A73]]
        icon: "mdi:current-dc"

      - name: "Battery 8 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2844], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2A7D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2845], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2A7E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A7F]]

      - name: "Battery 8 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A80]]

      - name: "Battery 8 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2846], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2A81]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A82]]

      - name: "Battery 8 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A83]]

      - name: "Battery 8 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2847], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2848], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A74]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2849], [0x2A75]]
        icon: "mdi:battery"

      - name: "Battery 8 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x284A], [0x2A76]]
        icon: "mdi:battery-heart"

      - name: "Battery 8 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x284B], []]
        icon: "mdi:battery"

      - name: "Battery 8 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x284C], []]
        icon: "mdi:battery"

      - name: "Battery 8 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x284D], []]

      - name: "Battery 8 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2850], [0x2A77]]

      - name: "Battery 8 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A78]]

      - name: "Battery 8 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A79]]

      - name: "Battery 8 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2851], [0x2A7A]]

      - name: "Battery 8 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A7B]]

      - name: "Battery 8 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A7C]]

      - name: "Battery 8 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x284E], [0x2A84]]
        icon: "mdi:current-dc"

      - name: "Battery 8 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x284F], [0x2A85]]
        icon: "mdi:current-dc"

      - name: "Battery 8 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A86]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A87]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A88]]

      - name: "Battery 8 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2A88]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 8 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A89]]

      - name: "Battery 8 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8A]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8B]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8C]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8D]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8E]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A8F]]
        icon: "mdi:battery-alert"

      - name: "Battery 8 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A90]]

      - name: "Battery 8 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A91]]

      - name: "Battery 8 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A92]]

      - name: "Battery 8 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A93]]

      - name: "Battery 8 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A94]]

      - name: "Battery 8 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A95]]

      - name: "Battery 8 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A96]]

      - name: "Battery 8 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2A97]]

      - name: "Battery 8 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A98]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A99]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A9A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A9B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A9C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A9D]]

      - name: "Battery 8 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2A9E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2A9F]]

      - name: "Battery 8 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2AA0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AA1]]

      - name: "Battery 8 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2AA2]]
        icon: "mdi:omega"

      - name: "Battery 8 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2AA3]]
        icon: "mdi:omega"

      - name: "Battery 8 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2AA4]]
        icon: "mdi:omega"

      - name: "Battery 8 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2AA5]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 8 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2853], []]

      - name: "Battery 8 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2AB0]]

      - name: "Battery 8 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2858], []]

      - name: "Battery 8 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2859], []]

      - name: "Battery 8 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2AA6, 0x2AA7]]

      - name: "Battery 8 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2AA8, 0x2AA9]]

      - name: "Battery 8 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2AAC, 0x2AAD]]

      - name: "Battery 8 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2AAE, 0x2AAF]]

      - name: "Battery 8 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2AAA]]

      - name: "Battery 8 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2AAB]]

      - name: "Battery 8 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2850], [0x2A77]]
          - operator: subtract
            registers: [[0x2851], [0x2A7A]]

      - name: "Battery 8 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2854, 0x2855], [0x2AB1, 0x2AB2]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 8 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2856, 0x2857], [0x2AB3, 0x2AB4]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 8"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2849], [0x2A75]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 8 Serial Number",
            "Battery 8 MOS Status",
            "Battery 8 Software Version",
            "Battery 8 Hardware Version",
            "Battery 8 BMS Software Version",
            "Battery 8 BMU Software Version",
            "Battery 8 BMS Hardware Version",
            "Battery 8 BMU Hardware Version",
          ]

  - group: Battery 9
    via_device: "inverter"
    update_interval: 5
    pack: 9
    items:
      - name: "Battery 9 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2860, 0x2861, 0x2862, 0x2863, 0x2864, 0x2865, 0x2866, 0x2867], [0x2AD8, 0x2AD9, 0x2ADA, 0x2ADB, 0x2ADC, 0x2ADD, 0x2ADE, 0x2ADF]]

      - name: "Battery 9 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2AE0]]

      - name: "Battery 9 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2AE1]]

      - name: "Battery 9 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AE2]]

      # Always returning 0?
      - name: "Battery 9 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2AE3]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 9 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2AE4]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 9 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2AE5]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 9 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2878], [0x2AE6]]

      - name: "Battery 9 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2868], [0x2AE7]]

      - name: "Battery 9 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2869], []]
        icon: "mdi:current-dc"

      - name: "Battery 9 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2AE8]]
        icon: "mdi:current-dc"

      - name: "Battery 9 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x286A], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2AF2]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x286B], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2AF3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF4]]

      - name: "Battery 9 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF5]]

      - name: "Battery 9 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x286C], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2AF6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF7]]

      - name: "Battery 9 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF8]]

      - name: "Battery 9 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x286D], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x286E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2AE9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x286F], [0x2AEA]]
        icon: "mdi:battery"

      - name: "Battery 9 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2870], [0x2AEB]]
        icon: "mdi:battery-heart"

      - name: "Battery 9 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2871], []]
        icon: "mdi:battery"

      - name: "Battery 9 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2872], []]
        icon: "mdi:battery"

      - name: "Battery 9 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2873], []]

      - name: "Battery 9 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2876], [0x2AEC]]

      - name: "Battery 9 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AED]]

      - name: "Battery 9 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AEE]]

      - name: "Battery 9 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2877], [0x2AEF]]

      - name: "Battery 9 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF0]]

      - name: "Battery 9 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AF1]]

      - name: "Battery 9 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2874], [0x2AF9]]
        icon: "mdi:current-dc"

      - name: "Battery 9 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2875], [0x2AFA]]
        icon: "mdi:current-dc"

      - name: "Battery 9 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AFB]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AFC]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2AFD]]

      - name: "Battery 9 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2AFD]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 9 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AFE]]

      - name: "Battery 9 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2AFF]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B00]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B01]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B02]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B03]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B04]]
        icon: "mdi:battery-alert"

      - name: "Battery 9 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B05]]

      - name: "Battery 9 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B06]]

      - name: "Battery 9 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B07]]

      - name: "Battery 9 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B08]]

      - name: "Battery 9 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B09]]

      - name: "Battery 9 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B0A]]

      - name: "Battery 9 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B0B]]

      - name: "Battery 9 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B0C]]

      - name: "Battery 9 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B0D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B0E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B0F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B10]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B11]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B12]]

      - name: "Battery 9 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B13]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B14]]

      - name: "Battery 9 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B15]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B16]]

      - name: "Battery 9 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B17]]
        icon: "mdi:omega"

      - name: "Battery 9 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B18]]
        icon: "mdi:omega"

      - name: "Battery 9 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B19]]
        icon: "mdi:omega"

      - name: "Battery 9 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2B1A]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 9 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2879], []]

      - name: "Battery 9 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2B25]]

      - name: "Battery 9 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x287E], []]

      - name: "Battery 9 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x287F], []]

      - name: "Battery 9 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B1B, 0x2B1C]]

      - name: "Battery 9 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B1D, 0x2B1E]]

      - name: "Battery 9 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B21, 0x2B22]]

      - name: "Battery 9 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B23, 0x2B24]]

      - name: "Battery 9 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2B1F]]

      - name: "Battery 9 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2B20]]

      - name: "Battery 9 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2876], [0x2AEC]]
          - operator: subtract
            registers: [[0x2877], [0x2AEF]]

      - name: "Battery 9 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x287A, 0x287B], [0x2B26, 0x2B27]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 9 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x287C, 0x287D], [0x2B28, 0x2B29]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 9"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x286F], [0x2AEA]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 9 Serial Number",
            "Battery 9 MOS Status",
            "Battery 9 Software Version",
            "Battery 9 Hardware Version",
            "Battery 9 BMS Software Version",
            "Battery 9 BMU Software Version",
            "Battery 9 BMS Hardware Version",
            "Battery 9 BMU Hardware Version",
          ]

  - group: Battery 10
    via_device: "inverter"
    update_interval: 5
    pack: 10
    items:
      - name: "Battery 10 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2886, 0x2887, 0x2888, 0x2889, 0x288A, 0x288B, 0x288C, 0x288D], [0x2B4D, 0x2B4E, 0x2B4F, 0x2B50, 0x2B51, 0x2B52, 0x2B53, 0x2B54]]

      - name: "Battery 10 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2B55]]

      - name: "Battery 10 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2B56]]

      - name: "Battery 10 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B57]]

      # Always returning 0?
      - name: "Battery 10 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2B58]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 10 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2B59]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 10 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2B5A]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 10 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x289E], [0x2B5B]]

      - name: "Battery 10 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x288E], [0x2B5C]]

      - name: "Battery 10 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x288F], []]
        icon: "mdi:current-dc"

      - name: "Battery 10 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2B5D]]
        icon: "mdi:current-dc"

      - name: "Battery 10 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2890], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2B67]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2891], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2B68]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B69]]

      - name: "Battery 10 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B6A]]

      - name: "Battery 10 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2892], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2B6B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B6C]]

      - name: "Battery 10 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B6D]]

      - name: "Battery 10 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2893], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2894], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B5E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2895], [0x2B5F]]
        icon: "mdi:battery"

      - name: "Battery 10 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2896], [0x2B60]]
        icon: "mdi:battery-heart"

      - name: "Battery 10 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2897], []]
        icon: "mdi:battery"

      - name: "Battery 10 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2898], []]
        icon: "mdi:battery"

      - name: "Battery 10 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2899], []]

      - name: "Battery 10 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x289C], [0x2B61]]

      - name: "Battery 10 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B62]]

      - name: "Battery 10 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B63]]

      - name: "Battery 10 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x289D], [0x2B64]]

      - name: "Battery 10 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B65]]

      - name: "Battery 10 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B66]]

      - name: "Battery 10 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x289A], [0x2B6E]]
        icon: "mdi:current-dc"

      - name: "Battery 10 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x289B], [0x2B6F]]
        icon: "mdi:current-dc"

      - name: "Battery 10 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B70]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B71]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2B72]]

      - name: "Battery 10 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2B72]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 10 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B73]]

      - name: "Battery 10 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B74]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B75]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B76]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B77]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B78]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B79]]
        icon: "mdi:battery-alert"

      - name: "Battery 10 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B7A]]

      - name: "Battery 10 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B7B]]

      - name: "Battery 10 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B7C]]

      - name: "Battery 10 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B7D]]

      - name: "Battery 10 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B7E]]

      - name: "Battery 10 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B7F]]

      - name: "Battery 10 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B80]]

      - name: "Battery 10 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2B81]]

      - name: "Battery 10 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B82]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B83]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B84]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B85]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B86]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B87]]

      - name: "Battery 10 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B88]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B89]]

      - name: "Battery 10 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2B8A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2B8B]]

      - name: "Battery 10 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B8C]]
        icon: "mdi:omega"

      - name: "Battery 10 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B8D]]
        icon: "mdi:omega"

      - name: "Battery 10 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2B8E]]
        icon: "mdi:omega"

      - name: "Battery 10 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2B8F]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 10 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x289F], []]

      - name: "Battery 10 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2B9A]]

      - name: "Battery 10 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28A4], []]

      - name: "Battery 10 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28A5], []]

      - name: "Battery 10 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B90, 0x2B91]]

      - name: "Battery 10 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B92, 0x2B93]]

      - name: "Battery 10 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B96, 0x2B97]]

      - name: "Battery 10 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2B98, 0x2B99]]

      - name: "Battery 10 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2B94]]

      - name: "Battery 10 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2B95]]

      - name: "Battery 10 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x289C], [0x2B61]]
          - operator: subtract
            registers: [[0x289D], [0x2B64]]

      - name: "Battery 10 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28A0, 0x28A1], [0x2B9B, 0x2B9C]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 10 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28A2, 0x28A3], [0x2B9D, 0x2B9E]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 10"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2895], [0x2B5F]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 10 Serial Number",
            "Battery 10 MOS Status",
            "Battery 10 Software Version",
            "Battery 10 Hardware Version",
            "Battery 10 BMS Software Version",
            "Battery 10 BMU Software Version",
            "Battery 10 BMS Hardware Version",
            "Battery 10 BMU Hardware Version",
          ]

  - group: Battery 11
    via_device: "inverter"
    update_interval: 5
    pack: 11
    items:
      - name: "Battery 11 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x28AC, 0x28AD, 0x28AE, 0x28AF, 0x28B0, 0x28B1, 0x28B2, 0x28B3], [0x2BC2, 0x2BC3, 0x2BC4, 0x2BC5, 0x2BC6, 0x2BC7, 0x2BC8, 0x2BC9]]

      - name: "Battery 11 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2BCA]]

      - name: "Battery 11 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2BCB]]

      - name: "Battery 11 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BCC]]

      # Always returning 0?
      - name: "Battery 11 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2BCD]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 11 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2BCE]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 11 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2BCF]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 11 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x28C4], [0x2BD0]]

      - name: "Battery 11 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28B4], [0x2BD1]]

      - name: "Battery 11 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x28B5], []]
        icon: "mdi:current-dc"

      - name: "Battery 11 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2BD2]]
        icon: "mdi:current-dc"

      - name: "Battery 11 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x28B6], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2BDC]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x28B7], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2BDD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BDE]]

      - name: "Battery 11 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BDF]]

      - name: "Battery 11 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x28B8], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2BE0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE1]]

      - name: "Battery 11 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE2]]

      - name: "Battery 11 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x28B9], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x28BA], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BD3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28BB], [0x2BD4]]
        icon: "mdi:battery"

      - name: "Battery 11 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28BC], [0x2BD5]]
        icon: "mdi:battery-heart"

      - name: "Battery 11 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x28BD], []]
        icon: "mdi:battery"

      - name: "Battery 11 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x28BE], []]
        icon: "mdi:battery"

      - name: "Battery 11 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x28BF], []]

      - name: "Battery 11 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x28C2], [0x2BD6]]

      - name: "Battery 11 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BD7]]

      - name: "Battery 11 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BD8]]

      - name: "Battery 11 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x28C3], [0x2BD9]]

      - name: "Battery 11 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BDA]]

      - name: "Battery 11 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BDB]]

      - name: "Battery 11 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28C0], [0x2BE3]]
        icon: "mdi:current-dc"

      - name: "Battery 11 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28C1], [0x2BE4]]
        icon: "mdi:current-dc"

      - name: "Battery 11 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE5]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE6]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2BE7]]

      - name: "Battery 11 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2BE7]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 11 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE8]]

      - name: "Battery 11 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BE9]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BEA]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BEB]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BEC]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BED]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BEE]]
        icon: "mdi:battery-alert"

      - name: "Battery 11 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BEF]]

      - name: "Battery 11 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF0]]

      - name: "Battery 11 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF1]]

      - name: "Battery 11 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF2]]

      - name: "Battery 11 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2BF3]]

      - name: "Battery 11 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2BF4]]

      - name: "Battery 11 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2BF5]]

      - name: "Battery 11 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2BF6]]

      - name: "Battery 11 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF8]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BF9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BFA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BFB]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BFC]]

      - name: "Battery 11 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BFD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2BFE]]

      - name: "Battery 11 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2BFF]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C00]]

      - name: "Battery 11 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C01]]
        icon: "mdi:omega"

      - name: "Battery 11 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C02]]
        icon: "mdi:omega"

      - name: "Battery 11 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C03]]
        icon: "mdi:omega"

      - name: "Battery 11 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2C04]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 11 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x28C5], []]

      - name: "Battery 11 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2C0F]]

      - name: "Battery 11 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28CA], []]

      - name: "Battery 11 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28CB], []]

      - name: "Battery 11 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C05, 0x2C06]]

      - name: "Battery 11 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C07, 0x2C08]]

      - name: "Battery 11 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C0B, 0x2C0C]]

      - name: "Battery 11 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C0D, 0x2C0E]]

      - name: "Battery 11 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2C09]]

      - name: "Battery 11 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2C0A]]

      - name: "Battery 11 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x28C2], [0x2BD6]]
          - operator: subtract
            registers: [[0x28C3], [0x2BD9]]

      - name: "Battery 11 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28C6, 0x28C7], [0x2C10, 0x2C11]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 11 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28C8, 0x28C9], [0x2C12, 0x2C13]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 11"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28BB], [0x2BD4]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 11 Serial Number",
            "Battery 11 MOS Status",
            "Battery 11 Software Version",
            "Battery 11 Hardware Version",
            "Battery 11 BMS Software Version",
            "Battery 11 BMU Software Version",
            "Battery 11 BMS Hardware Version",
            "Battery 11 BMU Hardware Version",
          ]

  - group: Battery 12
    via_device: "inverter"
    update_interval: 5
    pack: 12
    items:
      - name: "Battery 12 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x28D2, 0x28D3, 0x28D4, 0x28D5, 0x28D6, 0x28D7, 0x28D8, 0x28D9], [0x2C37, 0x2C38, 0x2C39, 0x2C3A, 0x2C3B, 0x2C3C, 0x2C3D, 0x2C3E]]

      - name: "Battery 12 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2C3F]]

      - name: "Battery 12 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2C40]]

      - name: "Battery 12 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C41]]

      # Always returning 0?
      - name: "Battery 12 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2C42]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 12 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2C43]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 12 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2C44]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 12 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x28EA], [0x2C45]]

      - name: "Battery 12 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28DA], [0x2C46]]

      - name: "Battery 12 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x28DB], []]
        icon: "mdi:current-dc"

      - name: "Battery 12 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2C47]]
        icon: "mdi:current-dc"

      - name: "Battery 12 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x28DC], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2C51]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x28DD], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2C52]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C53]]

      - name: "Battery 12 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C54]]

      - name: "Battery 12 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x28DE], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2C55]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C56]]

      - name: "Battery 12 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C57]]

      - name: "Battery 12 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x28DF], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x28E0], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C48]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28E1], [0x2C49]]
        icon: "mdi:battery"

      - name: "Battery 12 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28E2], [0x2C4A]]
        icon: "mdi:battery-heart"

      - name: "Battery 12 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x28E3], []]
        icon: "mdi:battery"

      - name: "Battery 12 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x28E4], []]
        icon: "mdi:battery"

      - name: "Battery 12 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x28E5], []]

      - name: "Battery 12 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x28E8], [0x2C4B]]

      - name: "Battery 12 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C4C]]

      - name: "Battery 12 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C4D]]

      - name: "Battery 12 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x28E9], [0x2C4E]]

      - name: "Battery 12 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C4F]]

      - name: "Battery 12 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C50]]

      - name: "Battery 12 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28E6], [0x2C58]]
        icon: "mdi:current-dc"

      - name: "Battery 12 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x28E7], [0x2C59]]
        icon: "mdi:current-dc"

      - name: "Battery 12 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C5A]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C5B]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2C5C]]

      - name: "Battery 12 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2C5C]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 12 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C5D]]

      - name: "Battery 12 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C5E]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C5F]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C60]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C61]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C62]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C63]]
        icon: "mdi:battery-alert"

      - name: "Battery 12 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C64]]

      - name: "Battery 12 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C65]]

      - name: "Battery 12 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C66]]

      - name: "Battery 12 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C67]]

      - name: "Battery 12 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2C68]]

      - name: "Battery 12 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2C69]]

      - name: "Battery 12 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2C6A]]

      - name: "Battery 12 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2C6B]]

      - name: "Battery 12 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C6C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C6D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C6E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C6F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C70]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C71]]

      - name: "Battery 12 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C72]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C73]]

      - name: "Battery 12 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2C74]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2C75]]

      - name: "Battery 12 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C76]]
        icon: "mdi:omega"

      - name: "Battery 12 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C77]]
        icon: "mdi:omega"

      - name: "Battery 12 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2C78]]
        icon: "mdi:omega"

      - name: "Battery 12 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2C79]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 12 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x28EB], []]

      - name: "Battery 12 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2C84]]

      - name: "Battery 12 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28F0], []]

      - name: "Battery 12 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x28F1], []]

      - name: "Battery 12 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C7A, 0x2C7B]]

      - name: "Battery 12 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C7C, 0x2C7D]]

      - name: "Battery 12 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C80, 0x2C81]]

      - name: "Battery 12 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2C82, 0x2C83]]

      - name: "Battery 12 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2C7E]]

      - name: "Battery 12 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2C7F]]

      - name: "Battery 12 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x28E8], [0x2C4B]]
          - operator: subtract
            registers: [[0x28E9], [0x2C4E]]

      - name: "Battery 12 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28EC, 0x28ED], [0x2C85, 0x2C86]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 12 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x28EE, 0x28EF], [0x2C87, 0x2C88]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 12"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x28E1], [0x2C49]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 12 Serial Number",
            "Battery 12 MOS Status",
            "Battery 12 Software Version",
            "Battery 12 Hardware Version",
            "Battery 12 BMS Software Version",
            "Battery 12 BMU Software Version",
            "Battery 12 BMS Hardware Version",
            "Battery 12 BMU Hardware Version",
          ]

  - group: Battery 13
    via_device: "inverter"
    update_interval: 5
    pack: 13
    items:
      - name: "Battery 13 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x28F8, 0x28F9, 0x28FA, 0x28FB, 0x28FC, 0x28FD, 0x28FE, 0x28FF], [0x2CAC, 0x2CAD, 0x2CAE, 0x2CAF, 0x2CB0, 0x2CB1, 0x2CB2, 0x2CB3]]

      - name: "Battery 13 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2CB4]]

      - name: "Battery 13 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2CB5]]

      - name: "Battery 13 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CB6]]

      # Always returning 0?
      - name: "Battery 13 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2CB7]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 13 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2CB8]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 13 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2CB9]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 13 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2910], [0x2CBA]]

      - name: "Battery 13 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2900], [0x2CBB]]

      - name: "Battery 13 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2901], []]
        icon: "mdi:current-dc"

      - name: "Battery 13 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2CBC]]
        icon: "mdi:current-dc"

      - name: "Battery 13 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2902], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2CC6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2903], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2CC7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC8]]

      - name: "Battery 13 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC9]]

      - name: "Battery 13 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2904], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2CCA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CCB]]

      - name: "Battery 13 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CCC]]

      - name: "Battery 13 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2905], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2906], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CBD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2907], [0x2CBE]]
        icon: "mdi:battery"

      - name: "Battery 13 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2908], [0x2CBF]]
        icon: "mdi:battery-heart"

      - name: "Battery 13 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2909], []]
        icon: "mdi:battery"

      - name: "Battery 13 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x290A], []]
        icon: "mdi:battery"

      - name: "Battery 13 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x290B], []]

      - name: "Battery 13 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x290E], [0x2CC0]]

      - name: "Battery 13 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC1]]

      - name: "Battery 13 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC2]]

      - name: "Battery 13 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x290F], [0x2CC3]]

      - name: "Battery 13 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC4]]

      - name: "Battery 13 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CC5]]

      - name: "Battery 13 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x290C], [0x2CCD]]
        icon: "mdi:current-dc"

      - name: "Battery 13 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x290D], [0x2CCE]]
        icon: "mdi:current-dc"

      - name: "Battery 13 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CCF]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD0]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2CD1]]

      - name: "Battery 13 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2CD1]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 13 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD2]]

      - name: "Battery 13 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD3]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD4]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD5]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD6]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD7]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CD8]]
        icon: "mdi:battery-alert"

      - name: "Battery 13 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CD9]]

      - name: "Battery 13 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CDA]]

      - name: "Battery 13 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CDB]]

      - name: "Battery 13 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CDC]]

      - name: "Battery 13 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2CDD]]

      - name: "Battery 13 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2CDE]]

      - name: "Battery 13 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2CDF]]

      - name: "Battery 13 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2CE0]]

      - name: "Battery 13 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE1]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE2]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE4]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE5]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CE6]]

      - name: "Battery 13 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CE8]]

      - name: "Battery 13 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2CE9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 13 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2CEA]]

      - name: "Battery 13 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2CEB]]
        icon: "mdi:omega"

      - name: "Battery 13 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2CEC]]
        icon: "mdi:omega"

      - name: "Battery 13 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2CED]]
        icon: "mdi:omega"

      - name: "Battery 13 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2CEE]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 13 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2911], []]

      - name: "Battery 13 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2CF9]]

      - name: "Battery 13 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2916], []]

      - name: "Battery 13 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2917], []]

      - name: "Battery 13 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2CEF, 0x2CF0]]

      - name: "Battery 13 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2CF1, 0x2CF2]]

      - name: "Battery 13 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2CF5, 0x2CF6]]

      - name: "Battery 13 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2CF7, 0x2CF8]]

      - name: "Battery 13 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2CF3]]

      - name: "Battery 13 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2CF4]]

      - name: "Battery 13 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x290E], [0x2CC0]]
          - operator: subtract
            registers: [[0x290F], [0x2CC3]]

      - name: "Battery 13 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2912, 0x2913], [0x2CFA, 0x2CFB]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 13 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2914, 0x2915], [0x2CFC, 0x2CFD]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 13"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2907], [0x2CBE]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 13 Serial Number",
            "Battery 13 MOS Status",
            "Battery 13 Software Version",
            "Battery 13 Hardware Version",
            "Battery 13 BMS Software Version",
            "Battery 13 BMU Software Version",
            "Battery 13 BMS Hardware Version",
            "Battery 13 BMU Hardware Version",
          ]

  - group: Battery 14
    via_device: "inverter"
    update_interval: 5
    pack: 14
    items:
      - name: "Battery 14 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x291E, 0x291F, 0x2920, 0x2921, 0x2922, 0x2923, 0x2924, 0x2925], [0x2D21, 0x2D22, 0x2D23, 0x2D24, 0x2D25, 0x2D26, 0x2D27, 0x2D28]]

      - name: "Battery 14 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2D29]]

      - name: "Battery 14 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2D2A]]

      - name: "Battery 14 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D2B]]

      # Always returning 0?
      - name: "Battery 14 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2D2C]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 14 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2D2D]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 14 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2D2E]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 14 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2936], [0x2D2F]]

      - name: "Battery 14 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2926], [0x2D30]]

      - name: "Battery 14 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2927], []]
        icon: "mdi:current-dc"

      - name: "Battery 14 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2D31]]
        icon: "mdi:current-dc"

      - name: "Battery 14 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2928], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2D3B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2929], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2D3C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D3D]]

      - name: "Battery 14 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D3E]]

      - name: "Battery 14 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x292A], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2D3F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D40]]

      - name: "Battery 14 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D41]]

      - name: "Battery 14 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x292B], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x292C], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D32]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x292D], [0x2D33]]
        icon: "mdi:battery"

      - name: "Battery 14 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x292E], [0x2D34]]
        icon: "mdi:battery-heart"

      - name: "Battery 14 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x292F], []]
        icon: "mdi:battery"

      - name: "Battery 14 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2930], []]
        icon: "mdi:battery"

      - name: "Battery 14 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2931], []]

      - name: "Battery 14 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2934], [0x2D35]]

      - name: "Battery 14 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D36]]

      - name: "Battery 14 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D37]]

      - name: "Battery 14 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2935], [0x2D38]]

      - name: "Battery 14 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D39]]

      - name: "Battery 14 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D3A]]

      - name: "Battery 14 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2932], [0x2D42]]
        icon: "mdi:current-dc"

      - name: "Battery 14 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2933], [0x2D43]]
        icon: "mdi:current-dc"

      - name: "Battery 14 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D44]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D45]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2D46]]

      - name: "Battery 14 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2D46]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 14 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D47]]

      - name: "Battery 14 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D48]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D49]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D4A]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D4B]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D4C]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D4D]]
        icon: "mdi:battery-alert"

      - name: "Battery 14 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D4E]]

      - name: "Battery 14 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D4F]]

      - name: "Battery 14 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D50]]

      - name: "Battery 14 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D51]]

      - name: "Battery 14 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2D52]]

      - name: "Battery 14 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2D53]]

      - name: "Battery 14 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2D54]]

      - name: "Battery 14 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2D55]]

      - name: "Battery 14 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D56]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D57]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D58]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D59]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D5A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D5B]]

      - name: "Battery 14 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D5C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D5D]]

      - name: "Battery 14 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2D5E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 14 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2D5F]]

      - name: "Battery 14 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2D60]]
        icon: "mdi:omega"

      - name: "Battery 14 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2D61]]
        icon: "mdi:omega"

      - name: "Battery 14 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2D62]]
        icon: "mdi:omega"

      - name: "Battery 14 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2D63]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 14 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2937], []]

      - name: "Battery 14 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2D6E]]

      - name: "Battery 14 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x293C], []]

      - name: "Battery 14 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x293D], []]

      - name: "Battery 14 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2D64, 0x2D65]]

      - name: "Battery 14 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2D66, 0x2D67]]

      - name: "Battery 14 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2D6A, 0x2D6B]]

      - name: "Battery 14 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2D6C, 0x2D6D]]

      - name: "Battery 14 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2D68]]

      - name: "Battery 14 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2D69]]

      - name: "Battery 14 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2934], [0x2D35]]
          - operator: subtract
            registers: [[0x2935], [0x2D38]]

      - name: "Battery 14 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2938, 0x2939], [0x2D6F, 0x2D70]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 14 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x293A, 0x293B], [0x2D71, 0x2D72]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 14"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x292D], [0x2D33]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 14 Serial Number",
            "Battery 14 MOS Status",
            "Battery 14 Software Version",
            "Battery 14 Hardware Version",
            "Battery 14 BMS Software Version",
            "Battery 14 BMU Software Version",
            "Battery 14 BMS Hardware Version",
            "Battery 14 BMU Hardware Version",
          ]

  - group: Battery 15
    via_device: "inverter"
    update_interval: 5
    pack: 15
    items:
      - name: "Battery 15 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2944, 0x2945, 0x2946, 0x2947, 0x2948, 0x2949, 0x294A, 0x294B], [0x2D96, 0x2D97, 0x2D98, 0x2D99, 0x2D9A, 0x2D9B, 0x2D9C, 0x2D9D]]

      - name: "Battery 15 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2D9E]]

      - name: "Battery 15 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2D9F]]

      - name: "Battery 15 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DA0]]

      # Always returning 0?
      - name: "Battery 15 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2DA1]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 15 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2DA2]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 15 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2DA3]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 15 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x295C], [0x2DA4]]

      - name: "Battery 15 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x294C], [0x2DA5]]

      - name: "Battery 15 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x294D], []]
        icon: "mdi:current-dc"

      - name: "Battery 15 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2DA6]]
        icon: "mdi:current-dc"

      - name: "Battery 15 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x294E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2DB0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x294F], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2DB1]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DB2]]

      - name: "Battery 15 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DB3]]

      - name: "Battery 15 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2950], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2DB4]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DB5]]

      - name: "Battery 15 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DB6]]

      - name: "Battery 15 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2951], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2952], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DA7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2953], [0x2DA8]]
        icon: "mdi:battery"

      - name: "Battery 15 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2954], [0x2DA9]]
        icon: "mdi:battery-heart"

      - name: "Battery 15 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2955], []]
        icon: "mdi:battery"

      - name: "Battery 15 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2956], []]
        icon: "mdi:battery"

      - name: "Battery 15 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2957], []]

      - name: "Battery 15 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x295A], [0x2DAA]]

      - name: "Battery 15 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DAB]]

      - name: "Battery 15 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DAC]]

      - name: "Battery 15 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x295B], [0x2DAD]]

      - name: "Battery 15 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DAE]]

      - name: "Battery 15 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DAF]]

      - name: "Battery 15 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2958], [0x2DB7]]
        icon: "mdi:current-dc"

      - name: "Battery 15 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2959], [0x2DB8]]
        icon: "mdi:current-dc"

      - name: "Battery 15 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DB9]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DBA]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2DBB]]

      - name: "Battery 15 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2DBB]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 15 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DBC]]

      - name: "Battery 15 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DBD]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DBE]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DBF]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DC0]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DC1]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DC2]]
        icon: "mdi:battery-alert"

      - name: "Battery 15 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DC3]]

      - name: "Battery 15 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DC4]]

      - name: "Battery 15 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DC5]]

      - name: "Battery 15 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DC6]]

      - name: "Battery 15 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2DC7]]

      - name: "Battery 15 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2DC8]]

      - name: "Battery 15 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2DC9]]

      - name: "Battery 15 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2DCA]]

      - name: "Battery 15 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DCB]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DCC]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DCD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DCE]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DCF]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DD0]]

      - name: "Battery 15 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DD1]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DD2]]

      - name: "Battery 15 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2DD3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 15 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2DD4]]

      - name: "Battery 15 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2DD5]]
        icon: "mdi:omega"

      - name: "Battery 15 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2DD6]]
        icon: "mdi:omega"

      - name: "Battery 15 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2DD7]]
        icon: "mdi:omega"

      - name: "Battery 15 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2DD8]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 15 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x295D], []]

      - name: "Battery 15 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2DE3]]

      - name: "Battery 15 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2962], []]

      - name: "Battery 15 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2963], []]

      - name: "Battery 15 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2DD9, 0x2DDA]]

      - name: "Battery 15 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2DDB, 0x2DDC]]

      - name: "Battery 15 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2DDF, 0x2DE0]]

      - name: "Battery 15 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2DE1, 0x2DE2]]

      - name: "Battery 15 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2DDD]]

      - name: "Battery 15 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2DDE]]

      - name: "Battery 15 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x295A], [0x2DAA]]
          - operator: subtract
            registers: [[0x295B], [0x2DAD]]

      - name: "Battery 15 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x295E, 0x295F], [0x2DE4, 0x2DE5]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 15 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2960, 0x2961], [0x2DE6, 0x2DE7]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 15"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2953], [0x2DA8]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 15 Serial Number",
            "Battery 15 MOS Status",
            "Battery 15 Software Version",
            "Battery 15 Hardware Version",
            "Battery 15 BMS Software Version",
            "Battery 15 BMU Software Version",
            "Battery 15 BMS Hardware Version",
            "Battery 15 BMU Hardware Version",
          ]

  - group: Battery 16
    via_device: "inverter"
    update_interval: 5
    pack: 16
    items:
      - name: "Battery 16 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x296A, 0x296B, 0x296C, 0x296D, 0x296E, 0x296F, 0x2970, 0x2971], [0x2E0B, 0x2E0C, 0x2E0D, 0x2E0E, 0x2E0F, 0x2E10, 0x2E11, 0x2E12]]

      - name: "Battery 16 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2E13]]

      - name: "Battery 16 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2E14]]

      - name: "Battery 16 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E15]]

      # Always returning 0?
      - name: "Battery 16 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2E16]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 16 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2E17]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 16 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2E18]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 16 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2982], [0x2E19]]

      - name: "Battery 16 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2972], [0x2E1A]]

      - name: "Battery 16 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2973], []]
        icon: "mdi:current-dc"

      - name: "Battery 16 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2E1B]]
        icon: "mdi:current-dc"

      - name: "Battery 16 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2974], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2E25]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2975], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2E26]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E27]]

      - name: "Battery 16 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E28]]

      - name: "Battery 16 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2976], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2E29]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E2A]]

      - name: "Battery 16 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E2B]]

      - name: "Battery 16 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2977], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2978], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E1C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2979], [0x2E1D]]
        icon: "mdi:battery"

      - name: "Battery 16 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x297A], [0x2E1E]]
        icon: "mdi:battery-heart"

      - name: "Battery 16 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x297B], []]
        icon: "mdi:battery"

      - name: "Battery 16 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x297C], []]
        icon: "mdi:battery"

      - name: "Battery 16 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x297D], []]

      - name: "Battery 16 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2980], [0x2E1F]]

      - name: "Battery 16 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E20]]

      - name: "Battery 16 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E21]]

      - name: "Battery 16 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2981], [0x2E22]]

      - name: "Battery 16 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E23]]

      - name: "Battery 16 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E24]]

      - name: "Battery 16 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x297E], [0x2E2C]]
        icon: "mdi:current-dc"

      - name: "Battery 16 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x297F], [0x2E2D]]
        icon: "mdi:current-dc"

      - name: "Battery 16 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E2E]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E2F]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2E30]]

      - name: "Battery 16 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2E30]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 16 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E31]]

      - name: "Battery 16 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E32]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E33]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E34]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E35]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E36]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E37]]
        icon: "mdi:battery-alert"

      - name: "Battery 16 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E38]]

      - name: "Battery 16 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E39]]

      - name: "Battery 16 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E3A]]

      - name: "Battery 16 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E3B]]

      - name: "Battery 16 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2E3C]]

      - name: "Battery 16 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2E3D]]

      - name: "Battery 16 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2E3E]]

      - name: "Battery 16 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2E3F]]

      - name: "Battery 16 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E40]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E41]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E42]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E43]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E44]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E45]]

      - name: "Battery 16 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E46]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E47]]

      - name: "Battery 16 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E48]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 16 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E49]]

      - name: "Battery 16 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2E4A]]
        icon: "mdi:omega"

      - name: "Battery 16 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2E4B]]
        icon: "mdi:omega"

      - name: "Battery 16 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2E4C]]
        icon: "mdi:omega"

      - name: "Battery 16 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2E4D]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 16 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2983], []]

      - name: "Battery 16 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2E58]]

      - name: "Battery 16 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2988], []]

      - name: "Battery 16 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2989], []]

      - name: "Battery 16 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2E4E, 0x2E4F]]

      - name: "Battery 16 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2E50, 0x2E51]]

      - name: "Battery 16 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2E54, 0x2E55]]

      - name: "Battery 16 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2E56, 0x2E57]]

      - name: "Battery 16 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2E52]]

      - name: "Battery 16 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2E53]]

      - name: "Battery 16 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2980], [0x2E1F]]
          - operator: subtract
            registers: [[0x2981], [0x2E22]]

      - name: "Battery 16 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2984, 0x2985], [0x2E59, 0x2E5A]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 16 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2986, 0x2987], [0x2E5B, 0x2E5C]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 16"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2979], [0x2E1D]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 16 Serial Number",
            "Battery 16 MOS Status",
            "Battery 16 Software Version",
            "Battery 16 Hardware Version",
            "Battery 16 BMS Software Version",
            "Battery 16 BMU Software Version",
            "Battery 16 BMS Hardware Version",
            "Battery 16 BMU Hardware Version",
          ]

  - group: Battery 17
    via_device: "inverter"
    update_interval: 5
    pack: 17
    items:
      - name: "Battery 17 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2990, 0x2991, 0x2992, 0x2993, 0x2994, 0x2995, 0x2996, 0x2997], [0x2E80, 0x2E81, 0x2E82, 0x2E83, 0x2E84, 0x2E85, 0x2E86, 0x2E87]]

      - name: "Battery 17 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2E88]]

      - name: "Battery 17 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2E89]]

      - name: "Battery 17 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E8A]]

      # Always returning 0?
      - name: "Battery 17 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2E8B]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 17 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2E8C]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 17 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2E8D]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 17 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x29A8], [0x2E8E]]

      - name: "Battery 17 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2998], [0x2E8F]]

      - name: "Battery 17 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2999], []]
        icon: "mdi:current-dc"

      - name: "Battery 17 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2E90]]
        icon: "mdi:current-dc"

      - name: "Battery 17 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x299A], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2E9A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x299B], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2E9B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E9C]]

      - name: "Battery 17 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E9D]]

      - name: "Battery 17 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x299C], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2E9E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E9F]]

      - name: "Battery 17 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA0]]

      - name: "Battery 17 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x299D], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x299E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2E91]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x299F], [0x2E92]]
        icon: "mdi:battery"

      - name: "Battery 17 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29A0], [0x2E93]]
        icon: "mdi:battery-heart"

      - name: "Battery 17 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29A1], []]
        icon: "mdi:battery"

      - name: "Battery 17 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29A2], []]
        icon: "mdi:battery"

      - name: "Battery 17 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x29A3], []]

      - name: "Battery 17 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29A6], [0x2E94]]

      - name: "Battery 17 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E95]]

      - name: "Battery 17 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E96]]

      - name: "Battery 17 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29A7], [0x2E97]]

      - name: "Battery 17 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E98]]

      - name: "Battery 17 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2E99]]

      - name: "Battery 17 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29A4], [0x2EA1]]
        icon: "mdi:current-dc"

      - name: "Battery 17 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29A5], [0x2EA2]]
        icon: "mdi:current-dc"

      - name: "Battery 17 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA3]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA4]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2EA5]]

      - name: "Battery 17 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2EA5]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 17 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA6]]

      - name: "Battery 17 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA7]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA8]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EA9]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EAA]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EAB]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EAC]]
        icon: "mdi:battery-alert"

      - name: "Battery 17 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EAD]]

      - name: "Battery 17 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EAE]]

      - name: "Battery 17 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EAF]]

      - name: "Battery 17 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB0]]

      - name: "Battery 17 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2EB1]]

      - name: "Battery 17 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2EB2]]

      - name: "Battery 17 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2EB3]]

      - name: "Battery 17 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2EB4]]

      - name: "Battery 17 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB5]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB6]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB8]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EB9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EBA]]

      - name: "Battery 17 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EBB]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EBC]]

      - name: "Battery 17 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2EBD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 17 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EBE]]

      - name: "Battery 17 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2EBF]]
        icon: "mdi:omega"

      - name: "Battery 17 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2EC0]]
        icon: "mdi:omega"

      - name: "Battery 17 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2EC1]]
        icon: "mdi:omega"

      - name: "Battery 17 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2EC2]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 17 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x29A9], []]

      - name: "Battery 17 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2ECD]]

      - name: "Battery 17 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29AE], []]

      - name: "Battery 17 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29AF], []]

      - name: "Battery 17 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2EC3, 0x2EC4]]

      - name: "Battery 17 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2EC5, 0x2EC6]]

      - name: "Battery 17 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2EC9, 0x2ECA]]

      - name: "Battery 17 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2ECB, 0x2ECC]]

      - name: "Battery 17 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2EC7]]

      - name: "Battery 17 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2EC8]]

      - name: "Battery 17 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x29A6], [0x2E94]]
          - operator: subtract
            registers: [[0x29A7], [0x2E97]]

      - name: "Battery 17 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29AA, 0x29AB], [0x2ECE, 0x2ECF]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 17 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29AC, 0x29AD], [0x2ED0, 0x2ED1]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 17"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x299F], [0x2E92]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 17 Serial Number",
            "Battery 17 MOS Status",
            "Battery 17 Software Version",
            "Battery 17 Hardware Version",
            "Battery 17 BMS Software Version",
            "Battery 17 BMU Software Version",
            "Battery 17 BMS Hardware Version",
            "Battery 17 BMU Hardware Version",
          ]

  - group: Battery 18
    via_device: "inverter"
    update_interval: 5
    pack: 18
    items:
      - name: "Battery 18 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x29B6, 0x29B7, 0x29B8, 0x29B9, 0x29BA, 0x29BB, 0x29BC, 0x29BD], [0x2EF5, 0x2EF6, 0x2EF7, 0x2EF8, 0x2EF9, 0x2EFA, 0x2EFB, 0x2EFC]]

      - name: "Battery 18 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2EFD]]

      - name: "Battery 18 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2EFE]]

      - name: "Battery 18 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2EFF]]

      # Always returning 0?
      - name: "Battery 18 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F00]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 18 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2F01]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 18 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2F02]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 18 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x29CE], [0x2F03]]

      - name: "Battery 18 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29BE], [0x2F04]]

      - name: "Battery 18 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x29BF], []]
        icon: "mdi:current-dc"

      - name: "Battery 18 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2F05]]
        icon: "mdi:current-dc"

      - name: "Battery 18 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x29C0], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2F0F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x29C1], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2F10]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F11]]

      - name: "Battery 18 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F12]]

      - name: "Battery 18 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x29C2], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2F13]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F14]]

      - name: "Battery 18 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F15]]

      - name: "Battery 18 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x29C3], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x29C4], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F06]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29C5], [0x2F07]]
        icon: "mdi:battery"

      - name: "Battery 18 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29C6], [0x2F08]]
        icon: "mdi:battery-heart"

      - name: "Battery 18 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29C7], []]
        icon: "mdi:battery"

      - name: "Battery 18 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29C8], []]
        icon: "mdi:battery"

      - name: "Battery 18 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x29C9], []]

      - name: "Battery 18 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29CC], [0x2F09]]

      - name: "Battery 18 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F0A]]

      - name: "Battery 18 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F0B]]

      - name: "Battery 18 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29CD], [0x2F0C]]

      - name: "Battery 18 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F0D]]

      - name: "Battery 18 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F0E]]

      - name: "Battery 18 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29CA], [0x2F16]]
        icon: "mdi:current-dc"

      - name: "Battery 18 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29CB], [0x2F17]]
        icon: "mdi:current-dc"

      - name: "Battery 18 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F18]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F19]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F1A]]

      - name: "Battery 18 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F1A]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 18 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F1B]]

      - name: "Battery 18 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F1C]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F1D]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F1E]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F1F]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F20]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F21]]
        icon: "mdi:battery-alert"

      - name: "Battery 18 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F22]]

      - name: "Battery 18 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F23]]

      - name: "Battery 18 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F24]]

      - name: "Battery 18 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F25]]

      - name: "Battery 18 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F26]]

      - name: "Battery 18 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F27]]

      - name: "Battery 18 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F28]]

      - name: "Battery 18 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F29]]

      - name: "Battery 18 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F2A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F2B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F2C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F2D]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F2E]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F2F]]

      - name: "Battery 18 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F30]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F31]]

      - name: "Battery 18 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F32]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 18 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F33]]

      - name: "Battery 18 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2F34]]
        icon: "mdi:omega"

      - name: "Battery 18 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2F35]]
        icon: "mdi:omega"

      - name: "Battery 18 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2F36]]
        icon: "mdi:omega"

      - name: "Battery 18 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2F37]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 18 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x29CF], []]

      - name: "Battery 18 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F42]]

      - name: "Battery 18 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29D4], []]

      - name: "Battery 18 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29D5], []]

      - name: "Battery 18 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2F38, 0x2F39]]

      - name: "Battery 18 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2F3A, 0x2F3B]]

      - name: "Battery 18 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2F3E, 0x2F3F]]

      - name: "Battery 18 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2F40, 0x2F41]]

      - name: "Battery 18 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2F3C]]

      - name: "Battery 18 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2F3D]]

      - name: "Battery 18 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x29CC], [0x2F09]]
          - operator: subtract
            registers: [[0x29CD], [0x2F0C]]

      - name: "Battery 18 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29D0, 0x29D1], [0x2F43, 0x2F44]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 18 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29D2, 0x29D3], [0x2F45, 0x2F46]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 18"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29C5], [0x2F07]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 18 Serial Number",
            "Battery 18 MOS Status",
            "Battery 18 Software Version",
            "Battery 18 Hardware Version",
            "Battery 18 BMS Software Version",
            "Battery 18 BMU Software Version",
            "Battery 18 BMS Hardware Version",
            "Battery 18 BMU Hardware Version",
          ]

  - group: Battery 19
    via_device: "inverter"
    update_interval: 5
    pack: 19
    items:
      - name: "Battery 19 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x29DC, 0x29DD, 0x29DE, 0x29DF, 0x29E0, 0x29E1, 0x29E2, 0x29E3], [0x2F6A, 0x2F6B, 0x2F6C, 0x2F6D, 0x2F6E, 0x2F6F, 0x2F70, 0x2F71]]

      - name: "Battery 19 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2F72]]

      - name: "Battery 19 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2F73]]

      - name: "Battery 19 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F74]]

      # Always returning 0?
      - name: "Battery 19 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F75]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 19 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2F76]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 19 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2F77]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 19 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x29F4], [0x2F78]]

      - name: "Battery 19 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29E4], [0x2F79]]

      - name: "Battery 19 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x29E5], []]
        icon: "mdi:current-dc"

      - name: "Battery 19 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2F7A]]
        icon: "mdi:current-dc"

      - name: "Battery 19 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x29E6], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2F84]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x29E7], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2F85]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F86]]

      - name: "Battery 19 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F87]]

      - name: "Battery 19 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x29E8], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2F88]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F89]]

      - name: "Battery 19 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F8A]]

      - name: "Battery 19 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x29E9], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x29EA], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F7B]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29EB], [0x2F7C]]
        icon: "mdi:battery"

      - name: "Battery 19 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29EC], [0x2F7D]]
        icon: "mdi:battery-heart"

      - name: "Battery 19 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29ED], []]
        icon: "mdi:battery"

      - name: "Battery 19 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x29EE], []]
        icon: "mdi:battery"

      - name: "Battery 19 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x29EF], []]

      - name: "Battery 19 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29F2], [0x2F7E]]

      - name: "Battery 19 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F7F]]

      - name: "Battery 19 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F80]]

      - name: "Battery 19 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x29F3], [0x2F81]]

      - name: "Battery 19 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F82]]

      - name: "Battery 19 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F83]]

      - name: "Battery 19 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29F0], [0x2F8B]]
        icon: "mdi:current-dc"

      - name: "Battery 19 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x29F1], [0x2F8C]]
        icon: "mdi:current-dc"

      - name: "Battery 19 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F8D]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F8E]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F8F]]

      - name: "Battery 19 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2F8F]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 19 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F90]]

      - name: "Battery 19 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F91]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F92]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F93]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F94]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F95]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2F96]]
        icon: "mdi:battery-alert"

      - name: "Battery 19 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F97]]

      - name: "Battery 19 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F98]]

      - name: "Battery 19 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F99]]

      - name: "Battery 19 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F9A]]

      - name: "Battery 19 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F9B]]

      - name: "Battery 19 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F9C]]

      - name: "Battery 19 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F9D]]

      - name: "Battery 19 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x2F9E]]

      - name: "Battery 19 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2F9F]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA1]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA2]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA3]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FA4]]

      - name: "Battery 19 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA5]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FA6]]

      - name: "Battery 19 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FA7]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 19 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FA8]]

      - name: "Battery 19 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2FA9]]
        icon: "mdi:omega"

      - name: "Battery 19 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2FAA]]
        icon: "mdi:omega"

      - name: "Battery 19 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x2FAB]]
        icon: "mdi:omega"

      - name: "Battery 19 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x2FAC]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 19 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x29F5], []]

      - name: "Battery 19 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2FB7]]

      - name: "Battery 19 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29FA], []]

      - name: "Battery 19 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x29FB], []]

      - name: "Battery 19 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2FAD, 0x2FAE]]

      - name: "Battery 19 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2FAF, 0x2FB0]]

      - name: "Battery 19 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2FB3, 0x2FB4]]

      - name: "Battery 19 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x2FB5, 0x2FB6]]

      - name: "Battery 19 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x2FB1]]

      - name: "Battery 19 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x2FB2]]

      - name: "Battery 19 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x29F2], [0x2F7E]]
          - operator: subtract
            registers: [[0x29F3], [0x2F81]]

      - name: "Battery 19 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29F6, 0x29F7], [0x2FB8, 0x2FB9]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 19 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x29F8, 0x29F9], [0x2FBA, 0x2FBB]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 19"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x29EB], [0x2F7C]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 19 Serial Number",
            "Battery 19 MOS Status",
            "Battery 19 Software Version",
            "Battery 19 Hardware Version",
            "Battery 19 BMS Software Version",
            "Battery 19 BMU Software Version",
            "Battery 19 BMS Hardware Version",
            "Battery 19 BMU Hardware Version",
          ]

  - group: Battery 20
    via_device: "inverter"
    update_interval: 5
    pack: 20
    items:
      - name: "Battery 20 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 11
        registers:
          [[0x2A02, 0x2A03, 0x2A04, 0x2A05, 0x2A06, 0x2A07, 0x2A08, 0x2A09], [0x2FDF, 0x2FE0, 0x2FE1, 0x2FE2, 0x2FE3, 0x2FE4, 0x2FE5, 0x2FE6]]

      - name: "Battery 20 Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "Low voltage"
          - key: 2
            value: "High voltage"
        registers: [[], [0x2FE7]]

      - name: "Battery 20 Protocol"
        update_interval: 3600
        class: "enum"
        rule: 1
        lookup:
          - key: 0
            value: "Sol-ark"
          - key: 1
            value: "PYLON"
          - key: 2
            value: "Growatt"
          - key: 3
            value: "Fortress"
          - key: 4
            value: "Schneider"
          - key: 5
            value: "SMA"
          - key: 6
            value: "Victron CAN"
          - key: 7
            value: "Sofar"
        registers: [[], [0x2FE8]]

      - name: "Battery 20 Number of Clusters"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FE9]]

      # Always returning 0?
      - name: "Battery 20 Basic Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x2FEA]]
        lookup:
          - key: 0
            value: "Static"
          - key: 1
            value: "Charging"
          - key: 2
            value: "Discharging"

      - name: "Battery 20 Charging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2FEB]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 20 Discharging Allowed"
        class: "enum"
        rule: 1
        icon: "mdi:battery-check"
        registers: [[], [0x2FEC]]
        lookup:
          - key: 0
            value: "Disallowed"
          - key: 1
            value: "Allowed"

      - name: "Battery 20 Cycle Count"
        state_class: "measurement"
        rule: 1
        icon: "mdi:battery-sync"
        registers: [[0x2A1A], [0x2FED]]

      - name: "Battery 20 Module Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2A0A], [0x2FEE]]

      - name: "Battery 20 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [[0x2A0B], []]
        icon: "mdi:current-dc"

      - name: "Battery 20 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        offset: 30000
        suggested_display_precision: 1
        rule: 2
        registers: [[], [0x2FEF]]
        icon: "mdi:current-dc"

      - name: "Battery 20 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2A0C], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Average Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2FF9]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        offset: 1000
        rule: 1
        registers: [[0x2A0D], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        rule: 1
        registers: [[], [0x2FFA]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FFB]]

      - name: "Battery 20 Max Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FFC]]

      - name: "Battery 20 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 0.1
        scale: 1
        offset: 1000
        registers: [[0x2A0E], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        rule: 1
        scale: 1
        offset: 40
        registers: [[], [0x2FFD]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Min Cell Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FFE]]

      - name: "Battery 20 Min Cell Temperature Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FFF]]

      - name: "Battery 20 MOS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2A0F], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Mem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [[0x2A10], []]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 BMS Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x2FF0]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 State of Charge"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2A11], [0x2FF1]]
        icon: "mdi:battery"

      - name: "Battery 20 Health"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2A12], [0x2FF2]]
        icon: "mdi:battery-heart"

      - name: "Battery 20 Remaining Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2A13], []]
        icon: "mdi:battery"

      - name: "Battery 20 Total Capacity"
        update_interval: 300
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [[0x2A14], []]
        icon: "mdi:battery"

      - name: "Battery 20 Charge Voltage"
        update_interval: 3600
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [[0x2A15], []]

      - name: "Battery 20 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2A18], [0x2FF3]]

      - name: "Battery 20 Max Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FF4]]

      - name: "Battery 20 Max Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FF5]]

      - name: "Battery 20 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        suggested_display_precision: 3
        scale: 0.001
        rule: 1
        registers: [[0x2A19], [0x2FF6]]

      - name: "Battery 20 Min Cell Voltage BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FF7]]

      - name: "Battery 20 Min Cell Voltage Cell Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x2FF8]]

      - name: "Battery 20 Max Charge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2A16], [0x3000]]
        icon: "mdi:current-dc"

      - name: "Battery 20 Max Discharge Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[0x2A17], [0x3001]]
        icon: "mdi:current-dc"

      - name: "Battery 20 Charge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3002]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 Discharge Relay On-Load Cut-Off Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3003]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 System Sub State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x3004]]

      - name: "Battery 20 Status"
        class: "enum"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x3004]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 3
            value: "Idle"
          - key: 9
            value: "Discharging"
          - key: 15
            value: "Charging"

      - name: "Battery 20 Pack count"
        update_interval: 3600
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3005]]

      - name: "Battery 20 Overcharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3006]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 Over-discharge Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3007]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 OCC Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3008]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 OCD Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3009]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 Overcharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x300A]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 Over-discharge T Times"
        update_interval: 300
        state_class: "measurement"
        rule: 1
        registers: [[], [0x300B]]
        icon: "mdi:battery-alert"

      - name: "Battery 20 Total Charge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x300C]]

      - name: "Battery 20 Total Charge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x300D]]

      - name: "Battery 20 Total Discharge H Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x300E]]

      - name: "Battery 20 Total Discharge L Energy"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 1
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x300F]]

      - name: "Battery 20 Mot Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x3010]]

      - name: "Battery 20 Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x3011]]

      - name: "Battery 20 Fuse Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x3012]]

      - name: "Battery 20 Heat Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        suggested_display_precision: 1
        rule: 1
        registers: [[], [0x3013]]

      - name: "Battery 20 Pre Charge Res Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x3014]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max Heater Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x3015]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 BMS P Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x3016]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 BMS N Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x3017]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max BMU Connector P Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x3018]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max BMU Connector P Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x3019]]

      - name: "Battery 20 Max BMU Connector N Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x301A]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Max BMU Connector N Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x301B]]

      - name: "Battery 20 Min BMU Connector Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "°C"
        scale: 1
        offset: 40
        suggested_display_precision: 0
        rule: 1
        registers: [[], [0x301C]]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 20 Min BMU Connector Temperature BMU Number"
        state_class: "measurement"
        rule: 1
        registers: [[], [0x301D]]

      - name: "Battery 20 Leakage Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x301E]]
        icon: "mdi:omega"

      - name: "Battery 20 P Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x301F]]
        icon: "mdi:omega"

      - name: "Battery 20 N Resistance"
        update_interval: 3600
        state_class: "measurement"
        uom: "kΩ"
        rule: 1
        registers: [[], [0x3020]]
        icon: "mdi:omega"

      - name: "Battery 20 BMS Type"
        update_interval: 3600
        class: "enum"
        rule: 1
        registers: [[], [0x3021]]
        lookup:
          - key: 0
            value: "Unknown"
          - key: 1
            value: "LVESS"
          - key: 2
            value: "HVCU"
          - key: 3
            value: "HVMU"
          - key: 4
            value: "LvCtrlBox"

      - name: "Battery 20 MOS Status"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [[0x2A1B], []]

      - name: "Battery 20 Relay State"
        state_class: "measurement"
        rule: 1
        icon: "mdi:state-machine"
        registers: [[], [0x302C]]

      - name: "Battery 20 Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2A20], []]

      - name: "Battery 20 Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[0x2A21], []]

      - name: "Battery 20 BMS Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x3022, 0x3023]]

      - name: "Battery 20 BMU Software Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x3024, 0x3025]]

      - name: "Battery 20 BMS Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x3028, 0x3029]]

      - name: "Battery 20 BMU Hardware Version"
        update_interval: 3600
        attribute:
        rule: 7
        delimiter: ""
        registers: [[], [0x302A, 0x302B]]

      - name: "Battery 20 Temp Sampling Count"
        attribute:
        rule: 1
        registers: [[], [0x3026]]

      - name: "Battery 20 Is Heat"
        attribute:
        rule: 1
        registers: [[], [0x3027]]

      - name: "Battery 20 Imbalance"
        class: "voltage"
        state_class: "measurement"
        uom: "mV"
        scale: 1
        rule: 1
        sensors:
          - registers: [[0x2A18], [0x2FF3]]
          - operator: subtract
            registers: [[0x2A19], [0x2FF6]]

      - name: "Battery 20 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2A1C, 0x2A1D], [0x302D, 0x302E]]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 20 Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [[0x2A1E, 0x2A1F], [0x302F, 0x3030]]
        icon: "mdi:battery-alert-variant"
        attributes: ["value"]

      - name: "Battery 20"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [[0x2A11], [0x2FF1]]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 20 Serial Number",
            "Battery 20 MOS Status",
            "Battery 20 Software Version",
            "Battery 20 Hardware Version",
            "Battery 20 BMS Software Version",
            "Battery 20 BMU Software Version",
            "Battery 20 BMS Hardware Version",
            "Battery 20 BMU Hardware Version",
          ]
