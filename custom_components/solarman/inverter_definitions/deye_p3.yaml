#
# SUN-5/6/8/10/12K-SG04LP3 and SUN-5/6/8/10/12/15/20/25K-SG01HP3-EU-AM2 | 5-12kW and 5-25kW | Three Phase | 2 MPPT | Hybrid Inverter | LV and HV Battery Supported
#
# Reference: https://github.com/user-attachments/files/16798469/MODBUS.RTU.V105.1-20231006.pdf and https://github.com/user-attachments/files/16597916/MODBUSRTU.V104.3.1.1111_SG01-HP3-AM2.pdf
#
# Registers
# The 0-59 register address is a readable register type, 0x03 function code.
# The 60-499 register address is a read-write register type 0x10 function code.
# The 500-2000 register address is a readable register type 0x03 function code.
#
# Tested with 25K-SG01HP3 12K-SG04LP3 and LSW3_15_FFFF_1.0.91R Stick Logger
#

info:
  manufacturer: Deye
  model: [SG04LP3, SG01HP3]

default:
  update_interval: 60
  digits: 6

parameters:
  - group: Info
    update_interval: 3600
    items:
      - name: "Device"
        class: "enum"
        rule: 1
        registers: [0x0000]
        icon: "mdi:information"
        lookup:
          - key: 0x0000
            value: "Unknown"
          - key: [0x0002, 0x0200]
            value: "String Inverter"
          - key: [0x0003, 0x0300]
            value: "Single-Phase Hybrid Inverter"
          - key: [0x0004, 0x0400]
            value: "Microinverter"
          - key: [0x0005, 0x0500]
            value: "LV 3-Phase Hybrid Inverter"
          - key: 0x0006
            value: "HV 3-Phase Hybrid Inverter"
          - key: [0x0007, 0x0600]
            value: "HV 3-Phase Inverter 6-15kw"
          - key: [0x0008, 0x0601]
            value: "HV 3-Phase Inverter 20-50kw"
        attributes:
          [
            "Device Modbus Address",
            "Device Protocol Version",
            "Device Serial Number",
            "Device Control Board Firmware Version",
            "Device Communication Board Firmware Version",
            "Device MCU Board Version",
            "Device MCU Version",
            "Device AFCI Version",
            "Device Rated Power",
            "Device MPPTs",
            "Device Phases",
          ]

      - name: "Device Modbus Address"
        attribute:
        rule: 1
        registers: [0x0001]

      - name: "Device Protocol Version"
        attribute:
        rule: 7
        remove: "0."
        registers: [0x0002]

      - name: "Device Serial Number"
        attribute:
        rule: 5
        registers: [0x0003, 0x0004, 0x0005, 0x0006, 0x0007]

      - name: "Device MCU Board Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000A]

      - name: "Device AFCI Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000C]

      - name: "Device MCU Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000D]

      - name: "Device Control Board Firmware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x000E, 0x000F, 0x000B]

      - name: "Device Communication Board Firmware Version"
        attribute:
        rule: 7
        hex:
        delimiter: ""
        registers: [0x0011, 0x0012, 0x0010]

      - name: "Device Rated Power"
        attribute:
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: 0.1
        rule: 4
        registers: [0x0014, 0x0015]
        validation:
          min: 0
          max: [24000, 50000]

      - name: "Device MPPTs"
        attribute:
        rule: 1
        mask: 0x0F00
        divide: 256
        registers: [0x0016]
        range:
          min: 257
        validation:
          max: 12
          default: 2

      - name: "Device Phases"
        attribute:
        rule: 1
        mask: 0x000F
        registers: [0x0016]
        range:
          min: 257
        validation:
          max: 3
          default: 3

      - name: Device Self-check
        attribute:
        class: "enum"
        rule: 1
        registers: [0x0024]
        range:
          min: 0
          max: 1
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Enabled"

  - group: Control
    update_interval: 300
    items:
      - name: "Self-check time"
        platform: number
        uom: "s"
        rule: 1
        registers: [0x003D]
        range:
          min: 0
          max: 1000

      - name: "Date & Time"
        platform: datetime
        update_interval: 60
        rule: 8
        registers: [0x003E, 0x003F, 0x0040]

      - name: "" # On/Off Switch (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
        platform: switch
        rule: 1
        registers: [0x0050]

  - group: Settings
    update_interval: 300
    items:
      - name: "Battery Control Mode"
        platform: "select"
        rule: 1
        registers: [0x0062]
        icon: "mdi:battery"
        lookup:
          - key: 0x0000
            value: "Lead-Battery, four-stage charging method"
          - key: 0x0001
            value: "Lithium"

      - name: "Battery Equalization"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0063]
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Absorption"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0064]
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Float"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0065]
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        icon: "mdi:battery"
        range:
          min: 3800
          max: 6100

      - name: "Battery Capacity"
        platform: number
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x0066]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 2000

      - name: "Battery Empty"
        platform: number
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0067]
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        icon: "mdi:battery"

      - name: "Zero Export power"
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        registers: [0x0068]
        range:
          min: 0
          max: 500
        icon: "mdi:transmission-tower-import"

      - name: "Battery Equalization Cycle"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "d"
        rule: 1
        registers: [0x0069]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 90

      - name: "Battery Equalization Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.5
        rule: 1
        registers: [0x006A]
        configurable:
          min: 0
          max: 10
          mode: box
        icon: "mdi:battery"
        range:
          min: 0
          max: 20

      - name: "Battery Temperature Compensation"
        platform: number
        state_class: "measurement"
        uom: "mV/*C"
        rule: 2
        registers: [0x006B]
        configurable:
          min: 0
          max: 50
          step: 0.1
        icon: "mdi:battery"
        range:
          min: 0
          max: 50

      - name: "Battery Max Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x006C]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 240

      - name: "Battery Max Discharging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x006D]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 240

      - name: "Battery Operation Mode"
        platform: "select"
        rule: 1
        registers: [0x006F]
        icon: mdi:battery
        lookup:
          - key: 0x0000
            value: Voltage
          - key: 0x0001
            value: Capacity
          - key: 0x0002
            value: No Battery

      - name: "Battery Wake Up"
        platform: "switch"
        rule: 1
        registers: [0x0081]
        value:
          on: 0x101
          off: 0x00

      - name: Battery Resistance
        platform: number
        state_class: measurement
        uom: "mÎ©"
        rule: 1
        registers: [0x0071]
        icon: mdi:battery
        range:
          min: 0
          max: 6000

      - name: Battery Charging efficiency
        platform: number
        state_class: measurement
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x0072]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 1000
        validation:
          min: 0
          max: 100

      - name: Battery Shutdown SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0073]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Restart SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0074]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Low SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x0075]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: Battery Shutdown Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0076]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        range:
          min: 3800
          max: 6100

      - name: Battery Restart Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0077]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        range:
          min: 3800
          max: 6100

      - name: Battery Low Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0078]
        icon: mdi:battery
        configurable:
          min: 38
          max: 61
          step: 0.1
          mode: box
        range:
          min: 3800
          max: 6100

      - name: "Generator Operating Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.1
        rule: 1
        registers: [0x0079]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 24
          mode: box
        range:
          min: 0
          max: 240

      - name: "Generator Cooling Time"
        platform: number
        class: "duration"
        state_class: "measurement"
        uom: "h"
        scale: 0.1
        rule: 1
        registers: [0x007A]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 24
          mode: box
        range:
          min: 0
          max: 240

      - name: Battery Generator Charging Start Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x007B]
        icon: mdi:battery
        configurable:
          min: 00
          max: 63
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6300

      - name: Battery Generator Charging Start
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x007C]
        icon: mdi:battery
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "Battery Generator Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x007D]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 240

      - name: "Battery Grid Charging Start Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x007E]
        icon: "mdi:battery"
        configurable:
          min: 00
          max: 63
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6300

      - name: "Battery Grid Charging Start"
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x007F]
        icon: "mdi:battery"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "Battery Grid Charging Current"
        platform: number
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x0080]
        icon: "mdi:current-dc"
        configurable:
          mode: box
        range:
          min: 0
          max: 240

      - name: "Battery Generator Charging"
        platform: "switch"
        rule: 1
        registers: [0x0081]
        icon: "mdi:battery"

      - name: "Battery Grid Charging"
        platform: "switch"
        rule: 1
        registers: [0x0082]
        icon: "mdi:battery"

      - name: "Generator"
        name_lookup: "io_mode_select"
        platform: "switch"
        rule: 1
        registers: [0x0084]

      - name: "IO Mode"
        alt: Generator input mode
        description: The Generator/SmartLoad/Microinverter input-output mode
        platform: "select"
        rule: 1
        registers: [0x0085]
        icon: "mdi:lightning-bolt-circle"
        lookup:
          - key: 0x0000
            value: "Generator"
          - key: 0x0001
            value: "SmartLoad"
          - key: 0x0002
            value: "Microinverter"

      - name: "SmartLoad Off Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0086]
        icon: "mdi:battery"
        configurable:
          min: 38
          max: 63
          step: 0.1
          mode: box
        range:
          min: 3800
          max: 6300

      - name: "SmartLoad Off"
        platform: number
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x0087]
        icon: "mdi:lightning-bolt-circle"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

      - name: "SmartLoad On Voltage"
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x0088]
        icon: "mdi:battery"
        configurable:
          min: 38
          max: 63
          step: 0.1
          mode: box
        range:
          min: 3800
          max: 6300

      - name: "SmartLoad On"
        platform: number
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x0089]
        icon: "mdi:lightning-bolt-circle"
        configurable:
          mode: box
        range:
          min: 0
          max: 100

  - group: Grid Parameters
    update_interval: 300
    items:
      - name: Grid Voltage
        platform: "select"
        registers: [0x008A]
        rule: 1
        lookup:
          - key: 0x0
            value: LN:220VAC LL:380VAC
          - key: 0x1
            value: LN:230VAC LL:398VAC
          - key: 0x2
            value: LN:240VAC LL:415VAC
          - key: 0x3
            value: LN:120VAC LL:208VAC
          - key: 0x4
            value: LN:133VAC LL:220VAC
          - key: 0x5
            value: LN:100VAC LL:173VAC

      - name: "PV Min Power"
        description: "Minimum PV power to start generator"
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        registers: [0x008B]
        icon: "mdi:solar-power-variant"
        range:
          min: 0000
          max: 8000

      - name: Charging Signal
        platform: "select"
        rule: 1
        registers: [0x008C]
        lookup:
          - key: 0x0000
            value: "Normal"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

  - group: Work Mode
    update_interval: 300
    items:
      - name: Energy Pattern
        platform: "select"
        rule: 1
        registers: [0x008D]
        lookup:
          - key: 0x0000
            value: "Battery First"
          - key: 0x0001
            value: "Load First"

      - name: Work Mode
        platform: "select"
        rule: 1
        registers: [0x008E]
        lookup:
          - key: 0x0000
            value: "Export First"
          - key: 0x0001
            value: "Zero Export To Load"
          - key: 0x0002
            value: "Zero Export To CT"

      - name: Export Surplus Power
        alt: Max Sell Power
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x008F]
        configurable:
          min: 0
          max: [15600, 50000]
        range:
          min: 0
          max: [15600, 5000]

      - name: Export Surplus
        alt: Solar Sell
        platform: "switch"
        rule: 1
        registers: [0x0091]

      - name: Export Asymmetry
        alt: Asymmetric phase feeding
        platform: switch
        rule: 1
        registers: [0x00ED]

      - name: PV Max Power
        alt: Max Solar Power
        platform: number
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x0154]
        icon: "mdi:solar-power-variant"
        configurable:
          min: 0
          max: [15600, 50000]
        range:
          min: 0
          max: [15600, 5000]

      - name: Time of Use
        platform: select
        rule: 1
        registers: [0x0092]
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0003
            value: "Monday"
          - key: 0x0005
            value: "Tuesday"
          - key: 0x0009
            value: "Wednesday"
          - key: 0x0011
            value: "Thursday"
          - key: 0x0021
            value: "Friday"
          - key: 0x0041
            value: "Saturday"
          - key: 0x0081
            value: "Sunday"
          - key: 0x003F
            value: "Weekdays"
          - key: 0x00C1
            value: "Weekend"
          - key: 0x00FD
            value: "Week -Monday"
          - key: 0x00FB
            value: "Week -Tuesday"
          - key: 0x00F7
            value: "Week -Wednesday"
          - key: 0x00EF
            value: "Week -Thursday"
          - key: 0x00DF
            value: "Week -Friday"
          - key: 0x00BF
            value: "Week -Saturday"
          - key: 0x007F
            value: "Week -Sunday"
          - key: 0x00FF
            value: "Week"
          - bit: 0
            mode: single
            value: "Enabled"

      - name: Program 1 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0094]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 2 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0095]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 3 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0096]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 4 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0097]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 5 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0098]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 6 Time
        platform: "time"
        state_class: measurement
        rule: 9
        registers: [0x0099]
        range:
          min: 0000
          max: 2359
        icon: mdi:sun-clock

      - name: Program 1 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009A]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 2 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009B]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 3 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009C]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 4 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009D]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 5 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009E]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 6 Power
        platform: number
        class: "power"
        state_class: measurement
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x009F]
        icon: mdi:sun-clock
        configurable:
          min: 0
          max: [12000, 50000]
        range:
          min: 0
          max: [12000, 5000]

      - name: Program 1 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A0]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 2 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A1]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 3 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A2]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 4 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A3]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 5 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A4]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 6 Voltage
        platform: number
        class: "voltage"
        state_class: measurement
        uom: "V"
        scale: 0.01
        rule: 1
        registers: [0x00A5]
        configurable:
          min: 00
          max: 61
          step: 0.1
          mode: box
        range:
          min: 0000
          max: 6100
        icon: mdi:sun-clock

      - name: Program 1 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A6]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 2 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A7]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 3 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A8]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 4 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00A9]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 5 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00AA]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 6 SOC
        platform: number
        state_class: measurement
        uom: "%"
        rule: 1
        registers: [0x00AB]
        configurable:
          mode: box
        range:
          min: 0
          max: 100
        icon: mdi:sun-clock

      - name: Program 1 Charging
        platform: select
        rule: 1
        registers: [0x00AC]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 2 Charging
        platform: select
        rule: 1
        registers: [0x00AD]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 3 Charging
        platform: select
        rule: 1
        registers: [0x00AE]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 4 Charging
        platform: select
        rule: 1
        registers: [0x00AF]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 5 Charging
        platform: select
        rule: 1
        registers: [0x00B0]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Program 6 Charging
        platform: select
        rule: 1
        registers: [0x00B1]
        icon: mdi:sun-clock
        lookup:
          - key: 0x0000
            value: "Disabled"
          - key: 0x0001
            value: "Grid"
          - key: 0x0002
            value: "Generator"
          - key: 0x0003
            value: "Both"

      - name: Microinverter Export cut-off
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 0

      - name: Generator Peak shaving
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 2

      - name: Grid Peak shaving
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 4

      - name: Generator Grid On
        description: On Grid always on
        name_lookup: io_mode_select
        platform: "switch"
        rule: 1
        registers: [0x00B2]
        value:
          bit: 6

      - name: "Generator Peak shaving"
        platform: number
        class: "power"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x00BE]
        icon: "mdi:generator-stationary"
        configurable:
          min: 0
          max: 16000
        range:
          min: 0
          max: [16000, 1600]

      - name: "Grid Peak shaving"
        platform: number
        class: "power"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x00BF]
        icon: "mdi:transmission-tower"
        configurable:
          min: 0
          max: 16000
        range:
          min: 0
          max: [16000, 1600]

  - group: BMS
    items:
      - name: "Battery BMS Charging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D2]

      - name: "Battery BMS Discharging Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D3]

      - name: "Battery BMS Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00D4]
        icon: "mdi:current-dc"

      - name: "Battery BMS Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00D5]
        icon: "mdi:current-dc"

      - name: "Battery BMS SOC"
        attribute:
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x00D6]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101

      - name: "Battery BMS Voltage"
        attribute:
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x00D7]

      - name: "Battery BMS Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: [1, 0.1]
        rule: 2
        registers: [0x00D8]
        icon: "mdi:current-dc"

      - name: "Battery BMS Max Charging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00DA]
        icon: "mdi:current-dc"

      - name: "Battery BMS Max Discharging Current"
        attribute:
        class: "current"
        state_class: "measurement"
        uom: "A"
        rule: 1
        registers: [0x00DB]
        icon: "mdi:current-dc"

      - name: "Battery Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DC]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery Fault"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x00DD]
        icon: "mdi:battery-alert-variant"
        range:
          min: 0
          max: 65535
        attributes: ["value"]

      - name: "Battery BMS Other Symbol"
        attribute:
        rule: 1
        registers: [0x00DE]
        icon: "mdi:battery-unknown"
        range:
          min: 0
          max: 65535

      - name: Battery BMS Type
        platform: select
        rule: 1
        registers: [0x00DF]
        icon: "mdi:battery"
        lookup:
          - key: 0x0000
            value: "PYLON"
          - key: 0x0001
            value: "Tianbangda"
          - key: 0x0002
            value: "KOK"
          - key: 0x0003
            value: "Keith"
          - key: 0x0004
            value: "Toppai"
          - key: 0x0005
            value: "Peneng 485"
          - key: 0x0006
            value: "Jeris 485"
          - key: 0x0007
            value: "Sunwoda 485"
          - key: 0x0008
            value: "Xinrui 485"
          - key: 0x0009
            value: "Tianbangda 485"
          - key: 0x000A
            value: "Shenggao Electric CAN"

  - group: Meter
    update_interval: 30
    items:
      - name: Today Battery Charge
        alt: Daily Battery Charge
        friendly_name: Today's Battery Charge
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0202]
        icon: "mdi:battery-plus"

      - name: Today Battery Discharge
        alt: Daily Battery Discharge
        friendly_name: Today's Battery Discharge
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0203]
        icon: "mdi:battery-minus"

      - name: "Total Battery Charge"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0204, 0x0205]
        icon: "mdi:battery-plus"
        validation:
          min: 0.1

      - name: "Total Battery Discharge"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0206, 0x0207]
        icon: "mdi:battery-minus"
        validation:
          min: 0.1

      - name: Today Battery Life Cycles
        alt: Daily Battery Life Cycles
        friendly_name: Today's Battery Life Cycles
        description: Calculates today's battery life cycles based on today's charged amount
        state_class: "total_increasing"
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"

      - name: "Total Battery Life Cycles"
        description: Calculates total battery life cycles based on total charged amount
        state_class: "total_increasing"
        rule: 0
        digits: 2
        icon: "mdi:battery-sync"
        validation:
          min: 0.1

      - name: Today Energy Import
        alt: Daily Energy Bought
        friendly_name: Today's Energy Import
        description: Today's energy imported from the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0208]
        icon: "mdi:transmission-tower-export"

      - name: Today Energy Export
        alt: Daily Energy Sold
        friendly_name: Today's Energy Export
        description: Today's energy exported/returned to the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0209]
        icon: "mdi:transmission-tower-import"

      - name: Total Energy Import
        alt: Total Energy Bought
        description: Total energy imported from the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020A, 0x020B]
        icon: "mdi:transmission-tower-export"
        validation:
          min: 0.1

      - name: Total Energy Export
        alt: Total Energy Sold
        description: Total energy exported/returned to the grid
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020C, 0x020D]
        icon: "mdi:transmission-tower-import"
        validation:
          min: 0.1

      - name: Today Load Consumption
        alt: Daily Load Consumption
        friendly_name: Today's Load Consumption
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x020E]

      - name: "Total Load Consumption"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x020F, 0x0210]
        validation:
          min: 0.1

      - name: Today Generation
        alt: Daily Generation
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0218]
        icon: "mdi:generator-stationary"

      - name: "Total Generation"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0219, 0x021A]
        icon: "mdi:generator-stationary"
        validation:
          min: 0.1

      - name: Today Production
        alt: Daily Production
        friendly_name: Today's Production
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 1
        registers: [0x0211]
        icon: "mdi:solar-power"

      - name: "Total Production"
        class: "energy"
        state_class: "total_increasing"
        uom: "kWh"
        scale: 0.1
        rule: 3
        registers: [0x0216, 0x0217]
        icon: "mdi:solar-power"
        validation:
          min: 0.1

      - name: Today Losses
        alt: Daily Losses
        friendly_name: Today's Losses
        description: Includes today's consumption of the inverter device itself as well AC/DC conversion losses
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 1
        digits: 1
        scale: 0.1
        registers: [0x0208, 0x0211, 0x0203, 0x0209, 0x020E, 0x0202]
        uint: enforce
        sensors:
          - registers: [0x0208]
          - registers: [0x0211]
          - registers: [0x0203]
          - operator: subtract
            registers: [0x0209]
          - operator: subtract
            registers: [0x020E]
          - operator: subtract
            registers: [0x0202]

      - name: Total Losses
        description: Includes total consumption of the inverter device itself as well AC/DC conversion losses
        class: "energy"
        state_class: "total_increasing"
        ensure_increasing:
        uom: "kWh"
        rule: 3
        digits: 1
        scale: 0.1
        registers:
          [
            0x020A,
            0x020B,
            0x0216,
            0x0217,
            0x0206,
            0x0207,
            0x020C,
            0x020D,
            0x020F,
            0x0210,
            0x0204,
            0x0205,
          ]
        uint: enforce
        sensors:
          - registers: [0x020A, 0x020B]
          - registers: [0x0216, 0x0217]
          - registers: [0x0206, 0x0207]
          - operator: subtract
            registers: [0x020C, 0x020D]
          - operator: subtract
            registers: [0x020F, 0x0210]
          - operator: subtract
            registers: [0x0204, 0x0205]
        validation:
          min: 1

      - name: "DC Temperature"
        hidden:
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021C]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

      - name: "Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 2
        offset: 1000
        registers: [0x021D]
        icon: "mdi:thermometer"
        range:
          min: 0
          max: 3000

  - group: State
    update_interval: 30
    items:
      - name: "Device State"
        class: "enum"
        rule: 1
        registers: [0x01F4]
        icon: "mdi:state-machine"
        range:
          min: 0
          max: 5
        lookup:
          - key: 0x0000
            value: "Standby"
          - key: 0x0001
            value: "Self-test"
          - key: 0x0002
            value: "Normal"
          - key: 0x0003
            value: "Alarm"
          - key: 0x0004
            value: "Fault"

      - name: "" # Power On/Off (Empty name so the sensor has same name as the device, looks good! Can be used once per platform though)
        platform: "binary_sensor"
        device_class: running
        rule: 1
        registers: [0x0227]

      - name: "Device Relay"
        class: "enum"
        rule: 1
        registers: [0x0228]
        icon: "mdi:directions-fork"
        lookup:
          - key: 0x0000
            value: "Off"
          - key: 0x0001
            value: "Inverter"
          - key: 0x0004
            value: "Grid"
          - key: 0x0005
            value: "Inverter-Grid"
          - key: 0x0008
            value: "Generator"
          - key: 0x0009
            value: "Inverter-Gen"
          - key: 0x000C
            value: "Grid-Generator"
          - key: 0x000D
            value: "Inv-Grid-Gen"
          - key: "default"
            value: "Power Supply"

      - name: "Grid"
        platform: "binary_sensor"
        device_class: power
        rule: 1
        registers: [0x0228]
        bit: 2
        icon: "mdi:transmission-tower"

      - name: "Generator"
        name_lookup: "io_mode_select"
        platform: "binary_sensor"
        device_class: power
        rule: 1
        registers: [0x0228]
        bit: 3
        icon: "mdi:lightning-bolt-circle"

      # Alarm message (word 1 & 2) [0, 65535]
      - name: "Device Alarm"
        class: "enum"
        rule: 3
        registers: [0x0229, 0x022A]
        icon: "mdi:alert-outline"
        lookup:
          - key: 0
            value: "OK"
          - bit: 1
            value: "Fan failure"
          - bit: 2
            value: "Grid phase failure"
          - bit: 3
            value: "Meter communication failure"
          - bit: 30
            value: "Battery loss"
          - bit: 31
            value: "Parallel communication quality"
          - key: "default"
            value: "Error"

      # Fault message (word 1, 2, 3 & 4) [0, 65535]
      - name: "Device Fault"
        class: "enum"
        rule: 3
        registers: [0x22B, 0x022C, 0x022D, 0x022E]
        icon: "mdi:message-alert-outline"
        lookup:
          - key: 0
            value: "OK"
          - bit: 6
            value: "DC/DC Soft Start failure"
          - bit: 9
            value: "Auxiliary power supply failure"
          - bit: 12
            value: "Working mode changed"
          - bit: 17
            value: "AC Over-current failure"
          - bit: 18
            value: "Tz_Integ_Fault failure"
          - bit: 19
            value: "DC Over-current failure"
          - bit: 22
            value: "AC current leakage failure"
          - bit: 63
            value: "Temperature is too high"
          - key: "default"
            value: "Error"

  - group: Battery
    items:
      # Battery - The temperature of battery 1
      - name: "Battery Temperature"
        update_interval: 5
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x024A]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      # Battery - The voltage of battery 1 (L:0.01V, H:0.1V)
      - name: "Battery Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: [0.01, 0.1]
        rule: 1
        registers: [0x024B]

      # Battery - The State of Charge (SOC) of battery 1
      - name: "Battery"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        rule: 1
        registers: [0x024C]
        range:
          min: 0
          max: 100
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery Corrected Capacity",
            "Battery BMS SOC",
            "Battery BMS Current",
            "Battery BMS Voltage",
            "Battery BMS Other Symbol",
            "Battery BMS Charging Voltage",
            "Battery BMS Discharging Voltage",
            "Battery BMS Charging Current",
            "Battery BMS Discharging Current",
            "Battery BMS Max Charging Current",
            "Battery BMS Max Discharging Current",
          ]

      # Battery - The power of battery is S16bit
      - name: "Battery Power"
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 2
        registers: [0x024E]
        attributes: [inverse]

      # Battery - The state of health
      - name: "Battery SOH"
        description: Calculates state of health based on total charged amount
        state_class: "measurement"
        uom: "%"
        rule: 0
        digits: 2
        icon: "mdi:battery-heart"

      # Battery - Capacity
      - name: "Battery Capacity"
        description: Estimates capacity of the battery during (dis)charging
        state_class: measurement
        uom: "kWh"
        rule: 0
        digits: 1
        icon: "mdi:battery-check"

      # Battery - The state of battery
      - name: "Battery State"
        description: Determines battery state from battery power by +-50 W
        class: "enum"
        rule: 0
        options: ["charging", "idle", "discharging"]
        icon: "mdi:battery"

      # Battery - The current of battery 1 is S16bit (low 16 bits)
      - name: "Battery Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x024F, 0x0252]
        sensors:
          - signed:
            registers: [0x024F]
          - signed:
            registers: [0x0252]
        icon: "mdi:current-dc"

      # Battery - Actual capacity of the battery
      - name: "Battery Corrected Capacity"
        attribute:
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        registers: [0x0250]
        icon: "mdi:battery"
        range:
          min: 0
          max: 3000

  - group: Grid
    update_interval: 5
    items:
      # Grid side - The voltage of phase A
      - name: "Grid L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0256]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase B
      - name: "Grid L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0257]
        icon: "mdi:transmission-tower"

      # Grid side - The voltage of phase C
      - name: "Grid L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0258]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025C, 0x02BC]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025D, 0x02BD]
        icon: "mdi:transmission-tower"

      # Grid internal - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal CT3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025E, 0x02BE]
        icon: "mdi:transmission-tower"

      # Grid internal - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Internal Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x025F, 0x02BF]
        icon: "mdi:transmission-tower"

      - name: "Grid Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x0261]

      # Grid internal - The current of phase A is S16bit (low 16 bits)
      - name: "Internal CT1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0262]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase B is S16bit (low 16 bits)
      - name: "Internal CT2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0263]
        icon: "mdi:transmission-tower"

      # Grid internal - The current of phase C is S16bit (low 16 bits)
      - name: "Internal CT3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0264]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase A is S16bit (low 16 bits)
      - name: "External CT1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0265]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase B is S16bit (low 16 bits)
      - name: "External CT2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0266]
        icon: "mdi:transmission-tower"

      # Grid external - The current of phase C is S16bit (low 16 bits)
      - name: "External CT3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0267]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0268, 0x02C1]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0269, 0x02C2]
        icon: "mdi:transmission-tower"

      # Grid external - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External CT3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026A, 0x02C3]
        icon: "mdi:transmission-tower"

      # Grid external - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "External Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026B, 0x02C4]
        icon: "mdi:transmission-tower"

      - name: "Grid Power Factor"
        platform: number
        class: "power_factor"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x026D]
        configurable:
          mode: box
        range:
          min: 0
          max: 1000
        icon: "mdi:transmission-tower"

      # The following three (four) registers change according to the built-in and external settings
      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026E, 0x02AF]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x026F, 0x02B0]
        icon: "mdi:transmission-tower"

      # Grid - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0270, 0x02B1]
        icon: "mdi:transmission-tower"

      # Grid - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Grid Power"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0271, 0x02B2]
        icon: "mdi:transmission-tower"
        attributes: [inverse]

  - group: Output
    update_interval: 5
    items:
      # Output - The voltage of phase A
      - name: "Output L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0273]

      # Output - The voltage of phase B
      - name: "Output L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0274]

      # Output - The voltage of phase C
      - name: "Output L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0275]

      # Output - The current of phase A is S16bit (low 16 bits)
      - name: "Output L1 Current"
        l: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0276]

      # Output - The current of phase B is S16bit (low 16 bits)
      - name: "Output L2 Current"
        l: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0277]

      # Output - The current of phase C is S16bit (low 16 bits)
      - name: "Output L3 Current"
        l: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.01
        rule: 2
        registers: [0x0278]

      # Output - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x0279, 0x02B3]

      # Output - The power of phase B is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027A, 0x02B4]

      # Output - The power of phase C is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Output L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027B, 0x02B5]

      # Output - The power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Power"
        alt: Output Power
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x027C, 0x02B6]

      - name: "Power losses"
        description: Includes consumption of the inverter device itself as well AC/DC conversion losses
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        scale: [1, 10]
        registers: [0x024E, 0x02A0, 0x02A1, 0x02A2, 0x02A3, 0x027C, 0x02B6]
        uint: enforce
        sensors:
          - signed:
            registers: [0x024E]
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
          - operator: subtract
            signed:
            scale: 1
            registers: [0x027C, 0x02B6]

      - name: "Output Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x027E]

  - group: UPS
    update_interval: 5
    items:
      # Load UPS output - The power of phase A is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L1 Power"
        l: 1
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 3
        registers: [0x0280, 0x02B8]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase B is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L2 Power"
        l: 2
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 3
        registers: [0x0281, 0x02B9]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power of phase C is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS L3 Power"
        l: 3
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 3
        registers: [0x0282, 0x02BA]
        icon: "mdi:home-lightning-bolt"

      # Load UPS output - The power is U16bit (low 16 bits) + U16bit (high 16 bits)
      - name: "Load UPS Power"
        l: 1
        hidden:
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 3
        registers: [0x0283, 0x02BB]
        icon: "mdi:home-lightning-bolt"

  - group: Load
    update_interval: 5
    items:
      # Load output - The voltage of phase A
      - name: "Load L1 Voltage"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0284]

      # Load output - The voltage of phase B
      - name: "Load L2 Voltage"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0285]

      # Load output - The voltage of phase C
      - name: "Load L3 Voltage"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0286]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L1 Power"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028A, 0x0290]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L2 Power"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028B, 0x0291]

      # Load - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load L3 Power"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028C, 0x0292]

      # Load - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Load Power"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 4
        registers: [0x028D, 0x0293]

      - name: "Load Frequency"
        l: 1
        class: "frequency"
        state_class: "measurement"
        uom: "Hz"
        scale: 0.01
        rule: 1
        registers: [0x028F]

  - group: Generator/SmartLoad/Microinverter
    update_interval: 5
    items:
      # Generator/SmartLoad/Microinverter - The voltage of phase A
      - name: "Generator L1 Voltage"
        name_lookup: "io_mode_select"
        l: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0295]

      # Generator/SmartLoad/Microinverter - The voltage of phase B
      - name: "Generator L2 Voltage"
        name_lookup: "io_mode_select"
        l: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0296]

      # Generator/SmartLoad/Microinverter - The voltage of phase C
      - name: "Generator L3 Voltage"
        name_lookup: "io_mode_select"
        l: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x0297]

      # Generator - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L1 Power"
        name_lookup: "io_mode_select"
        l: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x0298, 0x029C]

      # Generator/SmartLoad/Microinverter - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L2 Power"
        name_lookup: "io_mode_select"
        l: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x0299, 0x029D]

      # Generator/SmartLoad/Microinverter - The power of phase A is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator L3 Power"
        name_lookup: "io_mode_select"
        l: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x029A, 0x029E]

      # Generator/SmartLoad/Microinverter - The Power is S16bit (low 16 bits) + S16bit (high 16 bits)
      - name: "Generator Power"
        name_lookup: "io_mode_select"
        l: 1
        description: Combined power of all three phases
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 2
        registers: [0x029B, 0x029F]

  - group: PV
    update_interval: 5
    items:
      # PV - The combined power of Input 1 & 2 & 3 & 4 (L:1W, H:10W)
      - name: "PV Power"
        alt: DC Power
        mppt: 1
        description: Combined power of all inputs
        class: "power"
        state_class: "measurement"
        uom: "W"
        rule: 1
        digits: 0
        scale: [1, 10]
        registers: [0x02A0, 0x02A1, 0x02A2, 0x02A3]
        sensors:
          - registers: [0x02A0]
          - registers: [0x02A1]
          - registers: [0x02A2]
          - registers: [0x02A3]
        validation:
          min: 0
          max: [24000, 50000]
          invalidate_all:
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 1 (L:1W, H:10W)
      - name: "PV1 Power"
        alt: DC1 Power
        mppt: 1
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A0]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 2 (L:1W, H:10W)
      - name: "PV2 Power"
        alt: DC2 Power
        mppt: 2
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A1]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 3 (L:1W, H:10W)
      - name: "PV3 Power"
        alt: DC3 Power
        mppt: 3
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A2]
        icon: "mdi:solar-power-variant"

      # PV - The power of Input 4 (L:1W, H:10W)
      - name: "PV4 Power"
        alt: DC4 Power
        mppt: 4
        class: "power"
        state_class: "measurement"
        uom: "W"
        scale: [1, 10]
        rule: 1
        registers: [0x02A3]
        icon: "mdi:solar-power-variant"

      - name: "PV1 Voltage"
        alt: DC1 Voltage
        mppt: 1
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A4]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV1 Current"
        alt: DC1 Current
        mppt: 1
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A5]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV2 Voltage"
        alt: DC2 Voltage
        mppt: 2
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A6]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV2 Current"
        alt: DC2 Current
        mppt: 2
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A7]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV3 Voltage"
        alt: DC3 Voltage
        mppt: 3
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02A8]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV3 Current"
        alt: DC3 Current
        mppt: 3
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02A9]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV4 Voltage"
        alt: DC4 Voltage
        mppt: 4
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x02AA]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

      - name: "PV4 Current"
        alt: DC4 Current
        mppt: 4
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 1
        registers: [0x02AB]
        icon: "mdi:solar-power-variant"
        range:
          min: 0
          max: 65535

  - group: Battery 1
    via_device: "inverter"
    update_interval: 10
    pack: 1
    items:
      - name: "Battery 1 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x2730, 0x2731, 0x2732, 0x2733, 0x2734, 0x2735, 0x2736, 0x2737]
        icon: "mdi:battery-sync"

      - name: "Battery 1 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x2738]

      - name: "Battery 1 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x2739]
        icon: "mdi:current-dc"

      - name: "Battery 1 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x273B]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 1 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x273C]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 1 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x273D]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x273E]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x273A]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 1"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x273F]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 1 Serial Number",
            "Battery 1 MOS",
            "Battery 1 Software Version",
            "Battery 1 Hardware Version",
          ]

      - name: "Battery 1 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2740]
        icon: "mdi:battery-heart"

      - name: "Battery 1 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2742]
        icon: "mdi:battery"

      - name: "Battery 1 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2746]

      - name: "Battery 1 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2747]

      - name: "Battery 1 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x2748]
        icon: "mdi:battery-sync"

      - name: "Battery 1 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x2749]

      - name: "Battery 1 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x2750, 0x2751, 0x2752, 0x2753]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 1 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2754]

      - name: "Battery 1 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2755]

  - group: Battery 2
    via_device: "inverter"
    update_interval: 10
    pack: 2
    items:
      - name: "Battery 2 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x2756, 0x2757, 0x2758, 0x2759, 0x275A, 0x275B, 0x275C, 0x275D]
        icon: "mdi:battery-sync"

      - name: "Battery 2 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x275E]

      - name: "Battery 2 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x275F]
        icon: "mdi:current-dc"

      - name: "Battery 2 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2760]
        range:
          min: -99
          max: 3000
        validation:
          min: 1
          max: 99

      - name: "Battery 2 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2761]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 2 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2762]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 2 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2763]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2764]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 2"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2765]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 2 Serial Number",
            "Battery 2 MOS",
            "Battery 2 Software Version",
            "Battery 2 Hardware Version",
          ]

      - name: "Battery 2 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2766]
        icon: "mdi:battery-heart"

      - name: "Battery 2 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2768]
        icon: "mdi:battery"

      - name: "Battery 2 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x276C]

      - name: "Battery 2 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x276D]

      - name: "Battery 2 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x276E]
        icon: "mdi:battery-sync"

      - name: "Battery 2 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x276F]

      - name: "Battery 2 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x2770, 0x2771, 0x2772, 0x2773]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 2 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2774]

      - name: "Battery 2 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2775]

  - group: Battery 3
    via_device: "inverter"
    update_interval: 10
    pack: 3
    items:
      - name: "Battery 3 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x277C, 0x277D, 0x277E, 0x277F, 0x2780, 0x2781, 0x2782, 0x2783]
        icon: "mdi:battery-sync"

      - name: "Battery 3 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x2784]

      - name: "Battery 3 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x2785]
        icon: "mdi:current-dc"

      - name: "Battery 3 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2786]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 3 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2787]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 3 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2788]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 3 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2789]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x278A]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 3"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x278B]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 3 Serial Number",
            "Battery 3 MOS",
            "Battery 3 Software Version",
            "Battery 3 Hardware Version",
          ]

      - name: "Battery 3 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x278C]
        icon: "mdi:battery-heart"

      - name: "Battery 3 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x278E]
        icon: "mdi:battery"

      - name: "Battery 3 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2792]

      - name: "Battery 3 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2793]

      - name: "Battery 3 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x2794]
        icon: "mdi:battery-sync"

      - name: "Battery 3 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x2795]

      - name: "Battery 3 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x2796, 0x2797, 0x2798, 0x2799]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 3 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27A0]

      - name: "Battery 3 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27A1]

  - group: Battery 4
    via_device: "inverter"
    update_interval: 10
    pack: 4
    items:
      - name: "Battery 4 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x27A2, 0x27A3, 0x27A4, 0x27A5, 0x27A6, 0x27A7, 0x27A8, 0x27A9]
        icon: "mdi:battery-sync"

      - name: "Battery 4 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x27AA]

      - name: "Battery 4 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x27AB]
        icon: "mdi:current-dc"

      - name: "Battery 4 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27AC]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 4 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27AD]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 4 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27AE]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 4 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27AF]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27B0]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 4"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27B1]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 4 Serial Number",
            "Battery 4 MOS",
            "Battery 4 Software Version",
            "Battery 4 Hardware Version",
          ]

      - name: "Battery 4 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27B2]
        icon: "mdi:battery-heart"

      - name: "Battery 4 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x27B4]
        icon: "mdi:battery"

      - name: "Battery 4 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x27B8]

      - name: "Battery 4 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x27B9]

      - name: "Battery 4 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x27BA]
        icon: "mdi:battery-sync"

      - name: "Battery 4 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x27BB]

      - name: "Battery 4 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x27BC, 0x27BD, 0x27BE, 0x27BF]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 4 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27C0]

      - name: "Battery 4 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27C1]

  - group: Battery 5
    via_device: "inverter"
    update_interval: 10
    pack: 5
    items:
      - name: "Battery 5 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x27C8, 0x27C9, 0x27CA, 0x27CB, 0x27CC, 0x27CD, 0x27CE, 0x27CF]
        icon: "mdi:battery-sync"

      - name: "Battery 5 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x27D0]

      - name: "Battery 5 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x27D1]
        icon: "mdi:current-dc"

      - name: "Battery 5 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27D2]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 5 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27D3]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 5 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27D4]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 5 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27D5]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27D6]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 5"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27D7]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 5 Serial Number",
            "Battery 5 MOS",
            "Battery 5 Software Version",
            "Battery 5 Hardware Version",
          ]

      - name: "Battery 5 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27D8]
        icon: "mdi:battery-heart"

      - name: "Battery 5 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x27DA]
        icon: "mdi:battery"

      - name: "Battery 5 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x27DE]

      - name: "Battery 5 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x27DF]

      - name: "Battery 5 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x27E0]
        icon: "mdi:battery-sync"

      - name: "Battery 5 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x27E1]

      - name: "Battery 5 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x27E2, 0x27E3, 0x27E4, 0x27E5]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 5 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27E6]

      - name: "Battery 5 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x27E7]

  - group: Battery 6
    via_device: "inverter"
    update_interval: 10
    pack: 6
    items:
      - name: "Battery 6 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x27EE, 0x27EF, 0x27F0, 0x27F1, 0x27F2, 0x27F3, 0x27F4, 0x27F5]
        icon: "mdi:battery-sync"

      - name: "Battery 6 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x27F6]

      - name: "Battery 6 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x27F7]
        icon: "mdi:current-dc"

      - name: "Battery 6 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27F8]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 6 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27F9]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 6 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27FA]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 6 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27FB]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x27FC]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 6"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27FD]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 6 Serial Number",
            "Battery 6 MOS",
            "Battery 6 Software Version",
            "Battery 6 Hardware Version",
          ]

      - name: "Battery 6 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x27FE]
        icon: "mdi:battery-heart"

      - name: "Battery 6 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2800]
        icon: "mdi:battery"

      - name: "Battery 6 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2804]

      - name: "Battery 6 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2805]

      - name: "Battery 6 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x2806]
        icon: "mdi:battery-sync"

      - name: "Battery 6 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x2807]

      - name: "Battery 6 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x2808, 0x2809, 0x280A, 0x280B]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 6 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x280C]

      - name: "Battery 6 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x280D]

  - group: Battery 7
    via_device: "inverter"
    update_interval: 10
    pack: 7
    items:
      - name: "Battery 7 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x2814, 0x2815, 0x2816, 0x2817, 0x2818, 0x2819, 0x281A, 0x281B]
        icon: "mdi:battery-sync"

      - name: "Battery 7 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x281C]

      - name: "Battery 7 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x281D]
        icon: "mdi:current-dc"

      - name: "Battery 7 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x281E]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x281F]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 7 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2820]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 7 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2821]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2822]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 7"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2823]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 7 Serial Number",
            "Battery 7 MOS",
            "Battery 7 Software Version",
            "Battery 7 Hardware Version",
          ]

      - name: "Battery 7 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2824]
        icon: "mdi:battery-heart"

      - name: "Battery 7 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2826]
        icon: "mdi:battery"

      - name: "Battery 7 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x282A]

      - name: "Battery 7 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x282B]

      - name: "Battery 7 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x282C]
        icon: "mdi:battery-sync"

      - name: "Battery 7 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x282D]

      - name: "Battery 7 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x282E, 0x282F, 0x2830, 0x2831]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 7 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2832]

      - name: "Battery 7 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2833]

  - group: Battery 8
    via_device: "inverter"
    update_interval: 10
    pack: 8
    items:
      - name: "Battery 8 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x283A, 0x283B, 0x283C, 0x283D, 0x283E, 0x283F, 0x2840, 0x2841]
        icon: "mdi:battery-sync"

      - name: "Battery 8 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x2842]

      - name: "Battery 8 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x2843]
        icon: "mdi:current-dc"

      - name: "Battery 8 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2844]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 8 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2845]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 8 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2846]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 8 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2847]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2848]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 8"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2849]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 8 Serial Number",
            "Battery 8 MOS",
            "Battery 8 Software Version",
            "Battery 8 Hardware Version",
          ]

      - name: "Battery 8 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x284A]
        icon: "mdi:battery-heart"

      - name: "Battery 8 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x284C]
        icon: "mdi:battery"

      - name: "Battery 8 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2850]

      - name: "Battery 8 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2851]

      - name: "Battery 8 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x2852]
        icon: "mdi:battery-sync"

      - name: "Battery 8 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x2853]

      - name: "Battery 8 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x2854, 0x2855, 0x2856, 0x2857]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 8 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2858]

      - name: "Battery 8 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x2859]

  - group: Battery 9
    via_device: "inverter"
    update_interval: 10
    pack: 9
    items:
      - name: "Battery 9 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x2860, 0x2861, 0x2862, 0x2863, 0x2864, 0x2865, 0x2866, 0x2867]
        icon: "mdi:battery-sync"

      - name: "Battery 9 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x2868]

      - name: "Battery 9 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x2869]
        icon: "mdi:current-dc"

      - name: "Battery 9 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x286A]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x286B]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 9 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x286C]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 9 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x286D]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x286E]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 9"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x286F]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 9 Serial Number",
            "Battery 9 MOS",
            "Battery 9 Software Version",
            "Battery 9 Hardware Version",
          ]

      - name: "Battery 9 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2870]
        icon: "mdi:battery-heart"

      - name: "Battery 9 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2872]
        icon: "mdi:battery"

      - name: "Battery 9 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2876]

      - name: "Battery 9 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x2877]

      - name: "Battery 9 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x2878]
        icon: "mdi:battery-sync"

      - name: "Battery 9 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x2879]

      - name: "Battery 9 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x287A, 0x287B, 0x287C, 0x287D]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 9 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x287E]

      - name: "Battery 9 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x287F]

  - group: Battery 10
    via_device: "inverter"
    update_interval: 10
    pack: 10
    items:
      - name: "Battery 10 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x2886, 0x2887, 0x2888, 0x2889, 0x288A, 0x288B, 0x288C, 0x288D]
        icon: "mdi:battery-sync"

      - name: "Battery 10 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x288E]

      - name: "Battery 10 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x288F]
        icon: "mdi:current-dc"

      - name: "Battery 10 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2890]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 Max Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2891]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99
      
      - name: "Battery 10 Min Cell Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2892]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99      

      - name: "Battery 10 MosMax Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2893]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10 HeatMem Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x2894]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 10"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2895]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 10 Serial Number",
            "Battery 10 MOS",
            "Battery 10 Software Version",
            "Battery 10 Hardware Version",
          ]

      - name: "Battery 10 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x2896]
        icon: "mdi:battery-heart"

      - name: "Battery 10 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x2898]
        icon: "mdi:battery"

      - name: "Battery 10 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x289C]

      - name: "Battery 10 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x289D]

      - name: "Battery 10 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x289E]
        icon: "mdi:battery-sync"

      - name: "Battery 10 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x289F]

      - name: "Battery 10 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x28A0, 0x28A1, 0x28A2, 0x28A3]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 10 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28A4]

      - name: "Battery 10 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28A5]

  - group: Battery 11
    via_device: "inverter"
    update_interval: 10
    pack: 11
    items:
      - name: "Battery 11 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x28AC, 0x28AD, 0x28AE, 0x28AF, 0x28B0, 0x28B1, 0x28B2, 0x28B3]
        icon: "mdi:battery-sync"

      - name: "Battery 11 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x28B4]

      - name: "Battery 11 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x28B5]
        icon: "mdi:current-dc"

      - name: "Battery 11 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x28B6]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 11"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x28BB]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 11 Serial Number",
            "Battery 11 MOS",
            "Battery 11 Software Version",
            "Battery 11 Hardware Version",
          ]

      - name: "Battery 11 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x28BC]
        icon: "mdi:battery-heart"

      - name: "Battery 11 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x28BE]
        icon: "mdi:battery"

      - name: "Battery 11 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x28C2]

      - name: "Battery 11 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x28C3]

      - name: "Battery 11 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x28C4]
        icon: "mdi:battery-sync"

      - name: "Battery 11 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x28C5]

      - name: "Battery 11 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x28C6, 0x28C7, 0x28C8, 0x28C9]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 11 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28CA]

      - name: "Battery 11 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28CB]

  - group: Battery 12
    via_device: "inverter"
    update_interval: 10
    pack: 12
    items:
      - name: "Battery 12 Serial Number"
        update_interval: 3600
        attribute:
        state_class: "measurement"
        rule: 5
        registers:
          [0x28D2, 0x28D3, 0x28D4, 0x28D5, 0x28D6, 0x28D7, 0x28D8, 0x28D9]
        icon: "mdi:battery-sync"

      - name: "Battery 12 Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.1
        rule: 1
        registers: [0x28DA]

      - name: "Battery 12 Current"
        class: "current"
        state_class: "measurement"
        uom: "A"
        scale: 0.1
        rule: 2
        registers: [0x28DB]
        icon: "mdi:current-dc"

      - name: "Battery 12 Temperature"
        class: "temperature"
        state_class: "measurement"
        uom: "Â°C"
        scale: 0.1
        rule: 1
        offset: 1000
        registers: [0x28DC]
        range:
          min: 0
          max: 3000
        validation:
          min: -99
          max: 99

      - name: "Battery 12"
        class: "battery"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x28E1]
        icon: "mdi:battery"
        validation:
          min: 0
          max: 101
        attributes:
          [
            "Battery 12 Serial Number",
            "Battery 12 MOS",
            "Battery 12 Software Version",
            "Battery 12 Hardware Version",
          ]

      - name: "Battery 12 SOH"
        state_class: "measurement"
        uom: "%"
        scale: 0.1
        rule: 1
        registers: [0x28E2]
        icon: "mdi:battery-heart"

      - name: "Battery 12 Capacity"
        state_class: "measurement"
        uom: "Ah"
        rule: 1
        scale: 0.1
        registers: [0x28E4]
        icon: "mdi:battery"

      - name: "Battery 12 Max Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x28E8]

      - name: "Battery 12 Min Cell Voltage"
        class: "voltage"
        state_class: "measurement"
        uom: "V"
        scale: 0.001
        rule: 1
        registers: [0x28E9]

      - name: "Battery 12 Cycles"
        state_class: "total_increasing"
        rule: 1
        registers: [0x28EA]
        icon: "mdi:battery-sync"

      - name: "Battery 12 MOS"
        attribute:
        rule: 1
        icon: "mdi:state-machine"
        registers: [0x28EB]

      - name: "Battery 12 Alarm"
        platform: binary_sensor
        class: "problem"
        rule: 1
        registers: [0x28EC, 0x28ED, 0x28EE, 0x28EF]
        icon: "mdi:battery-alert"
        attributes: ["value"]

      - name: "Battery 12 Software Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28F0]

      - name: "Battery 12 Hardware Version"
        attribute:
        rule: 7
        delimiter: ""
        registers: [0x28F1]
